/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var ta=Object.create;var Oi=Object.defineProperty;var ea=Object.getOwnPropertyDescriptor;var ia=Object.getOwnPropertyNames;var na=Object.getPrototypeOf,ra=Object.prototype.hasOwnProperty;var Hn=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),sa=(n,t)=>{for(var e in t)Oi(n,e,{get:t[e],enumerable:!0})},Es=(n,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of ia(t))!ra.call(n,r)&&r!==e&&Oi(n,r,{get:()=>t[r],enumerable:!(i=ea(t,r))||i.enumerable});return n};var Vn=(n,t,e)=>(e=n!=null?ta(na(n)):{},Es(t||!n||!n.__esModule?Oi(e,"default",{value:n,enumerable:!0}):e,n)),oa=n=>Es(Oi({},"__esModule",{value:!0}),n);var Cn=Hn((Qu,rs)=>{(function(n){if(typeof Qu=="object"&&typeof rs<"u")rs.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t=this,t.localforage=n()}})(function(){var n,t,e;return function i(r,s,o){function u(h,f){if(!s[h]){if(!r[h]){var d=typeof require=="function"&&require;if(!f&&d)return d(h,!0);if(l)return l(h,!0);var m=new Error("Cannot find module '"+h+"'");throw m.code="MODULE_NOT_FOUND",m}var v=s[h]={exports:{}};r[h][0].call(v.exports,function(S){var N=r[h][1][S];return u(N||S)},v,v.exports,i,r,s,o)}return s[h].exports}for(var l=typeof require=="function"&&require,a=0;a<o.length;a++)u(o[a]);return u}({1:[function(i,r,s){(function(o){"use strict";var u=o.MutationObserver||o.WebKitMutationObserver,l;if(u){var a=0,h=new u(S),f=o.document.createTextNode("");h.observe(f,{characterData:!0}),l=function(){f.data=a=++a%2}}else if(!o.setImmediate&&typeof o.MessageChannel<"u"){var d=new o.MessageChannel;d.port1.onmessage=S,l=function(){d.port2.postMessage(0)}}else"document"in o&&"onreadystatechange"in o.document.createElement("script")?l=function(){var M=o.document.createElement("script");M.onreadystatechange=function(){S(),M.onreadystatechange=null,M.parentNode.removeChild(M),M=null},o.document.documentElement.appendChild(M)}:l=function(){setTimeout(S,0)};var m,v=[];function S(){m=!0;for(var M,B,R=v.length;R;){for(B=v,v=[],M=-1;++M<R;)B[M]();R=v.length}m=!1}r.exports=N;function N(M){v.push(M)===1&&!m&&l()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(i,r,s){"use strict";var o=i(1);function u(){}var l={},a=["REJECTED"],h=["FULFILLED"],f=["PENDING"];r.exports=d;function d(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,g!==u&&N(this,g)}d.prototype.catch=function(g){return this.then(null,g)},d.prototype.then=function(g,k){if(typeof g!="function"&&this.state===h||typeof k!="function"&&this.state===a)return this;var C=new this.constructor(u);if(this.state!==f){var T=this.state===h?g:k;v(C,T,this.outcome)}else this.queue.push(new m(C,g,k));return C};function m(g,k,C){this.promise=g,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}m.prototype.callFulfilled=function(g){l.resolve(this.promise,g)},m.prototype.otherCallFulfilled=function(g){v(this.promise,this.onFulfilled,g)},m.prototype.callRejected=function(g){l.reject(this.promise,g)},m.prototype.otherCallRejected=function(g){v(this.promise,this.onRejected,g)};function v(g,k,C){o(function(){var T;try{T=k(C)}catch(_){return l.reject(g,_)}T===g?l.reject(g,new TypeError("Cannot resolve promise with itself")):l.resolve(g,T)})}l.resolve=function(g,k){var C=M(S,k);if(C.status==="error")return l.reject(g,C.value);var T=C.value;if(T)N(g,T);else{g.state=h,g.outcome=k;for(var _=-1,I=g.queue.length;++_<I;)g.queue[_].callFulfilled(k)}return g},l.reject=function(g,k){g.state=a,g.outcome=k;for(var C=-1,T=g.queue.length;++C<T;)g.queue[C].callRejected(k);return g};function S(g){var k=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof k=="function")return function(){k.apply(g,arguments)}}function N(g,k){var C=!1;function T(V){C||(C=!0,l.reject(g,V))}function _(V){C||(C=!0,l.resolve(g,V))}function I(){k(_,T)}var H=M(I);H.status==="error"&&T(H.value)}function M(g,k){var C={};try{C.value=g(k),C.status="success"}catch(T){C.status="error",C.value=T}return C}d.resolve=B;function B(g){return g instanceof this?g:l.resolve(new this(u),g)}d.reject=R;function R(g){var k=new this(u);return l.reject(k,g)}d.all=A;function A(g){var k=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=g.length,T=!1;if(!C)return this.resolve([]);for(var _=new Array(C),I=0,H=-1,V=new this(u);++H<C;)J(g[H],H);return V;function J(it,Q){k.resolve(it).then(zt,function(nt){T||(T=!0,l.reject(V,nt))});function zt(nt){_[Q]=nt,++I===C&&!T&&(T=!0,l.resolve(V,_))}}}d.race=O;function O(g){var k=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=g.length,T=!1;if(!C)return this.resolve([]);for(var _=-1,I=new this(u);++_<C;)H(g[_]);return I;function H(V){k.resolve(V).then(function(J){T||(T=!0,l.resolve(I,J))},function(J){T||(T=!0,l.reject(I,J))})}}},{1:1}],3:[function(i,r,s){(function(o){"use strict";typeof o.Promise!="function"&&(o.Promise=i(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(i,r,s){"use strict";var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c};function u(c,b){if(!(c instanceof b))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var a=l();function h(){try{if(!a||!a.open)return!1;var c=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!c||b)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function f(c,b){c=c||[],b=b||{};try{return new Blob(c,b)}catch(y){if(y.name!=="TypeError")throw y;for(var p=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,x=new p,w=0;w<c.length;w+=1)x.append(c[w]);return x.getBlob(b.type)}}typeof Promise>"u"&&i(3);var d=Promise;function m(c,b){b&&c.then(function(p){b(null,p)},function(p){b(p)})}function v(c,b,p){typeof b=="function"&&c.then(b),typeof p=="function"&&c.catch(p)}function S(c){return typeof c!="string"&&(console.warn(c+" used as a key, but it is not a string."),c=String(c)),c}function N(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var M="local-forage-detect-blob-support",B=void 0,R={},A=Object.prototype.toString,O="readonly",g="readwrite";function k(c){for(var b=c.length,p=new ArrayBuffer(b),x=new Uint8Array(p),w=0;w<b;w++)x[w]=c.charCodeAt(w);return p}function C(c){return new d(function(b){var p=c.transaction(M,g),x=f([""]);p.objectStore(M).put(x,"key"),p.onabort=function(w){w.preventDefault(),w.stopPropagation(),b(!1)},p.oncomplete=function(){var w=navigator.userAgent.match(/Chrome\/(\d+)/),y=navigator.userAgent.match(/Edge\//);b(y||!w||parseInt(w[1],10)>=43)}}).catch(function(){return!1})}function T(c){return typeof B=="boolean"?d.resolve(B):C(c).then(function(b){return B=b,B})}function _(c){var b=R[c.name],p={};p.promise=new d(function(x,w){p.resolve=x,p.reject=w}),b.deferredOperations.push(p),b.dbReady?b.dbReady=b.dbReady.then(function(){return p.promise}):b.dbReady=p.promise}function I(c){var b=R[c.name],p=b.deferredOperations.pop();if(p)return p.resolve(),p.promise}function H(c,b){var p=R[c.name],x=p.deferredOperations.pop();if(x)return x.reject(b),x.promise}function V(c,b){return new d(function(p,x){if(R[c.name]=R[c.name]||X(),c.db)if(b)_(c),c.db.close();else return p(c.db);var w=[c.name];b&&w.push(c.version);var y=a.open.apply(a,w);b&&(y.onupgradeneeded=function(E){var D=y.result;try{D.createObjectStore(c.storeName),E.oldVersion<=1&&D.createObjectStore(M)}catch(L){if(L.name==="ConstraintError")console.warn('The database "'+c.name+'" has been upgraded from version '+E.oldVersion+" to version "+E.newVersion+', but the storage "'+c.storeName+'" already exists.');else throw L}}),y.onerror=function(E){E.preventDefault(),x(y.error)},y.onsuccess=function(){var E=y.result;E.onversionchange=function(D){D.target.close()},p(E),I(c)}})}function J(c){return V(c,!1)}function it(c){return V(c,!0)}function Q(c,b){if(!c.db)return!0;var p=!c.db.objectStoreNames.contains(c.storeName),x=c.version<c.db.version,w=c.version>c.db.version;if(x&&(c.version!==b&&console.warn('The database "'+c.name+`" can't be downgraded from version `+c.db.version+" to version "+c.version+"."),c.version=c.db.version),w||p){if(p){var y=c.db.version+1;y>c.version&&(c.version=y)}return!0}return!1}function zt(c){return new d(function(b,p){var x=new FileReader;x.onerror=p,x.onloadend=function(w){var y=btoa(w.target.result||"");b({__local_forage_encoded_blob:!0,data:y,type:c.type})},x.readAsBinaryString(c)})}function nt(c){var b=k(atob(c.data));return f([b],{type:c.type})}function rt(c){return c&&c.__local_forage_encoded_blob}function gt(c){var b=this,p=b._initReady().then(function(){var x=R[b._dbInfo.name];if(x&&x.dbReady)return x.dbReady});return v(p,c,c),p}function P(c){_(c);for(var b=R[c.name],p=b.forages,x=0;x<p.length;x++){var w=p[x];w._dbInfo.db&&(w._dbInfo.db.close(),w._dbInfo.db=null)}return c.db=null,J(c).then(function(y){return c.db=y,Q(c)?it(c):y}).then(function(y){c.db=b.db=y;for(var E=0;E<p.length;E++)p[E]._dbInfo.db=y}).catch(function(y){throw H(c,y),y})}function U(c,b,p,x){x===void 0&&(x=1);try{var w=c.db.transaction(c.storeName,b);p(null,w)}catch(y){if(x>0&&(!c.db||y.name==="InvalidStateError"||y.name==="NotFoundError"))return d.resolve().then(function(){if(!c.db||y.name==="NotFoundError"&&!c.db.objectStoreNames.contains(c.storeName)&&c.version<=c.db.version)return c.db&&(c.version=c.db.version+1),it(c)}).then(function(){return P(c).then(function(){U(c,b,p,x-1)})}).catch(p);p(y)}}function X(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function et(c){var b=this,p={db:null};if(c)for(var x in c)p[x]=c[x];var w=R[p.name];w||(w=X(),R[p.name]=w),w.forages.push(b),b._initReady||(b._initReady=b.ready,b.ready=gt);var y=[];function E(){return d.resolve()}for(var D=0;D<w.forages.length;D++){var L=w.forages[D];L!==b&&y.push(L._initReady().catch(E))}var z=w.forages.slice(0);return d.all(y).then(function(){return p.db=w.db,J(p)}).then(function(F){return p.db=F,Q(p,b._defaultConfig.version)?it(p):F}).then(function(F){p.db=w.db=F,b._dbInfo=p;for(var q=0;q<z.length;q++){var Z=z[q];Z!==b&&(Z._dbInfo.db=p.db,Z._dbInfo.version=p.version)}})}function dt(c,b){var p=this;c=S(c);var x=new d(function(w,y){p.ready().then(function(){U(p._dbInfo,O,function(E,D){if(E)return y(E);try{var L=D.objectStore(p._dbInfo.storeName),z=L.get(c);z.onsuccess=function(){var F=z.result;F===void 0&&(F=null),rt(F)&&(F=nt(F)),w(F)},z.onerror=function(){y(z.error)}}catch(F){y(F)}})}).catch(y)});return m(x,b),x}function ne(c,b){var p=this,x=new d(function(w,y){p.ready().then(function(){U(p._dbInfo,O,function(E,D){if(E)return y(E);try{var L=D.objectStore(p._dbInfo.storeName),z=L.openCursor(),F=1;z.onsuccess=function(){var q=z.result;if(q){var Z=q.value;rt(Z)&&(Z=nt(Z));var st=c(Z,q.key,F++);st!==void 0?w(st):q.continue()}else w()},z.onerror=function(){y(z.error)}}catch(q){y(q)}})}).catch(y)});return m(x,b),x}function At(c,b,p){var x=this;c=S(c);var w=new d(function(y,E){var D;x.ready().then(function(){return D=x._dbInfo,A.call(b)==="[object Blob]"?T(D.db).then(function(L){return L?b:zt(b)}):b}).then(function(L){U(x._dbInfo,g,function(z,F){if(z)return E(z);try{var q=F.objectStore(x._dbInfo.storeName);L===null&&(L=void 0);var Z=q.put(L,c);F.oncomplete=function(){L===void 0&&(L=null),y(L)},F.onabort=F.onerror=function(){var st=Z.error?Z.error:Z.transaction.error;E(st)}}catch(st){E(st)}})}).catch(E)});return m(w,p),w}function Jt(c,b){var p=this;c=S(c);var x=new d(function(w,y){p.ready().then(function(){U(p._dbInfo,g,function(E,D){if(E)return y(E);try{var L=D.objectStore(p._dbInfo.storeName),z=L.delete(c);D.oncomplete=function(){w()},D.onerror=function(){y(z.error)},D.onabort=function(){var F=z.error?z.error:z.transaction.error;y(F)}}catch(F){y(F)}})}).catch(y)});return m(x,b),x}function Qt(c){var b=this,p=new d(function(x,w){b.ready().then(function(){U(b._dbInfo,g,function(y,E){if(y)return w(y);try{var D=E.objectStore(b._dbInfo.storeName),L=D.clear();E.oncomplete=function(){x()},E.onabort=E.onerror=function(){var z=L.error?L.error:L.transaction.error;w(z)}}catch(z){w(z)}})}).catch(w)});return m(p,c),p}function al(c){var b=this,p=new d(function(x,w){b.ready().then(function(){U(b._dbInfo,O,function(y,E){if(y)return w(y);try{var D=E.objectStore(b._dbInfo.storeName),L=D.count();L.onsuccess=function(){x(L.result)},L.onerror=function(){w(L.error)}}catch(z){w(z)}})}).catch(w)});return m(p,c),p}function hl(c,b){var p=this,x=new d(function(w,y){if(c<0){w(null);return}p.ready().then(function(){U(p._dbInfo,O,function(E,D){if(E)return y(E);try{var L=D.objectStore(p._dbInfo.storeName),z=!1,F=L.openKeyCursor();F.onsuccess=function(){var q=F.result;if(!q){w(null);return}c===0||z?w(q.key):(z=!0,q.advance(c))},F.onerror=function(){y(F.error)}}catch(q){y(q)}})}).catch(y)});return m(x,b),x}function cl(c){var b=this,p=new d(function(x,w){b.ready().then(function(){U(b._dbInfo,O,function(y,E){if(y)return w(y);try{var D=E.objectStore(b._dbInfo.storeName),L=D.openKeyCursor(),z=[];L.onsuccess=function(){var F=L.result;if(!F){x(z);return}z.push(F.key),F.continue()},L.onerror=function(){w(L.error)}}catch(F){w(F)}})}).catch(w)});return m(p,c),p}function fl(c,b){b=N.apply(this,arguments);var p=this.config();c=typeof c!="function"&&c||{},c.name||(c.name=c.name||p.name,c.storeName=c.storeName||p.storeName);var x=this,w;if(!c.name)w=d.reject("Invalid arguments");else{var y=c.name===p.name&&x._dbInfo.db,E=y?d.resolve(x._dbInfo.db):J(c).then(function(D){var L=R[c.name],z=L.forages;L.db=D;for(var F=0;F<z.length;F++)z[F]._dbInfo.db=D;return D});c.storeName?w=E.then(function(D){if(D.objectStoreNames.contains(c.storeName)){var L=D.version+1;_(c);var z=R[c.name],F=z.forages;D.close();for(var q=0;q<F.length;q++){var Z=F[q];Z._dbInfo.db=null,Z._dbInfo.version=L}var st=new d(function(ut,xt){var yt=a.open(c.name,L);yt.onerror=function(qt){var si=yt.result;si.close(),xt(qt)},yt.onupgradeneeded=function(){var qt=yt.result;qt.deleteObjectStore(c.storeName)},yt.onsuccess=function(){var qt=yt.result;qt.close(),ut(qt)}});return st.then(function(ut){z.db=ut;for(var xt=0;xt<F.length;xt++){var yt=F[xt];yt._dbInfo.db=ut,I(yt._dbInfo)}}).catch(function(ut){throw(H(c,ut)||d.resolve()).catch(function(){}),ut})}}):w=E.then(function(D){_(c);var L=R[c.name],z=L.forages;D.close();for(var F=0;F<z.length;F++){var q=z[F];q._dbInfo.db=null}var Z=new d(function(st,ut){var xt=a.deleteDatabase(c.name);xt.onerror=function(){var yt=xt.result;yt&&yt.close(),ut(xt.error)},xt.onblocked=function(){console.warn('dropInstance blocked for database "'+c.name+'" until all open connections are closed')},xt.onsuccess=function(){var yt=xt.result;yt&&yt.close(),st(yt)}});return Z.then(function(st){L.db=st;for(var ut=0;ut<z.length;ut++){var xt=z[ut];I(xt._dbInfo)}}).catch(function(st){throw(H(c,st)||d.resolve()).catch(function(){}),st})})}return m(w,b),w}var dl={_driver:"asyncStorage",_initStorage:et,_support:h(),iterate:ne,getItem:dt,setItem:At,removeItem:Jt,clear:Qt,length:al,key:hl,keys:cl,dropInstance:fl};function pl(){return typeof openDatabase=="function"}var fe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ml="~~local_forage_type~",hs=/^~~local_forage_type~([^~]+)~/,Ti="__lfsc__:",In=Ti.length,Nn="arbf",Pn="blob",cs="si08",fs="ui08",ds="uic8",ps="si16",ms="si32",gs="ur16",bs="ui32",vs="fl32",ys="fl64",xs=In+Nn.length,ws=Object.prototype.toString;function ks(c){var b=c.length*.75,p=c.length,x,w=0,y,E,D,L;c[c.length-1]==="="&&(b--,c[c.length-2]==="="&&b--);var z=new ArrayBuffer(b),F=new Uint8Array(z);for(x=0;x<p;x+=4)y=fe.indexOf(c[x]),E=fe.indexOf(c[x+1]),D=fe.indexOf(c[x+2]),L=fe.indexOf(c[x+3]),F[w++]=y<<2|E>>4,F[w++]=(E&15)<<4|D>>2,F[w++]=(D&3)<<6|L&63;return z}function Dn(c){var b=new Uint8Array(c),p="",x;for(x=0;x<b.length;x+=3)p+=fe[b[x]>>2],p+=fe[(b[x]&3)<<4|b[x+1]>>4],p+=fe[(b[x+1]&15)<<2|b[x+2]>>6],p+=fe[b[x+2]&63];return b.length%3===2?p=p.substring(0,p.length-1)+"=":b.length%3===1&&(p=p.substring(0,p.length-2)+"=="),p}function gl(c,b){var p="";if(c&&(p=ws.call(c)),c&&(p==="[object ArrayBuffer]"||c.buffer&&ws.call(c.buffer)==="[object ArrayBuffer]")){var x,w=Ti;c instanceof ArrayBuffer?(x=c,w+=Nn):(x=c.buffer,p==="[object Int8Array]"?w+=cs:p==="[object Uint8Array]"?w+=fs:p==="[object Uint8ClampedArray]"?w+=ds:p==="[object Int16Array]"?w+=ps:p==="[object Uint16Array]"?w+=gs:p==="[object Int32Array]"?w+=ms:p==="[object Uint32Array]"?w+=bs:p==="[object Float32Array]"?w+=vs:p==="[object Float64Array]"?w+=ys:b(new Error("Failed to get type for BinaryArray"))),b(w+Dn(x))}else if(p==="[object Blob]"){var y=new FileReader;y.onload=function(){var E=ml+c.type+"~"+Dn(this.result);b(Ti+Pn+E)},y.readAsArrayBuffer(c)}else try{b(JSON.stringify(c))}catch(E){console.error("Couldn't convert value into a JSON string: ",c),b(null,E)}}function bl(c){if(c.substring(0,In)!==Ti)return JSON.parse(c);var b=c.substring(xs),p=c.substring(In,xs),x;if(p===Pn&&hs.test(b)){var w=b.match(hs);x=w[1],b=b.substring(w[0].length)}var y=ks(b);switch(p){case Nn:return y;case Pn:return f([y],{type:x});case cs:return new Int8Array(y);case fs:return new Uint8Array(y);case ds:return new Uint8ClampedArray(y);case ps:return new Int16Array(y);case gs:return new Uint16Array(y);case ms:return new Int32Array(y);case bs:return new Uint32Array(y);case vs:return new Float32Array(y);case ys:return new Float64Array(y);default:throw new Error("Unkown type: "+p)}}var Rn={serialize:gl,deserialize:bl,stringToBuffer:ks,bufferToString:Dn};function _s(c,b,p,x){c.executeSql("CREATE TABLE IF NOT EXISTS "+b.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],p,x)}function vl(c){var b=this,p={db:null};if(c)for(var x in c)p[x]=typeof c[x]!="string"?c[x].toString():c[x];var w=new d(function(y,E){try{p.db=openDatabase(p.name,String(p.version),p.description,p.size)}catch(D){return E(D)}p.db.transaction(function(D){_s(D,p,function(){b._dbInfo=p,y()},function(L,z){E(z)})},E)});return p.serializer=Rn,w}function de(c,b,p,x,w,y){c.executeSql(p,x,w,function(E,D){D.code===D.SYNTAX_ERR?E.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[b.storeName],function(L,z){z.rows.length?y(L,D):_s(L,b,function(){L.executeSql(p,x,w,y)},y)},y):y(E,D)},y)}function yl(c,b){var p=this;c=S(c);var x=new d(function(w,y){p.ready().then(function(){var E=p._dbInfo;E.db.transaction(function(D){de(D,E,"SELECT * FROM "+E.storeName+" WHERE key = ? LIMIT 1",[c],function(L,z){var F=z.rows.length?z.rows.item(0).value:null;F&&(F=E.serializer.deserialize(F)),w(F)},function(L,z){y(z)})})}).catch(y)});return m(x,b),x}function xl(c,b){var p=this,x=new d(function(w,y){p.ready().then(function(){var E=p._dbInfo;E.db.transaction(function(D){de(D,E,"SELECT * FROM "+E.storeName,[],function(L,z){for(var F=z.rows,q=F.length,Z=0;Z<q;Z++){var st=F.item(Z),ut=st.value;if(ut&&(ut=E.serializer.deserialize(ut)),ut=c(ut,st.key,Z+1),ut!==void 0){w(ut);return}}w()},function(L,z){y(z)})})}).catch(y)});return m(x,b),x}function Ss(c,b,p,x){var w=this;c=S(c);var y=new d(function(E,D){w.ready().then(function(){b===void 0&&(b=null);var L=b,z=w._dbInfo;z.serializer.serialize(b,function(F,q){q?D(q):z.db.transaction(function(Z){de(Z,z,"INSERT OR REPLACE INTO "+z.storeName+" (key, value) VALUES (?, ?)",[c,F],function(){E(L)},function(st,ut){D(ut)})},function(Z){if(Z.code===Z.QUOTA_ERR){if(x>0){E(Ss.apply(w,[c,L,p,x-1]));return}D(Z)}})})}).catch(D)});return m(y,p),y}function wl(c,b,p){return Ss.apply(this,[c,b,p,1])}function kl(c,b){var p=this;c=S(c);var x=new d(function(w,y){p.ready().then(function(){var E=p._dbInfo;E.db.transaction(function(D){de(D,E,"DELETE FROM "+E.storeName+" WHERE key = ?",[c],function(){w()},function(L,z){y(z)})})}).catch(y)});return m(x,b),x}function _l(c){var b=this,p=new d(function(x,w){b.ready().then(function(){var y=b._dbInfo;y.db.transaction(function(E){de(E,y,"DELETE FROM "+y.storeName,[],function(){x()},function(D,L){w(L)})})}).catch(w)});return m(p,c),p}function Sl(c){var b=this,p=new d(function(x,w){b.ready().then(function(){var y=b._dbInfo;y.db.transaction(function(E){de(E,y,"SELECT COUNT(key) as c FROM "+y.storeName,[],function(D,L){var z=L.rows.item(0).c;x(z)},function(D,L){w(L)})})}).catch(w)});return m(p,c),p}function Cl(c,b){var p=this,x=new d(function(w,y){p.ready().then(function(){var E=p._dbInfo;E.db.transaction(function(D){de(D,E,"SELECT key FROM "+E.storeName+" WHERE id = ? LIMIT 1",[c+1],function(L,z){var F=z.rows.length?z.rows.item(0).key:null;w(F)},function(L,z){y(z)})})}).catch(y)});return m(x,b),x}function Tl(c){var b=this,p=new d(function(x,w){b.ready().then(function(){var y=b._dbInfo;y.db.transaction(function(E){de(E,y,"SELECT key FROM "+y.storeName,[],function(D,L){for(var z=[],F=0;F<L.rows.length;F++)z.push(L.rows.item(F).key);x(z)},function(D,L){w(L)})})}).catch(w)});return m(p,c),p}function Al(c){return new d(function(b,p){c.transaction(function(x){x.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(w,y){for(var E=[],D=0;D<y.rows.length;D++)E.push(y.rows.item(D).name);b({db:c,storeNames:E})},function(w,y){p(y)})},function(x){p(x)})})}function Ol(c,b){b=N.apply(this,arguments);var p=this.config();c=typeof c!="function"&&c||{},c.name||(c.name=c.name||p.name,c.storeName=c.storeName||p.storeName);var x=this,w;return c.name?w=new d(function(y){var E;c.name===p.name?E=x._dbInfo.db:E=openDatabase(c.name,"","",0),c.storeName?y({db:E,storeNames:[c.storeName]}):y(Al(E))}).then(function(y){return new d(function(E,D){y.db.transaction(function(L){function z(st){return new d(function(ut,xt){L.executeSql("DROP TABLE IF EXISTS "+st,[],function(){ut()},function(yt,qt){xt(qt)})})}for(var F=[],q=0,Z=y.storeNames.length;q<Z;q++)F.push(z(y.storeNames[q]));d.all(F).then(function(){E()}).catch(function(st){D(st)})},function(L){D(L)})})}):w=d.reject("Invalid arguments"),m(w,b),w}var El={_driver:"webSQLStorage",_initStorage:vl,_support:pl(),iterate:xl,getItem:yl,setItem:wl,removeItem:kl,clear:_l,length:Sl,key:Cl,keys:Tl,dropInstance:Ol};function Ml(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Cs(c,b){var p=c.name+"/";return c.storeName!==b.storeName&&(p+=c.storeName+"/"),p}function Il(){var c="_localforage_support_test";try{return localStorage.setItem(c,!0),localStorage.removeItem(c),!1}catch{return!0}}function Nl(){return!Il()||localStorage.length>0}function Pl(c){var b=this,p={};if(c)for(var x in c)p[x]=c[x];return p.keyPrefix=Cs(c,b._defaultConfig),Nl()?(b._dbInfo=p,p.serializer=Rn,d.resolve()):d.reject()}function Dl(c){var b=this,p=b.ready().then(function(){for(var x=b._dbInfo.keyPrefix,w=localStorage.length-1;w>=0;w--){var y=localStorage.key(w);y.indexOf(x)===0&&localStorage.removeItem(y)}});return m(p,c),p}function Rl(c,b){var p=this;c=S(c);var x=p.ready().then(function(){var w=p._dbInfo,y=localStorage.getItem(w.keyPrefix+c);return y&&(y=w.serializer.deserialize(y)),y});return m(x,b),x}function Bl(c,b){var p=this,x=p.ready().then(function(){for(var w=p._dbInfo,y=w.keyPrefix,E=y.length,D=localStorage.length,L=1,z=0;z<D;z++){var F=localStorage.key(z);if(F.indexOf(y)===0){var q=localStorage.getItem(F);if(q&&(q=w.serializer.deserialize(q)),q=c(q,F.substring(E),L++),q!==void 0)return q}}});return m(x,b),x}function Ll(c,b){var p=this,x=p.ready().then(function(){var w=p._dbInfo,y;try{y=localStorage.key(c)}catch{y=null}return y&&(y=y.substring(w.keyPrefix.length)),y});return m(x,b),x}function zl(c){var b=this,p=b.ready().then(function(){for(var x=b._dbInfo,w=localStorage.length,y=[],E=0;E<w;E++){var D=localStorage.key(E);D.indexOf(x.keyPrefix)===0&&y.push(D.substring(x.keyPrefix.length))}return y});return m(p,c),p}function Fl(c){var b=this,p=b.keys().then(function(x){return x.length});return m(p,c),p}function Hl(c,b){var p=this;c=S(c);var x=p.ready().then(function(){var w=p._dbInfo;localStorage.removeItem(w.keyPrefix+c)});return m(x,b),x}function Vl(c,b,p){var x=this;c=S(c);var w=x.ready().then(function(){b===void 0&&(b=null);var y=b;return new d(function(E,D){var L=x._dbInfo;L.serializer.serialize(b,function(z,F){if(F)D(F);else try{localStorage.setItem(L.keyPrefix+c,z),E(y)}catch(q){(q.name==="QuotaExceededError"||q.name==="NS_ERROR_DOM_QUOTA_REACHED")&&D(q),D(q)}})})});return m(w,p),w}function ql(c,b){if(b=N.apply(this,arguments),c=typeof c!="function"&&c||{},!c.name){var p=this.config();c.name=c.name||p.name,c.storeName=c.storeName||p.storeName}var x=this,w;return c.name?w=new d(function(y){c.storeName?y(Cs(c,x._defaultConfig)):y(c.name+"/")}).then(function(y){for(var E=localStorage.length-1;E>=0;E--){var D=localStorage.key(E);D.indexOf(y)===0&&localStorage.removeItem(D)}}):w=d.reject("Invalid arguments"),m(w,b),w}var Ul={_driver:"localStorageWrapper",_initStorage:Pl,_support:Ml(),iterate:Bl,getItem:Rl,setItem:Vl,removeItem:Hl,clear:Dl,length:Fl,key:Ll,keys:zl,dropInstance:ql},Wl=function(b,p){return b===p||typeof b=="number"&&typeof p=="number"&&isNaN(b)&&isNaN(p)},jl=function(b,p){for(var x=b.length,w=0;w<x;){if(Wl(b[w],p))return!0;w++}return!1},Ts=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"},ri={},As={},He={INDEXEDDB:dl,WEBSQL:El,LOCALSTORAGE:Ul},Gl=[He.INDEXEDDB._driver,He.WEBSQL._driver,He.LOCALSTORAGE._driver],Ai=["dropInstance"],Bn=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ai),Kl={description:"",driver:Gl.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Yl(c,b){c[b]=function(){var p=arguments;return c.ready().then(function(){return c[b].apply(c,p)})}}function Ln(){for(var c=1;c<arguments.length;c++){var b=arguments[c];if(b)for(var p in b)b.hasOwnProperty(p)&&(Ts(b[p])?arguments[0][p]=b[p].slice():arguments[0][p]=b[p])}return arguments[0]}var Jl=function(){function c(b){u(this,c);for(var p in He)if(He.hasOwnProperty(p)){var x=He[p],w=x._driver;this[p]=w,ri[w]||this.defineDriver(x)}this._defaultConfig=Ln({},Kl),this._config=Ln({},this._defaultConfig,b),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return c.prototype.config=function(p){if((typeof p>"u"?"undefined":o(p))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var x in p){if(x==="storeName"&&(p[x]=p[x].replace(/\W/g,"_")),x==="version"&&typeof p[x]!="number")return new Error("Database version must be a number.");this._config[x]=p[x]}return"driver"in p&&p.driver?this.setDriver(this._config.driver):!0}else return typeof p=="string"?this._config[p]:this._config},c.prototype.defineDriver=function(p,x,w){var y=new d(function(E,D){try{var L=p._driver,z=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!p._driver){D(z);return}for(var F=Bn.concat("_initStorage"),q=0,Z=F.length;q<Z;q++){var st=F[q],ut=!jl(Ai,st);if((ut||p[st])&&typeof p[st]!="function"){D(z);return}}var xt=function(){for(var si=function(Zl){return function(){var $l=new Error("Method "+Zl+" is not implemented by the current driver"),Os=d.reject($l);return m(Os,arguments[arguments.length-1]),Os}},zn=0,Xl=Ai.length;zn<Xl;zn++){var Fn=Ai[zn];p[Fn]||(p[Fn]=si(Fn))}};xt();var yt=function(si){ri[L]&&console.info("Redefining LocalForage driver: "+L),ri[L]=p,As[L]=si,E()};"_support"in p?p._support&&typeof p._support=="function"?p._support().then(yt,D):yt(!!p._support):yt(!0)}catch(qt){D(qt)}});return v(y,x,w),y},c.prototype.driver=function(){return this._driver||null},c.prototype.getDriver=function(p,x,w){var y=ri[p]?d.resolve(ri[p]):d.reject(new Error("Driver not found."));return v(y,x,w),y},c.prototype.getSerializer=function(p){var x=d.resolve(Rn);return v(x,p),x},c.prototype.ready=function(p){var x=this,w=x._driverSet.then(function(){return x._ready===null&&(x._ready=x._initDriver()),x._ready});return v(w,p,p),w},c.prototype.setDriver=function(p,x,w){var y=this;Ts(p)||(p=[p]);var E=this._getSupportedDrivers(p);function D(){y._config.driver=y.driver()}function L(q){return y._extend(q),D(),y._ready=y._initStorage(y._config),y._ready}function z(q){return function(){var Z=0;function st(){for(;Z<q.length;){var ut=q[Z];return Z++,y._dbInfo=null,y._ready=null,y.getDriver(ut).then(L).catch(st)}D();var xt=new Error("No available storage method found.");return y._driverSet=d.reject(xt),y._driverSet}return st()}}var F=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=F.then(function(){var q=E[0];return y._dbInfo=null,y._ready=null,y.getDriver(q).then(function(Z){y._driver=Z._driver,D(),y._wrapLibraryMethodsWithReady(),y._initDriver=z(E)})}).catch(function(){D();var q=new Error("No available storage method found.");return y._driverSet=d.reject(q),y._driverSet}),v(this._driverSet,x,w),this._driverSet},c.prototype.supports=function(p){return!!As[p]},c.prototype._extend=function(p){Ln(this,p)},c.prototype._getSupportedDrivers=function(p){for(var x=[],w=0,y=p.length;w<y;w++){var E=p[w];this.supports(E)&&x.push(E)}return x},c.prototype._wrapLibraryMethodsWithReady=function(){for(var p=0,x=Bn.length;p<x;p++)Yl(this,Bn[p])},c.prototype.createInstance=function(p){return new c(p)},c}(),Ql=new Jl;r.exports=Ql},{3:3}]},{},[4])(4)})});var Zu=Hn((Tn,Xu)=>{(function(n,t){typeof Tn=="object"&&typeof Xu<"u"?t(Tn,Cn()):typeof define=="function"&&define.amd?define(["exports","localforage"],t):t(n.localforageSetItems=n.localforageSetItems||{},n.localforage)})(Tn,function(n,t){"use strict";t="default"in t?t.default:t;function e(f){return e.result?e.result:!f||typeof f.getSerializer!="function"?Promise.reject(new Error("localforage.getSerializer() was not available! localforage v1.4+ is required!")):(e.result=f.getSerializer(),e.result)}function i(f,d){d&&f.then(function(m){d(null,m)},function(m){d(m)})}function r(f,d,m,v){function S(O,g){var k=O||g;return(!O||typeof O!="function")&&typeof k=="string"&&(O=function(T){return T[k]}),O}var N=[];if(Object.prototype.toString.call(f)==="[object Array]"){d=S(d,"key"),m=S(m,"value");for(var M=0,B=f.length;M<B;M++){var R=f[M];N.push(v(d(R),m(R)))}}else for(var A in f)f.hasOwnProperty(A)&&N.push(v(A,f[A]));return N}function s(f,d,m,v){var S=this,N=S.ready().then(function(){return new Promise(function(M,B){var R=S._dbInfo,A=R.db.transaction(R.storeName,"readwrite"),O=A.objectStore(R.storeName),g;A.oncomplete=function(){M(f)},A.onabort=A.onerror=function(C){B(g||C.target)};function k(C){var T=C.target||this;g=T.error||T.transaction.error,B(g)}r(f,d,m,function(C,T){T===null&&(T=void 0);var _=O.put(T,C);_.onerror=k})})});return i(N,v),N}function o(f,d,m,v){var S=this,N=new Promise(function(M,B){S.ready().then(function(){return e(S)}).then(function(R){var A=S._dbInfo;A.db.transaction(function(O){var g="INSERT OR REPLACE INTO "+A.storeName+" (key, value) VALUES (?, ?)",k=r(f,d,m,function(C,T){return new Promise(function(_,I){R.serialize(T,function(H,V){V?I(V):O.executeSql(g,[C,H],function(){_()},function(J,it){I(it)})})})});Promise.all(k).then(function(){M(f)},B)},function(O){B(O)})}).catch(B)});return i(N,v),N}function u(f,d,m,v){var S=this,N=r(f,d,m,function(B,R){return S.setItem(B,R)}),M=Promise.all(N);return i(M,v),M}function l(f,d,m,v){var S=this,N=S.driver();return N===S.INDEXEDDB?s.call(S,f,d,m,v):N===S.WEBSQL?o.call(S,f,d,m,v):u.call(S,f,d,m,v)}function a(f){var d=Object.getPrototypeOf(f);d&&(d.setItems=l,d.setItems.indexedDB=function(){return s.apply(this,arguments)},d.setItems.websql=function(){return o.apply(this,arguments)},d.setItems.generic=function(){return u.apply(this,arguments)})}var h=a(t);n.setItemsGeneric=u,n.localforageSetItems=l,n.extendPrototype=a,n.extendPrototypeResult=h,Object.defineProperty(n,"__esModule",{value:!0})})});var tl=Hn((An,$u)=>{(function(n,t){typeof An=="object"&&typeof $u<"u"?t(An,Cn()):typeof define=="function"&&define.amd?define(["exports","localforage"],t):t(n.localforageGetItems=n.localforageGetItems||{},n.localforage)})(An,function(n,t){"use strict";t="default"in t?t.default:t;function e(v){return e.result?e.result:!v||typeof v.getSerializer!="function"?Promise.reject(new Error("localforage.getSerializer() was not available! localforage v1.4+ is required!")):(e.result=v.getSerializer(),e.result)}function i(v,S){return S&&v.then(function(N){S(null,N)},function(N){S(N)}),v}function r(v,S){var N=this,M=N.getItem(v).then(function(B){return{key:v,value:B}});return i(M,S),M}function s(v){var S=this,N=new Promise(function(M,B){for(var R=[],A=0,O=v.length;A<O;A++)R.push(r.call(S,v[A]));Promise.all(R).then(function(g){for(var k={},C=0,T=g.length;C<T;C++){var _=g[C];k[_.key]=_.value}M(k)}).catch(B)});return N}function o(){var v=this,S={};return v.iterate(function(N,M){S[M]=N}).then(function(){return S})}function u(){if(typeof IDBKeyRange<"u")return IDBKeyRange;if(typeof webkitIDBKeyRange<"u")return webkitIDBKeyRange;if(typeof mozIDBKeyRange<"u")return mozIDBKeyRange}var l=u();function a(v){v=v.slice();var S=this;function N(B,R){return B<R?-1:B>R?1:0}var M=new Promise(function(B,R){S.ready().then(function(){var A=S._dbInfo,O=A.db.transaction(A.storeName,"readonly").objectStore(A.storeName),g=v.sort(N),k=l.bound(v[0],v[v.length-1],!1,!1),C;if("getAll"in O)C=O.getAll(k),C.onsuccess=function(){var I=C.result;I===void 0&&(I=null),B(I)};else{C=O.openCursor(k);var T={},_=0;C.onsuccess=function(){var I=C.result;if(!I){B(T);return}for(var H=I.key;H>g[_];)if(_++,_===g.length){B(T);return}if(H===g[_]){var V=I.value;V===void 0&&(V=null),T[H]=V,I.continue()}else I.continue(g[_])}}C.onerror=function(){R(C.error)}}).catch(R)});return M}function h(v){var S=this,N=new Promise(function(M,B){S.ready().then(function(){return e(S)}).then(function(R){var A=S._dbInfo;A.db.transaction(function(O){for(var g=new Array(v.length),k=0,C=v.length;k<C;k++)g[k]="?";O.executeSql("SELECT * FROM "+A.storeName+" WHERE (key IN ("+g.join(",")+"))",v,function(T,_){for(var I={},H=_.rows,V=0,J=H.length;V<J;V++){var it=H.item(V),Q=it.value;Q&&(Q=R.deserialize(Q)),I[it.key]=Q}M(I)},function(T,_){B(_)})})}).catch(B)});return N}function f(v,S){var N=this,M;if(!arguments.length||v===null)M=o.apply(N);else{var B=N.driver();B===N.INDEXEDDB?M=a.apply(N,arguments):B===N.WEBSQL?M=h.apply(N,arguments):M=s.apply(N,arguments)}return i(M,S),M}function d(v){var S=Object.getPrototypeOf(v);S&&(S.getItems=f,S.getItems.indexedDB=function(){return a.apply(this,arguments)},S.getItems.websql=function(){return h.apply(this,arguments)},S.getItems.generic=function(){return s.apply(this,arguments)})}var m=d(t);n.localforageGetItems=f,n.extendPrototype=d,n.extendPrototypeResult=m,n.getItemsGeneric=s,Object.defineProperty(n,"__esModule",{value:!0})})});var Hh={};sa(Hh,{default:()=>Mn});module.exports=oa(Hh);var Fe=require("obsidian"),ll=require("@codemirror/view");var Ys=require("@codemirror/state");var ua=0;var bt=class{constructor(t={}){this.id=ua++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=se.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}};bt.closedBy=new bt({deserialize:n=>n.split(" ")});bt.openedBy=new bt({deserialize:n=>n.split(" ")});bt.group=new bt({deserialize:n=>n.split(" ")});bt.contextHash=new bt({perNode:!0});bt.lookAhead=new bt({perNode:!0});bt.mounted=new bt({perNode:!0});var la=Object.create(null),se=class n{constructor(t,e,i,r=0){this.name=t,this.props=e,this.id=i,this.flags=r}static define(t){let e=t.props&&t.props.length?Object.create(null):la,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),r=new n(t.name||"",e,t.id,i);if(t.props){for(let s of t.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[s[0].id]=s[1]}}return r}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(bt.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let r of i.split(" "))e[r]=t[i];return i=>{for(let r=i.prop(bt.group),s=-1;s<(r?r.length:0);s++){let o=e[s<0?i.name:r[s]];if(o)return o}}}};se.none=new se("",Object.create(null),0,8);var Ei=new WeakMap,Ms=new WeakMap,Pt;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(Pt||(Pt={}));var re=class n{constructor(t,e,i,r,s){if(this.type=t,this.children=e,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,u]of s)this.props[typeof o=="number"?o:o.id]=u}}toString(){let t=this.prop(bt.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let r=i.toString();r&&(e&&(e+=","),e+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new qe(this.topNode,t)}cursorAt(t,e=0,i=0){let r=Ei.get(this)||this.topNode,s=new qe(r);return s.moveTo(t,e),Ei.set(this,s._tree),s}get topNode(){return new Ae(this,0,0,null)}resolve(t,e=0){let i=Ve(Ei.get(this)||this.topNode,t,e,!1);return Ei.set(this,i),i}resolveInner(t,e=0){let i=Ve(Ms.get(this)||this.topNode,t,e,!0);return Ms.set(this,i),i}iterate(t){let{enter:e,leave:i,from:r=0,to:s=this.length}=t,o=t.mode||0,u=(o&Pt.IncludeAnonymous)>0;for(let l=this.cursor(o|Pt.IncludeAnonymous);;){let a=!1;if(l.from<=s&&l.to>=r&&(!u&&l.type.isAnonymous||e(l)!==!1)){if(l.firstChild())continue;a=!0}for(;a&&i&&(u||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;a=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:jn(se.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,r)=>new n(this.type,e,i,r,this.propValues),t.makeTree||((e,i,r)=>new n(se.none,e,i,r)))}static build(t){return aa(t)}};re.empty=new re(se.none,[],[],0);var qn=class n{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new n(this.buffer,this.index)}},Te=class n{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return se.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],r=this.set.types[e],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),t+=4,i==t)return s;let o=[];for(;t<i;)o.push(this.childString(t)),t=this.buffer[t+3];return s+"("+o.join(",")+")"}findChild(t,e,i,r,s){let{buffer:o}=this,u=-1;for(let l=t;l!=e&&!(Ns(s,r,o[l+1],o[l+2])&&(u=l,i>0));l=o[l+3]);return u}slice(t,e,i){let r=this.buffer,s=new Uint16Array(e-t),o=0;for(let u=t,l=0;u<e;){s[l++]=r[u++],s[l++]=r[u++]-i;let a=s[l++]=r[u++]-i;s[l++]=r[u++]-t,o=Math.max(o,a)}return new n(s,o,this.set)}};function Ns(n,t,e,i){switch(n){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function Ps(n,t){let e=n.childBefore(t);for(;e;){let i=e.lastChild;if(!i||i.to!=e.to)break;i.type.isError&&i.from==i.to?(n=e,e=i.prevSibling):e=i}return n}function Ve(n,t,e,i){for(var r;n.from==n.to||(e<1?n.from>=t:n.from>t)||(e>-1?n.to<=t:n.to<t);){let o=!i&&n instanceof Ae&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=i?0:Pt.IgnoreOverlays;if(i)for(let o=n,u=o.parent;u;o=u,u=o.parent)o instanceof Ae&&o.index<0&&((r=u.enter(t,e,s))===null||r===void 0?void 0:r.from)!=o.from&&(n=u);for(;;){let o=n.enter(t,e,s);if(!o)return n;n=o}}var Ae=class n{constructor(t,e,i,r){this._tree=t,this.from=e,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,r,s=0){for(let o=this;;){for(let{children:u,positions:l}=o._tree,a=e>0?u.length:-1;t!=a;t+=e){let h=u[t],f=l[t]+o.from;if(Ns(r,i,f,f+h.length)){if(h instanceof Te){if(s&Pt.ExcludeBuffers)continue;let d=h.findChild(0,h.buffer.length,e,i-f,r);if(d>-1)return new oi(new Un(o,h,t,f),null,d)}else if(s&Pt.IncludeAnonymous||!h.type.isAnonymous||Wn(h)){let d;if(!(s&Pt.IgnoreMounts)&&h.props&&(d=h.prop(bt.mounted))&&!d.overlay)return new n(d.tree,f,t,o);let m=new n(h,f,t,o);return s&Pt.IncludeAnonymous||!m.type.isAnonymous?m:m.nextChild(e<0?h.children.length-1:0,e,i,r)}}}if(s&Pt.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?t=o.index+e:t=e<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let r;if(!(i&Pt.IgnoreOverlays)&&(r=this._tree.prop(bt.mounted))&&r.overlay){let s=t-this.from;for(let{from:o,to:u}of r.overlay)if((e>0?o<=s:o<s)&&(e<0?u>=s:u>s))return new n(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new qe(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return Ve(this,t,e,!1)}resolveInner(t,e=0){return Ve(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Ps(this,t)}getChild(t,e=null,i=null){let r=Ii(this,t,e,i);return r.length?r[0]:null}getChildren(t,e=null,i=null){return Ii(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return Ni(this,t)}};function Ii(n,t,e,i){let r=n.cursor(),s=[];if(!r.firstChild())return s;if(e!=null){for(;!r.type.is(e);)if(!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(t)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function Ni(n,t,e=t.length-1){for(let i=n.parent;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}var Un=class{constructor(t,e,i,r){this.parent=t,this.buffer=e,this.index=i,this.start=r}},oi=class n{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t,e-this.context.start,i);return s<0?null:new n(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&Pt.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return s<0?null:new n(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new n(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new n(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new qe(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1];t.push(i.slice(r,s,o)),e.push(0)}return new re(this.type,t,e,this.to-this.from)}resolve(t,e=0){return Ve(this,t,e,!1)}resolveInner(t,e=0){return Ve(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Ps(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let r=Ii(this,t,e,i);return r.length?r[0]:null}getChildren(t,e=null,i=null){return Ii(this,t,e,i)}get node(){return this}matchContext(t){return Ni(this,t)}},qe=class{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Ae)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:r}=this.buffer;return this.type=e||r.set.types[r.buffer[t]],this.from=i+r.buffer[t+1],this.to=i+r.buffer[t+2],!0}yield(t){return t?t instanceof Ae?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],t,e-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&Pt.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Pt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Pt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(e.findChild(r,this.index,-1,0,4))}else{let r=e.buffer[this.index+3];if(r<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:r}=this;if(r){if(t>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:e,parent:i}=r)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let s=e+t,o=t<0?-1:i._tree.children.length;s!=o;s+=t){let u=i._tree.children[s];if(this.mode&Pt.IncludeAnonymous||u instanceof Te||!u.type.isAnonymous||Wn(u))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=t;o;o=o._parent)if(o.index==r){if(r==this.index)return o;e=o,i=s+1;break t}r=this.stack[--s]}for(let r=i;r<this.stack.length;r++)e=new oi(this.buffer,e,this.stack[r]);return this.bufferNode=new oi(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let r=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;r&&e&&e(this),r=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,r=!0}}}matchContext(t){if(!this.buffer)return Ni(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let r=t.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return Ni(this.node,t,r);let o=i[e.buffer[this.stack[s]]];if(!o.isAnonymous){if(t[r]&&t[r]!=o.name)return!1;r--}}return!0}};function Wn(n){return n.children.some(t=>t instanceof Te||!t.type.isAnonymous||Wn(t))}function aa(n){var t;let{buffer:e,nodeSet:i,maxBufferLength:r=1024,reused:s=[],minRepeatType:o=i.types.length}=n,u=Array.isArray(e)?new qn(e,e.length):e,l=i.types,a=0,h=0;function f(A,O,g,k,C){let{id:T,start:_,end:I,size:H}=u,V=h;for(;H<0;)if(u.next(),H==-1){let nt=s[T];g.push(nt),k.push(_-A);return}else if(H==-3){a=T;return}else if(H==-4){h=T;return}else throw new RangeError(`Unrecognized record size: ${H}`);let J=l[T],it,Q,zt=_-A;if(I-_<=r&&(Q=S(u.pos-O,C))){let nt=new Uint16Array(Q.size-Q.skip),rt=u.pos-Q.size,gt=nt.length;for(;u.pos>rt;)gt=N(Q.start,nt,gt);it=new Te(nt,I-Q.start,i),zt=Q.start-A}else{let nt=u.pos-H;u.next();let rt=[],gt=[],P=T>=o?T:-1,U=0,X=I;for(;u.pos>nt;)P>=0&&u.id==P&&u.size>=0?(u.end<=X-r&&(m(rt,gt,_,U,u.end,X,P,V),U=rt.length,X=u.end),u.next()):f(_,nt,rt,gt,P);if(P>=0&&U>0&&U<rt.length&&m(rt,gt,_,U,_,X,P,V),rt.reverse(),gt.reverse(),P>-1&&U>0){let et=d(J);it=jn(J,rt,gt,0,rt.length,0,I-_,et,et)}else it=v(J,rt,gt,I-_,V-I)}g.push(it),k.push(zt)}function d(A){return(O,g,k)=>{let C=0,T=O.length-1,_,I;if(T>=0&&(_=O[T])instanceof re){if(!T&&_.type==A&&_.length==k)return _;(I=_.prop(bt.lookAhead))&&(C=g[T]+_.length+I)}return v(A,O,g,k,C)}}function m(A,O,g,k,C,T,_,I){let H=[],V=[];for(;A.length>k;)H.push(A.pop()),V.push(O.pop()+g-C);A.push(v(i.types[_],H,V,T-C,I-T)),O.push(C-g)}function v(A,O,g,k,C=0,T){if(a){let _=[bt.contextHash,a];T=T?[_].concat(T):[_]}if(C>25){let _=[bt.lookAhead,C];T=T?[_].concat(T):[_]}return new re(A,O,g,k,T)}function S(A,O){let g=u.fork(),k=0,C=0,T=0,_=g.end-r,I={size:0,start:0,skip:0};t:for(let H=g.pos-A;g.pos>H;){let V=g.size;if(g.id==O&&V>=0){I.size=k,I.start=C,I.skip=T,T+=4,k+=4,g.next();continue}let J=g.pos-V;if(V<0||J<H||g.start<_)break;let it=g.id>=o?4:0,Q=g.start;for(g.next();g.pos>J;){if(g.size<0)if(g.size==-3)it+=4;else break t;else g.id>=o&&(it+=4);g.next()}C=Q,k+=V,T+=it}return(O<0||k==A)&&(I.size=k,I.start=C,I.skip=T),I.size>4?I:void 0}function N(A,O,g){let{id:k,start:C,end:T,size:_}=u;if(u.next(),_>=0&&k<o){let I=g;if(_>4){let H=u.pos-(_-4);for(;u.pos>H;)g=N(A,O,g)}O[--g]=I,O[--g]=T-A,O[--g]=C-A,O[--g]=k}else _==-3?a=k:_==-4&&(h=k);return g}let M=[],B=[];for(;u.pos>0;)f(n.start||0,n.bufferStart||0,M,B,-1);let R=(t=n.length)!==null&&t!==void 0?t:M.length?B[0]+M[0].length:0;return new re(l[n.topID],M.reverse(),B.reverse(),R)}var Is=new WeakMap;function Mi(n,t){if(!n.isAnonymous||t instanceof Te||t.type!=n)return 1;let e=Is.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=n||!(i instanceof re)){e=1;break}e+=Mi(n,i)}Is.set(t,e)}return e}function jn(n,t,e,i,r,s,o,u,l){let a=0;for(let v=i;v<r;v++)a+=Mi(n,t[v]);let h=Math.ceil(a*1.5/8),f=[],d=[];function m(v,S,N,M,B){for(let R=N;R<M;){let A=R,O=S[R],g=Mi(n,v[R]);for(R++;R<M;R++){let k=Mi(n,v[R]);if(g+k>=h)break;g+=k}if(R==A+1){if(g>h){let k=v[A];m(k.children,k.positions,0,k.children.length,S[A]+B);continue}f.push(v[A])}else{let k=S[R-1]+v[R-1].length-O;f.push(jn(n,v,S,A,R,O,k,null,l))}d.push(O+B-s)}}return m(t,e,i,r,0),(u||l)(f,d,o)}var Ue=class n{constructor(t,e,i,r,s=!1,o=!1){this.from=t,this.to=e,this.tree=i,this.offset=r,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],i=!1){let r=[new n(0,t.length,t,0,!1,i)];for(let s of e)s.to>t.length&&r.push(s);return r}static applyChanges(t,e,i=128){if(!e.length)return t;let r=[],s=1,o=t.length?t[0]:null;for(let u=0,l=0,a=0;;u++){let h=u<e.length?e[u]:null,f=h?h.fromA:1e9;if(f-l>=i)for(;o&&o.from<f;){let d=o;if(l>=d.from||f<=d.to||a){let m=Math.max(d.from,l)-a,v=Math.min(d.to,f)-a;d=m>=v?null:new n(m,v,d.tree,d.offset+a,u>0,!!h)}if(d&&r.push(d),o.to>f)break;o=s<t.length?t[s++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return r}};var Uh=new bt({perNode:!0});var ha=0,ui=class{constructor(t,e){this.from=t,this.to=e}},ht=class{constructor(t={}){this.id=ha++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Ut.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}};ht.closedBy=new ht({deserialize:n=>n.split(" ")});ht.openedBy=new ht({deserialize:n=>n.split(" ")});ht.group=new ht({deserialize:n=>n.split(" ")});ht.contextHash=new ht({perNode:!0});ht.lookAhead=new ht({perNode:!0});ht.mounted=new ht({perNode:!0});var ca=Object.create(null),Ut=class n{constructor(t,e,i,r=0){this.name=t,this.props=e,this.id=i,this.flags=r}static define(t){let e=t.props&&t.props.length?Object.create(null):ca,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),r=new n(t.name||"",e,t.id,i);if(t.props){for(let s of t.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[s[0].id]=s[1]}}return r}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(ht.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let r of i.split(" "))e[r]=t[i];return i=>{for(let r=i.prop(ht.group),s=-1;s<(r?r.length:0);s++){let o=e[s<0?i.name:r[s]];if(o)return o}}}};Ut.none=new Ut("",Object.create(null),0,8);var Ri=class n{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let r=null;for(let s of t){let o=s(i);o&&(r||(r=Object.assign({},i.props)),r[o[0].id]=o[1])}e.push(r?new Ut(i.name,r,i.id,i.flags):i)}return new n(e)}},Pi=new WeakMap,Ds=new WeakMap,Ot;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(Ot||(Ot={}));var Dt=class n{constructor(t,e,i,r,s){if(this.type=t,this.children=e,this.positions=i,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,u]of s)this.props[typeof o=="number"?o:o.id]=u}}toString(){let t=this.prop(ht.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let r=i.toString();r&&(e&&(e+=","),e+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new je(this.topNode,t)}cursorAt(t,e=0,i=0){let r=Pi.get(this)||this.topNode,s=new je(r);return s.moveTo(t,e),Pi.set(this,s._tree),s}get topNode(){return new Ee(this,0,0,null)}resolve(t,e=0){let i=We(Pi.get(this)||this.topNode,t,e,!1);return Pi.set(this,i),i}resolveInner(t,e=0){let i=We(Ds.get(this)||this.topNode,t,e,!0);return Ds.set(this,i),i}iterate(t){let{enter:e,leave:i,from:r=0,to:s=this.length}=t,o=t.mode||0,u=(o&Ot.IncludeAnonymous)>0;for(let l=this.cursor(o|Ot.IncludeAnonymous);;){let a=!1;if(l.from<=s&&l.to>=r&&(!u&&l.type.isAnonymous||e(l)!==!1)){if(l.firstChild())continue;a=!0}for(;a&&i&&(u||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;a=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:Qn(Ut.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,r)=>new n(this.type,e,i,r,this.propValues),t.makeTree||((e,i,r)=>new n(Ut.none,e,i,r)))}static build(t){return fa(t)}};Dt.empty=new Dt(Ut.none,[],[],0);var Gn=class n{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new n(this.buffer,this.index)}},Oe=class n{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return Ut.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],r=this.set.types[e],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),t+=4,i==t)return s;let o=[];for(;t<i;)o.push(this.childString(t)),t=this.buffer[t+3];return s+"("+o.join(",")+")"}findChild(t,e,i,r,s){let{buffer:o}=this,u=-1;for(let l=t;l!=e&&!(Bs(s,r,o[l+1],o[l+2])&&(u=l,i>0));l=o[l+3]);return u}slice(t,e,i){let r=this.buffer,s=new Uint16Array(e-t),o=0;for(let u=t,l=0;u<e;){s[l++]=r[u++],s[l++]=r[u++]-i;let a=s[l++]=r[u++]-i;s[l++]=r[u++]-t,o=Math.max(o,a)}return new n(s,o,this.set)}};function Bs(n,t,e,i){switch(n){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function Ls(n,t){let e=n.childBefore(t);for(;e;){let i=e.lastChild;if(!i||i.to!=e.to)break;i.type.isError&&i.from==i.to?(n=e,e=i.prevSibling):e=i}return n}function We(n,t,e,i){for(var r;n.from==n.to||(e<1?n.from>=t:n.from>t)||(e>-1?n.to<=t:n.to<t);){let o=!i&&n instanceof Ee&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=i?0:Ot.IgnoreOverlays;if(i)for(let o=n,u=o.parent;u;o=u,u=o.parent)o instanceof Ee&&o.index<0&&((r=u.enter(t,e,s))===null||r===void 0?void 0:r.from)!=o.from&&(n=u);for(;;){let o=n.enter(t,e,s);if(!o)return n;n=o}}var Ee=class n{constructor(t,e,i,r){this._tree=t,this.from=e,this.index=i,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,r,s=0){for(let o=this;;){for(let{children:u,positions:l}=o._tree,a=e>0?u.length:-1;t!=a;t+=e){let h=u[t],f=l[t]+o.from;if(Bs(r,i,f,f+h.length)){if(h instanceof Oe){if(s&Ot.ExcludeBuffers)continue;let d=h.findChild(0,h.buffer.length,e,i-f,r);if(d>-1)return new li(new Kn(o,h,t,f),null,d)}else if(s&Ot.IncludeAnonymous||!h.type.isAnonymous||Jn(h)){let d;if(!(s&Ot.IgnoreMounts)&&h.props&&(d=h.prop(ht.mounted))&&!d.overlay)return new n(d.tree,f,t,o);let m=new n(h,f,t,o);return s&Ot.IncludeAnonymous||!m.type.isAnonymous?m:m.nextChild(e<0?h.children.length-1:0,e,i,r)}}}if(s&Ot.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?t=o.index+e:t=e<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let r;if(!(i&Ot.IgnoreOverlays)&&(r=this._tree.prop(ht.mounted))&&r.overlay){let s=t-this.from;for(let{from:o,to:u}of r.overlay)if((e>0?o<=s:o<s)&&(e<0?u>=s:u>s))return new n(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new je(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return We(this,t,e,!1)}resolveInner(t,e=0){return We(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Ls(this,t)}getChild(t,e=null,i=null){let r=Bi(this,t,e,i);return r.length?r[0]:null}getChildren(t,e=null,i=null){return Bi(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return Li(this,t)}};function Bi(n,t,e,i){let r=n.cursor(),s=[];if(!r.firstChild())return s;if(e!=null){for(;!r.type.is(e);)if(!r.nextSibling())return s}for(;;){if(i!=null&&r.type.is(i))return s;if(r.type.is(t)&&s.push(r.node),!r.nextSibling())return i==null?s:[]}}function Li(n,t,e=t.length-1){for(let i=n.parent;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}var Kn=class{constructor(t,e,i,r){this.parent=t,this.buffer=e,this.index=i,this.start=r}},li=class n{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t,e-this.context.start,i);return s<0?null:new n(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&Ot.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return s<0?null:new n(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new n(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new n(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new je(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,r=this.index+4,s=i.buffer[this.index+3];if(s>r){let o=i.buffer[this.index+1];t.push(i.slice(r,s,o)),e.push(0)}return new Dt(this.type,t,e,this.to-this.from)}resolve(t,e=0){return We(this,t,e,!1)}resolveInner(t,e=0){return We(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Ls(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let r=Bi(this,t,e,i);return r.length?r[0]:null}getChildren(t,e=null,i=null){return Bi(this,t,e,i)}get node(){return this}matchContext(t){return Li(this,t)}},je=class{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Ee)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:r}=this.buffer;return this.type=e||r.set.types[r.buffer[t]],this.from=i+r.buffer[t+1],this.to=i+r.buffer[t+2],!0}yield(t){return t?t instanceof Ee?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],t,e-this.buffer.start,i);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&Ot.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ot.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Ot.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let r=i<0?0:this.stack[i]+4;if(this.index!=r)return this.yieldBuf(e.findChild(r,this.index,-1,0,4))}else{let r=e.buffer[this.index+3];if(r<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(r)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:r}=this;if(r){if(t>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:e,parent:i}=r)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let s=e+t,o=t<0?-1:i._tree.children.length;s!=o;s+=t){let u=i._tree.children[s];if(this.mode&Ot.IncludeAnonymous||u instanceof Oe||!u.type.isAnonymous||Jn(u))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let r=this.index,s=this.stack.length;s>=0;){for(let o=t;o;o=o._parent)if(o.index==r){if(r==this.index)return o;e=o,i=s+1;break t}r=this.stack[--s]}for(let r=i;r<this.stack.length;r++)e=new li(this.buffer,e,this.stack[r]);return this.bufferNode=new li(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let r=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(r=!0)}for(;r&&e&&e(this),r=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,r=!0}}}matchContext(t){if(!this.buffer)return Li(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let r=t.length-1,s=this.stack.length-1;r>=0;s--){if(s<0)return Li(this.node,t,r);let o=i[e.buffer[this.stack[s]]];if(!o.isAnonymous){if(t[r]&&t[r]!=o.name)return!1;r--}}return!0}};function Jn(n){return n.children.some(t=>t instanceof Oe||!t.type.isAnonymous||Jn(t))}function fa(n){var t;let{buffer:e,nodeSet:i,maxBufferLength:r=1024,reused:s=[],minRepeatType:o=i.types.length}=n,u=Array.isArray(e)?new Gn(e,e.length):e,l=i.types,a=0,h=0;function f(A,O,g,k,C){let{id:T,start:_,end:I,size:H}=u,V=h;for(;H<0;)if(u.next(),H==-1){let nt=s[T];g.push(nt),k.push(_-A);return}else if(H==-3){a=T;return}else if(H==-4){h=T;return}else throw new RangeError(`Unrecognized record size: ${H}`);let J=l[T],it,Q,zt=_-A;if(I-_<=r&&(Q=S(u.pos-O,C))){let nt=new Uint16Array(Q.size-Q.skip),rt=u.pos-Q.size,gt=nt.length;for(;u.pos>rt;)gt=N(Q.start,nt,gt);it=new Oe(nt,I-Q.start,i),zt=Q.start-A}else{let nt=u.pos-H;u.next();let rt=[],gt=[],P=T>=o?T:-1,U=0,X=I;for(;u.pos>nt;)P>=0&&u.id==P&&u.size>=0?(u.end<=X-r&&(m(rt,gt,_,U,u.end,X,P,V),U=rt.length,X=u.end),u.next()):f(_,nt,rt,gt,P);if(P>=0&&U>0&&U<rt.length&&m(rt,gt,_,U,_,X,P,V),rt.reverse(),gt.reverse(),P>-1&&U>0){let et=d(J);it=Qn(J,rt,gt,0,rt.length,0,I-_,et,et)}else it=v(J,rt,gt,I-_,V-I)}g.push(it),k.push(zt)}function d(A){return(O,g,k)=>{let C=0,T=O.length-1,_,I;if(T>=0&&(_=O[T])instanceof Dt){if(!T&&_.type==A&&_.length==k)return _;(I=_.prop(ht.lookAhead))&&(C=g[T]+_.length+I)}return v(A,O,g,k,C)}}function m(A,O,g,k,C,T,_,I){let H=[],V=[];for(;A.length>k;)H.push(A.pop()),V.push(O.pop()+g-C);A.push(v(i.types[_],H,V,T-C,I-T)),O.push(C-g)}function v(A,O,g,k,C=0,T){if(a){let _=[ht.contextHash,a];T=T?[_].concat(T):[_]}if(C>25){let _=[ht.lookAhead,C];T=T?[_].concat(T):[_]}return new Dt(A,O,g,k,T)}function S(A,O){let g=u.fork(),k=0,C=0,T=0,_=g.end-r,I={size:0,start:0,skip:0};t:for(let H=g.pos-A;g.pos>H;){let V=g.size;if(g.id==O&&V>=0){I.size=k,I.start=C,I.skip=T,T+=4,k+=4,g.next();continue}let J=g.pos-V;if(V<0||J<H||g.start<_)break;let it=g.id>=o?4:0,Q=g.start;for(g.next();g.pos>J;){if(g.size<0)if(g.size==-3)it+=4;else break t;else g.id>=o&&(it+=4);g.next()}C=Q,k+=V,T+=it}return(O<0||k==A)&&(I.size=k,I.start=C,I.skip=T),I.size>4?I:void 0}function N(A,O,g){let{id:k,start:C,end:T,size:_}=u;if(u.next(),_>=0&&k<o){let I=g;if(_>4){let H=u.pos-(_-4);for(;u.pos>H;)g=N(A,O,g)}O[--g]=I,O[--g]=T-A,O[--g]=C-A,O[--g]=k}else _==-3?a=k:_==-4&&(h=k);return g}let M=[],B=[];for(;u.pos>0;)f(n.start||0,n.bufferStart||0,M,B,-1);let R=(t=n.length)!==null&&t!==void 0?t:M.length?B[0]+M[0].length:0;return new Dt(l[n.topID],M.reverse(),B.reverse(),R)}var Rs=new WeakMap;function Di(n,t){if(!n.isAnonymous||t instanceof Oe||t.type!=n)return 1;let e=Rs.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=n||!(i instanceof Dt)){e=1;break}e+=Di(n,i)}Rs.set(t,e)}return e}function Qn(n,t,e,i,r,s,o,u,l){let a=0;for(let v=i;v<r;v++)a+=Di(n,t[v]);let h=Math.ceil(a*1.5/8),f=[],d=[];function m(v,S,N,M,B){for(let R=N;R<M;){let A=R,O=S[R],g=Di(n,v[R]);for(R++;R<M;R++){let k=Di(n,v[R]);if(g+k>=h)break;g+=k}if(R==A+1){if(g>h){let k=v[A];m(k.children,k.positions,0,k.children.length,S[A]+B);continue}f.push(v[A])}else{let k=S[R-1]+v[R-1].length-O;f.push(Qn(n,v,S,A,R,O,k,null,l))}d.push(O+B-s)}}return m(t,e,i,r,0),(u||l)(f,d,o)}var zi=class{startParse(t,e,i){return typeof t=="string"&&(t=new Yn(t)),i=i?i.length?i.map(r=>new ui(r.from,r.to)):[new ui(0,0)]:[new ui(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let r=this.startParse(t,e,i);for(;;){let s=r.advance();if(s)return s}}},Yn=class{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}};var jh=new ht({perNode:!0});var Zn=class n{constructor(t,e,i,r,s,o,u,l,a,h=0,f){this.p=t,this.stack=e,this.state=i,this.reducePos=r,this.pos=s,this.score=o,this.buffer=u,this.bufferBase=l,this.curContext=a,this.lookAhead=h,this.parent=f}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let r=t.parser.context;return new n(t,[],e,i,i,0,[],0,r?new Fi(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let i=t>>19,r=t&65535,{parser:s}=this.p,o=s.dynamicPrecedence(r);if(o&&(this.score+=o),i==0){this.pushState(s.getGoto(this.state,r,!0),this.reducePos),r<s.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,4,!0),this.reduceContext(r,this.reducePos);return}let u=this.stack.length-(i-1)*3-(t&262144?6:0),l=u?this.stack[u-2]:this.p.ranges[0].from,a=this.reducePos-l;a>=2e3&&!(!((e=this.p.parser.nodeSet.types[r])===null||e===void 0)&&e.isAnonymous)&&(l==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=a):this.p.lastBigReductionSize<a&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=l,this.p.lastBigReductionSize=a));let h=u?this.stack[u-1]:0,f=this.bufferBase+this.buffer.length-h;if(r<s.minRepeatTerm||t&131072){let d=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,l,d,f+4,!0)}if(t&262144)this.state=this.stack[u];else{let d=this.stack[u-3];this.state=s.getGoto(d,r,!0)}for(;this.stack.length>u;)this.stack.pop();this.reduceContext(r,l)}storeNode(t,e,i,r=4,s=!1){if(t==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,u=this.buffer.length;if(u==0&&o.parent&&(u=o.bufferBase-o.parent.bufferBase,o=o.parent),u>0&&o.buffer[u-4]==0&&o.buffer[u-1]>-1){if(e==i)return;if(o.buffer[u-2]>=e){o.buffer[u-2]=i;return}}}if(!s||this.pos==i)this.buffer.push(t,e,i,r);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0)for(;o>0&&this.buffer[o-2]>i;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,r>4&&(r-=4);this.buffer[o]=t,this.buffer[o+1]=e,this.buffer[o+2]=i,this.buffer[o+3]=r}}shift(t,e,i){let r=this.pos;if(t&131072)this.pushState(t&65535,this.pos);else if(t&262144)this.pos=i,this.shiftContext(e,r),e<=this.p.parser.maxNode&&this.buffer.push(e,r,i,4);else{let s=t,{parser:o}=this.p;(i>this.pos||e<=o.maxNode)&&(this.pos=i,o.stateFlag(s,1)||(this.reducePos=i)),this.pushState(s,r),this.shiftContext(e,r),e<=o.maxNode&&this.buffer.push(e,r,i,4)}}apply(t,e,i){t&65536?this.reduce(t):this.shift(t,e,i)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let r=this.pos;this.reducePos=this.pos=r+t.length,this.pushState(e,r),this.buffer.push(i,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),r=t.bufferBase+e;for(;t&&r==t.bufferBase;)t=t.parent;return new n(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,r,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new $n(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(i==0)return!1;if(!(i&65536))return!0;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let r=[];for(let s=0,o;s<e.length;s+=2)(o=e[s+1])!=this.state&&this.p.parser.hasAction(o,t)&&r.push(e[s],o);if(this.stack.length<120)for(let s=0;r.length<8&&s<e.length;s+=2){let o=e[s+1];r.some((u,l)=>l&1&&u==o)||r.push(e[s],o)}e=r}let i=[];for(let r=0;r<e.length&&i.length<4;r+=2){let s=e[r+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(e[r],this.pos),o.score-=200,i.push(o)}return i}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if(!(e&65536))return!1;if(!t.validAction(this.state,e)){let i=e>>19,r=e&65535,s=this.stack.length-i*3;if(s<0||t.getGoto(this.stack[s],r,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;e=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],i=(r,s)=>{if(!e.includes(r))return e.push(r),t.allActions(r,o=>{if(!(o&393216))if(o&65536){let u=(o>>19)-s;if(u>1){let l=o&65535,a=this.stack.length-u*3;if(a>=0&&t.getGoto(this.stack[a],l,!1)>=0)return u<<19|65536|l}}else{let u=i(o,s+1);if(u!=null)return u}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:t}=this.p;return t.data[t.stateSlot(this.state,1)]==65535&&!t.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new Fi(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}},Fi=class{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}},$n=class{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=t&65535,i=t>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=r}},tr=class n{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,this.index==0&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new n(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;t!=null&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new n(this.stack,this.pos,this.index)}};function ai(n,t=Uint16Array){if(typeof n!="string")return n;let e=null;for(let i=0,r=0;i<n.length;){let s=0;for(;;){let o=n.charCodeAt(i++),u=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,u=!0),s+=l,u)break;s*=46}e?e[r++]=s:e=new t(s)}return e}var Ge=class{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}},zs=new Ge,er=class{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=zs,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,r=this.rangeIndex,s=this.pos+t;for(;s<i.from;){if(!r)return null;let o=this.ranges[--r];s-=i.from-o.to,i=o}for(;e<0?s>i.to:s>=i.to;){if(r==this.ranges.length-1)return null;let o=this.ranges[++r];s+=o.from-i.to,i=o}return s}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e=this.chunkOff+t,i,r;if(e>=0&&e<this.chunk.length)i=this.pos+t,r=this.chunk.charCodeAt(e);else{let s=this.resolveOffset(t,1);if(s==null)return-1;if(i=s,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let o=this.rangeIndex,u=this.range;for(;u.to<=i;)u=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>u.to&&(this.chunk2=this.chunk2.slice(0,u.to-i)),r=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),r}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=zs,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let r of this.ranges){if(r.from>=e)break;r.to>t&&(i+=this.input.read(Math.max(r.from,t),Math.min(r.to,e)))}return i}},pe=class{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:i}=e.p;Us(this.data,t,e,this.id,i.data,i.tokenPrecTable)}};pe.prototype.contextual=pe.prototype.fallback=pe.prototype.extend=!1;var ue=class{constructor(t,e,i){this.precTable=e,this.elseToken=i,this.data=typeof t=="string"?ai(t):t}token(t,e){let i=t.pos,r=0;for(;;){let s=t.next<0,o=t.resolveOffset(1,1);if(Us(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(this.elseToken==null)return;if(s||r++,o==null)break;t.reset(o,t.token)}r&&(t.reset(i,t.token),t.acceptToken(this.elseToken,r))}};ue.prototype.contextual=pe.prototype.fallback=pe.prototype.extend=!1;function Us(n,t,e,i,r,s){let o=0,u=1<<i,{dialect:l}=e.p.parser;t:for(;u&n[o];){let a=n[o+1];for(let m=o+3;m<a;m+=2)if((n[m+1]&u)>0){let v=n[m];if(l.allows(v)&&(t.token.value==-1||t.token.value==v||pa(v,t.token.value,r,s))){t.acceptToken(v);break}}let h=t.next,f=0,d=n[o+2];if(t.next<0&&d>f&&n[a+d*3-3]==65535&&n[a+d*3-3]==65535){o=n[a+d*3-1];continue t}for(;f<d;){let m=f+d>>1,v=a+m+(m<<1),S=n[v],N=n[v+1]||65536;if(h<S)d=m;else if(h>=N)f=m+1;else{o=n[v+2],t.advance();continue t}}break}}function Fs(n,t,e){for(let i=t,r;(r=n[i])!=65535;i++)if(r==e)return i-t;return-1}function pa(n,t,e,i){let r=Fs(e,i,t);return r<0||Fs(e,i,n)<r}var Ft=typeof process<"u"&&process.env&&/\bparse\b/.test(process.env.LOG),Xn=null;function Hs(n,t,e){let i=n.cursor(Ot.IncludeAnonymous);for(i.moveTo(t);;)if(!(e<0?i.childBefore(t):i.childAfter(t)))for(;;){if((e<0?i.to<t:i.from>t)&&!i.type.isError)return e<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(n.length,Math.max(i.from+1,t+25));if(e<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return e<0?0:n.length}}var ir=class{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?Hs(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?Hs(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],r=this.index[e];if(r==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=i.children[r],o=this.start[e]+i.positions[r];if(o>t)return this.nextStart=o,null;if(s instanceof Dt){if(o==t){if(o<this.safeFrom)return null;let u=o+s.length;if(u<=this.safeTo){let l=s.prop(ht.lookAhead);if(!l||u+l<this.fragment.to)return s}}this.index[e]++,o+s.length>=Math.max(this.safeFrom,t)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[e]++,this.nextStart=o+s.length}}},nr=class{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(i=>new Ge)}getActions(t){let e=0,i=null,{parser:r}=t.p,{tokenizers:s}=r,o=r.stateSlot(t.state,3),u=t.curContext?t.curContext.hash:0,l=0;for(let a=0;a<s.length;a++){if(!(1<<a&o))continue;let h=s[a],f=this.tokens[a];if(!(i&&!h.fallback)&&((h.contextual||f.start!=t.pos||f.mask!=o||f.context!=u)&&(this.updateCachedToken(f,h,t),f.mask=o,f.context=u),f.lookAhead>f.end+25&&(l=Math.max(f.lookAhead,l)),f.value!=0)){let d=e;if(f.extended>-1&&(e=this.addActions(t,f.extended,f.end,e)),e=this.addActions(t,f.value,f.end,e),!h.extend&&(i=f,e>d))break}}for(;this.actions.length>e;)this.actions.pop();return l&&t.setLookAhead(l),!i&&t.pos==this.stream.end&&(i=new Ge,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new Ge,{pos:i,p:r}=t;return e.start=i,e.end=Math.min(i+1,r.stream.end),e.value=i==r.stream.end?r.parser.eofTerm:0,e}updateCachedToken(t,e,i){let r=this.stream.clipPos(i.pos);if(e.token(this.stream.reset(r,t),i),t.value>-1){let{parser:s}=i.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==t.value){let u=s.specializers[o](this.stream.read(t.start,t.end),i);if(u>=0&&i.p.parser.dialect.allows(u>>1)){u&1?t.extended=u>>1:t.value=u>>1;break}}}else t.value=0,t.end=this.stream.clipPos(r+1)}putAction(t,e,i,r){for(let s=0;s<r;s+=3)if(this.actions[s]==t)return r;return this.actions[r++]=t,this.actions[r++]=e,this.actions[r++]=i,r}addActions(t,e,i,r){let{state:s}=t,{parser:o}=t.p,{data:u}=o;for(let l=0;l<2;l++)for(let a=o.stateSlot(s,l?2:1);;a+=3){if(u[a]==65535)if(u[a+1]==1)a=oe(u,a+2);else{r==0&&u[a+1]==2&&(r=this.putAction(oe(u,a+2),e,i,r));break}u[a]==e&&(r=this.putAction(oe(u,a+1),e,i,r))}return r}},rr=class{constructor(t,e,i,r){this.parser=t,this.input=e,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new er(e,r),this.tokens=new nr(t,this.stream),this.topTerm=t.top[1];let{from:s}=r[0];this.stacks=[Zn.start(this,t.top[0],s)],this.fragments=i.length&&this.stream.end-s>t.bufferLength*4?new ir(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t=this.stacks,e=this.minStackPos,i=this.stacks=[],r,s;if(this.bigReductionCount>300&&t.length==1){let[o]=t;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<t.length;o++){let u=t[o];for(;;){if(this.tokens.mainToken=null,u.pos>e)i.push(u);else{if(this.advanceStack(u,i,t))continue;{r||(r=[],s=[]),r.push(u);let l=this.tokens.getMainToken(u);s.push(l.value,l.end)}}break}}if(!i.length){let o=r&&ma(r);if(o)return Ft&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw Ft&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+e);this.recovering||(this.recovering=5)}if(this.recovering&&r){let o=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,s,i);if(o)return Ft&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(i.length>o)for(i.sort((u,l)=>l.score-u.score);i.length>o;)i.pop();i.some(u=>u.reducePos>e)&&this.recovering--}else if(i.length>1){t:for(let o=0;o<i.length-1;o++){let u=i[o];for(let l=o+1;l<i.length;l++){let a=i[l];if(u.sameState(a)||u.buffer.length>500&&a.buffer.length>500)if((u.score-a.score||u.buffer.length-a.buffer.length)>0)i.splice(l--,1);else{i.splice(o--,1);continue t}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let o=1;o<i.length;o++)i[o].pos<this.minStackPos&&(this.minStackPos=i[o].pos);return null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let r=t.pos,{parser:s}=this,o=Ft?this.stackID(t)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let a=t.curContext&&t.curContext.tracker.strict,h=a?t.curContext.hash:0;for(let f=this.fragments.nodeAt(r);f;){let d=this.parser.nodeSet.types[f.type.id]==f.type?s.getGoto(t.state,f.type.id):-1;if(d>-1&&f.length&&(!a||(f.prop(ht.contextHash)||0)==h))return t.useNode(f,d),Ft&&console.log(o+this.stackID(t)+` (via reuse of ${s.getName(f.type.id)})`),!0;if(!(f instanceof Dt)||f.children.length==0||f.positions[0]>0)break;let m=f.children[0];if(m instanceof Dt&&f.positions[0]==0)f=m;else break}}let u=s.stateSlot(t.state,4);if(u>0)return t.reduce(u),Ft&&console.log(o+this.stackID(t)+` (via always-reduce ${s.getName(u&65535)})`),!0;if(t.stack.length>=15e3)for(;t.stack.length>9e3&&t.forceReduce(););let l=this.tokens.getActions(t);for(let a=0;a<l.length;){let h=l[a++],f=l[a++],d=l[a++],m=a==l.length||!i,v=m?t:t.split();if(v.apply(h,f,d),Ft&&console.log(o+this.stackID(v)+` (via ${h&65536?`reduce of ${s.getName(h&65535)}`:"shift"} for ${s.getName(f)} @ ${r}${v==t?"":", split"})`),m)return!0;v.pos>r?e.push(v):i.push(v)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return Vs(t,e),!0}}runRecovery(t,e,i){let r=null,s=!1;for(let o=0;o<t.length;o++){let u=t[o],l=e[o<<1],a=e[(o<<1)+1],h=Ft?this.stackID(u)+" -> ":"";if(u.deadEnd&&(s||(s=!0,u.restart(),Ft&&console.log(h+this.stackID(u)+" (restarted)"),this.advanceFully(u,i))))continue;let f=u.split(),d=h;for(let m=0;f.forceReduce()&&m<10&&(Ft&&console.log(d+this.stackID(f)+" (via force-reduce)"),!this.advanceFully(f,i));m++)Ft&&(d=this.stackID(f)+" -> ");for(let m of u.recoverByInsert(l))Ft&&console.log(h+this.stackID(m)+" (via recover-insert)"),this.advanceFully(m,i);this.stream.end>u.pos?(a==u.pos&&(a++,l=0),u.recoverByDelete(l,a),Ft&&console.log(h+this.stackID(u)+` (via recover-delete ${this.parser.getName(l)})`),Vs(u,i)):(!r||r.score<u.score)&&(r=u)}return r}stackToTree(t){return t.close(),Dt.build({buffer:tr.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(Xn||(Xn=new WeakMap)).get(t);return e||Xn.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}};function Vs(n,t){for(let e=0;e<t.length;e++){let i=t[e];if(i.pos==n.pos&&i.sameState(n)){t[e].score<n.score&&(t[e]=n);return}}t.push(n)}var sr=class{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||this.disabled[t]==0}};var Hi=class n extends zi{constructor(t){if(super(),this.wrappers=[],t.version!=14)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let u=0;u<t.repeatNodeCount;u++)e.push("");let i=Object.keys(t.topRules).map(u=>t.topRules[u][1]),r=[];for(let u=0;u<e.length;u++)r.push([]);function s(u,l,a){r[u].push([l,l.deserialize(String(a))])}if(t.nodeProps)for(let u of t.nodeProps){let l=u[0];typeof l=="string"&&(l=ht[l]);for(let a=1;a<u.length;){let h=u[a++];if(h>=0)s(h,l,u[a++]);else{let f=u[a+-h];for(let d=-h;d>0;d--)s(u[a++],l,f);a++}}}this.nodeSet=new Ri(e.map((u,l)=>Ut.define({name:l>=this.minRepeatTerm?void 0:u,id:l,props:r[l],top:i.indexOf(l)>-1,error:l==0,skipped:t.skippedNodes&&t.skippedNodes.indexOf(l)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=1024;let o=ai(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let u=0;u<this.specializerSpecs.length;u++)this.specialized[u]=this.specializerSpecs[u].term;this.specializers=this.specializerSpecs.map(qs),this.states=ai(t.states,Uint32Array),this.data=ai(t.stateData),this.goto=ai(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(u=>typeof u=="number"?new pe(o,u):u),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let r=new rr(this,t,e,i);for(let s of this.wrappers)r=s(r,t,e,i);return r}getGoto(t,e,i=!1){let r=this.goto;if(e>=r[0])return-1;for(let s=r[e+1];;){let o=r[s++],u=o&1,l=r[s++];if(u&&i)return l;for(let a=s+(o>>1);s<a;s++)if(r[s]==t)return l;if(u)return-1}}hasAction(t,e){let i=this.data;for(let r=0;r<2;r++)for(let s=this.stateSlot(t,r?2:1),o;;s+=3){if((o=i[s])==65535)if(i[s+1]==1)o=i[s=oe(i,s+2)];else{if(i[s+1]==2)return oe(i,s+2);break}if(o==e||o==0)return oe(i,s+1)}return 0}stateSlot(t,e){return this.states[t*6+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,i=>i==e?!0:null)}allActions(t,e){let i=this.stateSlot(t,4),r=i?e(i):void 0;for(let s=this.stateSlot(t,1);r==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=oe(this.data,s+2);else break;r=e(oe(this.data,s+1))}return r}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=oe(this.data,i+2);else break;if(!(this.data[i+2]&1)){let r=this.data[i+1];e.some((s,o)=>o&1&&s==r)||e.push(this.data[i],r)}}return e}configure(t){let e=Object.assign(Object.create(n.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(i=>{let r=t.tokenizers.find(s=>s.from==i);return r?r.to:i})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((i,r)=>{let s=t.specializers.find(u=>u.from==i.external);if(!s)return i;let o=Object.assign(Object.assign({},i),{external:s.to});return e.specializers[r]=qs(o),o})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),t.strict!=null&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),t.bufferLength!=null&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return e==null?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map(()=>!1);if(t)for(let s of t.split(" ")){let o=e.indexOf(s);o>=0&&(i[o]=!0)}let r=null;for(let s=0;s<e.length;s++)if(!i[s])for(let o=this.dialects[e[s]],u;(u=this.data[o++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[u]=1;return new sr(t,i,r)}static deserialize(t){return new n(t)}};function oe(n,t){return n[t]|n[t+1]<<16}function ma(n){let t=null;for(let e of n){let i=e.p.stoppedAt;(e.pos==e.p.stream.end||i!=null&&e.pos>i)&&e.p.parser.stateFlag(e.state,2)&&(!t||t.score<e.score)&&(t=e)}return t}function qs(n){if(n.external){let t=n.extend?1:0;return(e,i)=>n.external(e,i)<<1|t}return n.get}var or=require("@codemirror/language"),ga=Hi.deserialize({version:14,states:"$zQQOPOOOfOQO'#C^OnOSO'#C_OvOWO'#C`O!OO`O'#CbO!WOpO'#CcOOOO'#Cg'#CgOOOO'#Cd'#CdQQOPOOOOOO,58x,58xO!`OQO,58xOOOO,58y,58yO!eOSO,58yO!jOWO,58zO!rOWO,58zOOOO,58|,58|O!wO`O,58|OOOO,58},58}O!|OpO,58}OOOO-E6b-E6bOOOO1G.d1G.dOOOO1G.e1G.eOOOO1G.f1G.fO#ROWO1G.fO#WOWO1G.fOOOO1G.h1G.hOOOO1G.i1G.iOOOO7+$Q7+$QO#`OWO7+$QOOOO<<Gl<<Gl",stateData:"#e~OYVO[PO_QObROeSOhTO~O]YO^XO~O`[OaZO~OT]Oc^O~Of`Og_O~OibOjaO~O^dO~OaeO~OcgOdfO~OThO~OgiO~OjjO~OdkO~OclOdkO~OdmO~O",goto:"k[PP]]]P]]aPPgTUOWQWORcWTVOW",nodeNames:"\u26A0 CriticMarkup Addition Deletion Substitution MSub Comment Highlight",maxTerm:26,skippedNodes:[0],repeatNodeCount:1,tokenData:"'o~R]XYzYZz]^zpqzqrzrszs#Oz#O#P!P#P#oz#o#p#s#p;'Sz;'S;=`'i<%lOz~!POY~~!UXY~rsz!P!Qz#O#Pz#U#Vz#Y#Zz#b#cz#f#gz#h#iz#i#j!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![#Z!c!i#Z#T#Z#Z~#^R!Q![#g!c!i#g#T#Z#g~#jR!Q![z!c!iz#T#Zz~#xVY~vw$_{|%`}!O%k!^!_%v!_!`'V!`!a']#r#s'c~$bP#Z#[$e~$hP#h#i$k~$nP!]!^$q~$tPvw$w~$zP#Z#[$}~%QP#h#i%T~%WP!]!^%Z~%`Oe~~%cP{|%f~%kO[~~%nP}!O%q~%vO_~~%yQ#W#X&P#a#b&h~&SP#X#Y&V~&YP#`#a&]~&`P!`!a&c~&hOb~~&kP#T#U&n~&qP#f#g&t~&wP#_#`&z~&}P!`!a'Q~'VOh~~'YP!_!`'Q~'`P!`!a%Z~'fP#r#s&c~'lP;=`<%lz",tokenizers:[5,new ue("h~RP{|U~XP{|[~_P#q#rb~gO^~~",23,13),new ue("h~RP}!OU~XP}!O[~_P#q#rb~gOa~~",23,16),new ue("!x~RQ!^!_X#r#s!S~[P!P!Q_~bP#W#Xe~hP#X#Yk~nP#`#aq~tP!`!aw~zP#q#r}~!SOd~~!VRvw!`!`!a!r#r#sw~!cP#Z#[!f~!iP#h#i!l~!oP!]!^!r~!wOT~~",85,19),new ue("!g~RQvwX!^!_!`~[P#`#a_~bP#h#ie~hP!]!^k~nPvwq~tP#`#aw~zP#h#i}~!QP!]!^!T~!WP#q#r!Z~!`Og~~!cP!^!_!T~",68,22),new ue("!a~RQ!^!_X!_!`!Y~[P!P!Q_~bP#a#be~hP#T#Uk~nP#f#gq~tP#_#`w~zP!`!a}~!QP#q#r!T~!YOj~~!]P!_!`}~",62,25)],topRules:{CriticMarkup:[0,1]},tokenPrec:0}),hi=or.LRLanguage.define({name:"criticmarkup",parser:ga.configure({})});var Gi=require("@codemirror/state");var rc=require("@codemirror/state");var $h=require("@codemirror/state");function Ws(n,t){let e={};for(let i in n)n[i]!==t[i]&&(e[i]=n[i]);return e}var js={Addition:0,Deletion:1,Substitution:2,Highlight:3,Comment:4},ic={0:["+","+"],1:["-","-"],2:["~","~"],3:["=","="],4:[">","<"]},$={0:["{++","++}"],1:["{--","--}"],2:["{~~","~>","~~}"],3:["{==","==}"],4:["{>>","<<}"]},Gs={"{++":["++}"],"{--":["--}"],"{~~":["~>","~~}"],"{==":["==}"],"{>>":["<<}"]};function ur(n,t,e){let i="",r=0;for(let s of e)i+=n.slice(r,s.from)+t(s,n),r=s.to;return i+n.slice(r)}var Me=class{constructor(t,e,i,r,s){this.from=t;this.to=e;this.type=i;this.repr=r;this.text=s}num_ignore_chars=6;copy(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}equals(t){return this.type===t.type&&this.text===t.text}num_ignored_chars(t,e){return t>=this.to||e<=this.from||this.encloses_range(t,e)?0:this.fully_in_range(t,e)?6:3}part_is_empty(t){return!1}empty(){return this.to-this.from===6}unwrap(){return this.text.slice(3,-3)}unwrap_bracket(t=!1){return t?this.text.slice(3):this.text.slice(0,-3)}unwrap_parts(){return[this.unwrap()]}unwrap_slice(t,e){return this.text.slice(Math.max(3,t),Math.min(this.text.length-3,e))}fully_in_range(t,e,i=!1){return i?t<=this.from+3&&this.to-3<=e:t<=this.from&&this.to<=e}partially_in_range(t,e){return!(t>this.to||e<this.from)}encloses(t,e=!1){return e?this.from<t&&this.to>t:this.from<=t&&this.to>=t}encloses_range(t,e,i=!1){return i?this.from<t&&this.to>e:this.from<=t&&this.to>=e}part_encloses_range(t,e,i){return this.encloses_range(t,e)}accept(){return this.text}reject(){return this.text}touches(t){return this.from===t||this.to===t}cursor_inside(t){return this.from+3<t&&this.to-3>t}cursor_outside(t,e){return e?t<=this.from:t>=this.to}range_infront(t,e){return this.to<t}range_behind(t,e){return e<this.from}cursor_infront(t,e,i=!1){return i?e?t<this.from+3:t>this.to-3:e?t<=this.from+3:t>=this.to-3}cursor_behind(t,e,i=!1){return i?e?t>this.from+3:t<this.to-3:e?t>=this.from+3:t<=this.to-3}cursor_move_outside(t,e){return e?(this.touches_right_bracket(t,!0,!1)&&(t=this.to-3),this.touches_left_bracket(t,!1,!0)&&(t=this.from)):(this.touches_left_bracket(t,!0,!1)&&(t=this.from+3),this.touches_right_bracket(t,!1,!0)&&(t=this.to)),t}cursor_move_inside(t,e){return e?this.touches_left_bracket(t,!0,!1)&&(t=this.from+3):this.touches_right_bracket(t,!0,!1)&&(t=this.to-3),t}touches_left_bracket(t,e=!1,i=!1){return t+(e?0:1)>=this.from&&t+(i?0:1)<=this.from+3}touches_separator(t,e=!1,i=!1){return!1}touches_right_bracket(t,e=!1,i=!1){return t-(i?0:1)>=this.to-3&&t-(e?0:1)<=this.to}touches_bracket(t,e,i=!1,r=!1){return e?this.touches_left_bracket(t,i,r):this.touches_right_bracket(t,i,r)}touches_brackets(t,e=!1,i=!1){return this.touches_left_bracket(t,e,i)||this.touches_right_bracket(t,e,i)}postprocess(t=!0,e=0,i="div",r=null,s){let o=s??this.text;return!s&&t&&(this.to>=o.length&&!o.endsWith($[this.type].at(-1))?o=this.unwrap_bracket(!0):o=this.unwrap()),`<${i} class='criticmarkup-${this.repr.toLowerCase()}'>${o}</${i}>`}apply_change(t){this.from=t.mapPos(this.from,1),this.to=t.mapPos(this.to,1)}apply_offset(t){this.from+=t,this.to+=t}get length(){return this.to-this.from-6}},Vi=class extends Me{constructor(t,e,i){super(t,e,0,"Addition",i)}accept(){return this.unwrap()}reject(){return""}postprocess(t=!0,e=0,i="div",r=null,s){let o=s??this.text;return!s&&t&&(this.to>=o.length&&!o.endsWith($[this.type].at(-1))?o=this.unwrap_bracket(!0):o=this.unwrap()),e?e===1?o=`<${i} class='criticmarkup-preview'>${o}</${i}>`:o=`<${i} class='criticmarkup-preview'/>`:o=`<${i} class='criticmarkup-preview criticmarkup-addition'>${o}</${i}>`,o}},qi=class extends Me{constructor(t,e,i){super(t,e,1,"Deletion",i)}accept(){return""}reject(){return this.unwrap()}postprocess(t=!0,e=0,i="div",r=null,s){let o=s??this.text;return!s&&t&&(this.to>=o.length&&!o.endsWith($[this.type].at(-1))?o=this.unwrap_bracket(!0):o=this.unwrap()),e?e===1?o=`<${i} class='criticmarkup-preview'/>`:o=`<${i} class='criticmarkup-preview'>${o}</${i}>`:o=`<${i} class='criticmarkup-preview criticmarkup-deletion'>${o}</${i}>`,o}},me=class extends Me{constructor(e,i,r,s){super(e,r,2,"Substitution",s);this.middle=i}num_ignore_chars=8;num_ignored_chars(e,i){return i<=this.from||e>=this.to?0:i<=this.from+3||e>=this.to-3?3:i<=this.middle+2||e>=this.middle?5:8}unwrap(){return this.text.slice(3,this.middle)+this.text.slice(this.middle+2,-3)}unwrap_parts(){return[this.text.slice(3,this.middle),this.text.slice(this.middle+2,-3)]}unwrap_parts_bracket(e,i=0){return e?[this.text.slice(3,this.middle),this.text.slice(this.middle+2)]:[this.text.slice(0,this.middle),this.text.slice(this.middle+2,-3)]}unwrap_slice(e,i){return e>=this.middle?this.text.slice(Math.max(this.middle+2,e),Math.min(this.to-3,i)):i<=this.middle?this.text.slice(Math.max(this.from+3,e),Math.min(this.middle,i)):this.text.slice(Math.max(this.from+3,e),this.middle)+this.text.slice(this.middle+2,Math.min(this.to-3,i))}accept(){return this.unwrap_parts()[1]}reject(){return this.unwrap_parts()[0]}touches_separator(e,i=!1,r=!1){return e+(i?0:1)>=this.middle&&e-(r?0:1)<=this.middle+2}cursor_move_outside(e,i){return i?(this.touches_right_bracket(e,!0,!1)&&(e=this.to-3),this.touches_separator(e,!0,!0)&&(e=this.middle),this.touches_left_bracket(e,!1,!0)&&(e=this.from)):(this.touches_left_bracket(e,!0,!1)&&(e=this.from+3),this.touches_separator(e,!0,!0)&&(e=this.middle+2),this.touches_right_bracket(e,!1,!0)&&(e=this.to)),e}part_encloses_range(e,i,r){return r?this.from<=e&&i<=this.middle+2:this.middle<=e&&i<=this.to}empty(){return this.from+3===this.middle&&this.middle+2===this.to-3}part_is_empty(e){return e?this.from+3===this.middle:this.middle+2===this.to-3}postprocess(e=!0,i=0,r="div",s=null,o){let u=o??this.text,l=[u];return!o&&e&&(this.to>=u.length&&!u.endsWith($[2][2])?l=this.unwrap_parts_bracket(!0):this.from<=0&&!u.startsWith($[2][0])?l=this.unwrap_parts_bracket(!1):l=this.unwrap_parts()),l.length===1?i?i===1?u=s?"":`<${r} class='criticmarkup-preview'>${l[0]}</${r}>`:u=s?`<${r} class='criticmarkup-preview'>${l[0]}</${r}>`:"":u=`<${r} class='criticmarkup-preview criticmarkup-${s?"deletion":"addition"}'>${l[0]}</${r}>`:i?i===1?u=`<${r} class='criticmarkup-preview'>${l[1]}</${r}>`:u=`<${r} class='criticmarkup-preview'>${l[0]}</${r}>`:(u="",l[0].length&&(u+=`<${r} class='criticmarkup-preview criticmarkup-deletion'>${l[0]}</${r}>`),l[1].length&&(u+=`<${r} class='criticmarkup-preview criticmarkup-addition'>${l[1]}</${r}>`)),u}apply_change(e){super.apply_change(e),this.to=e.mapPos(this.to,1)}apply_offset(e){super.apply_offset(e),this.middle+=e}get length(){return this.to-this.from-8}},Ui=class extends Me{constructor(t,e,i){super(t,e,3,"Highlight",i)}},Wi=class extends Me{constructor(t,e,i){super(t,e,4,"Comment",i)}};function lr(n,t,e,i,r){switch(e){case"Addition":return new Vi(n,t,i);case"Deletion":return new qi(n,t,i);case"Substitution":return new me(n,r,t,i);case"Highlight":return new Ui(n,t,i);case"Comment":return new Wi(n,t,i)}}var ji=class n{nodes;constructor(t){this.nodes=t}empty(){return this.nodes.length===0}get(t){return t<0?this.nodes[this.nodes.length+t]:this.nodes[t]}at_cursor(t,e=!1,i=!1){return i?this.nodes.slice().reverse().find(r=>r.encloses(t,e)):this.nodes.find(r=>r.encloses(t,e))}between_cursor(t,e,i,r=!1){let s=[];if(i){let o=this.nodes.reverse().slice().findIndex(u=>u.to<=t);for(let u=o;u>=0;u--){let l=this.nodes[u];if(r?l.to<e:l.to<=e)break;s.push(l)}}else{let o=this.nodes.findIndex(u=>u.from>=t);for(let u=o;u<this.nodes.length;u++){let l=this.nodes[u];if(r?l.from>e:l.from>=e)break;s.push(l)}}return s}range_contains_node(t,e){return this.nodes.some(i=>i.partially_in_range(t,e))}range_passes_node(t,e,i){return i?this.nodes.slice().reverse().find(r=>t>=r.to&&r.to>=e||t>r.from&&r.from>=e):this.nodes.find(r=>t<=r.from&&r.from<=e||t<r.to&&r.to<=e)}between_two_nodes(t){let e=this.at_cursor(t,!1,!0),i=this.at_cursor(t,!1,!1);return e&&i&&e.to===i.from}near_cursor(t,e){return e?this.nodes.slice().reverse().find(i=>i.to<=t):this.nodes.find(i=>t<=i.from)}directly_adjacent_to_cursor(t,e){return this.nodes.find(i=>e?i.to===t:i.from===t)}adjacent_to_cursor(t,e,i=!1,r=!1){let s=e?this.nodes.slice().reverse():this.nodes;return r?s.find(o=>e?(i?o.from:o.to)<t:t<(i?o.to:o.from)):s.find(o=>e?(i?o.from:o.to)<=t:t<=(i?o.to:o.from))}adjacent_to_node(t,e,i=!1){let r=this.nodes.findIndex(o=>o===t);if(r===-1)return null;let s=e?this.nodes[r-1]:this.nodes[r+1];if(!s)return null;if(i){if(e?s.to===t.from:t.to===s.from)return s}else return s;return null}nodes_in_range(t,e,i=!0){return i?this.nodes.filter(r=>r.partially_in_range(t,e)):this.nodes.filter(r=>r.fully_in_range(t,e))}filter_range(t,e,i=!0){return new n(this.nodes_in_range(t,e,i))}get_sibling(t,e){let i=this.nodes.indexOf(t);return e?this.nodes[i-1]:this.nodes[i+1]}num_ignored_chars_range(t,e,i=null){if(i||(i=this.nodes_in_range(t,e,!0)),!i.length)return 0;let r,s;return i[0].encloses(t)&&(r=i.shift()),i[i.length-1]?.encloses(e)&&(s=i.pop()),{num_ignored_chars:i.reduce((o,u)=>o+u.num_ignore_chars,0),left_node:r,right_node:s}}unwrap_in_range(t,e=0,i=t.length,r=null){let s=t.toString(),o=s.slice(e,i),u,l;if(r||(r=this.nodes_in_range(e,i,!0)),r.length===0)return{output:o,from:e,to:i};let a="";e<r[0].from?a+=s.slice(e,r[0].from):u=r[0];let h=-1;for(let m of r)h!==-1&&(a+=s.slice(h,m.from)),a+=m.unwrap_slice(Math.max(0,e-m.from),i-m.from),h=m.to;i>=r.at(-1).to?a+=s.slice(r.at(-1).to,i):l=r.at(-1);let f=u?u.cursor_move_outside(e,!0):e,d=l?l.cursor_move_outside(i,!1):i;return(f!==e||e===u?.from)&&(u=void 0),(d!==i||i===l?.to)&&(l=void 0),{output:a,from:f,to:d,front_node:u,back_node:l}}applyChanges(t){let e=[];for(let i of this.nodes){let r=i.copy();r.apply_change(t),e.push(r)}return new n(e)}},ar={0:"plus-circle",1:"minus-square",2:"replace",3:"highlighter",4:"message-square"},ci={0:Vi,1:qi,3:Ui,2:me,4:Wi};function fi(n){let t=n.field(vt).nodes;return t.nodes.length?n.selection.ranges.some(e=>t.range_contains_node(e.from,e.to)):!1}function Ki(n,t,e,i){let r=[];return n.iterate({from:e,to:i,enter:s=>{if(s.type.name==="\u26A0")return!1;if(!(s.type.name==="CriticMarkup"||s.type.name==="MSub"))if(s.type.name==="Substitution"){if(s.node.firstChild?.type.name!=="MSub")return;r.push(lr(s.from,s.to,s.type.name,t.slice(s.from,s.to),s.node.firstChild?.from))}else r.push(lr(s.from,s.to,s.type.name,t.slice(s.from,s.to),s.node.firstChild?.from))}}),new ji(r)}function di(n,t,e){let i=hi.parser.parse(n);return Ki(i,n,t,e)}function Ke(n,t,e,i=!1,r=null){let s=n,o=e.doc.lineAt(s),u=e.charCategorizer(s);r===Gi.CharCategory.Space&&(r=null);let l=null;for(r;;){if(s==(t?o.to:o.from)){s==n&&o.number!=(t?e.doc.lines:1)&&(s+=t?1:-1);break}let a=(0,Gi.findClusterBreak)(o.text,s-o.from,t)+o.from,h=o.text.slice(Math.min(s,a)-o.from,Math.max(s,a)-o.from);if(l=u(h),r!=null&&l!=r)if(r==1&&i)i=!1;else break;(h!=" "||s!=n)&&(r=l),s=a}return[s,r]}function Ie(n,t,e=!1){let i=t.doc.lineAt(n),r=t.charCategorizer(n);return e&&(n-=1),r(i.text.slice(n-i.from,n-i.from+1))}function hr(n){return n.annotations.map(t=>t.value).filter(t=>typeof t=="string")}function cr(n){return n.startState.selection.ranges[0].from!==n.selection.ranges[0].from||n.startState.selection.ranges[0].to!==n.selection.ranges[0].to}function Ks(n,t){let e=[];return n.iterChanges((i,r,s,o,u)=>{let l="";if(u.text.length===1&&u.text[0]==="")l+="";else{let a=u.text.join("");l+=a.length?a:`
`}e.push({from:i,to:r,offset:{removed:r-i,added:o-s},inserted:l,deleted:r-i?t.sliceString(i,r):""})}),e}function fr(n,t,e=!1){return{from:n.from,to:n.to,offset:{removed:e?n.to-n.from:0,added:0},inserted:"",deleted:e?t.sliceString(n.from,n.to):""}}var vt=Ys.StateField.define({create(n){let t=n.doc.toString(),e=hi.parser.parse(t),i=Ue.addTree(e),r=Ki(e,t);return{tree:e,nodes:r,fragments:i}},update(n,t){if(!t.docChanged)return n;let e=[];t.changes.iterChangedRanges((u,l,a,h)=>e.push({fromA:u,toA:l,fromB:a,toB:h}));let i=Ue.applyChanges(n.fragments,e),r=t.state.doc.toString(),s=hi.parser.parse(r,i);i=Ue.addTree(s,i);let o=Ki(s,r);return{tree:s,nodes:o,fragments:i}}});var br=require("@codemirror/state");var Js=require("@codemirror/state");function dr(n,t,e,i,r=null){let s=null,o=n;[n,s]=Ke(n,!e,i,r===1||r===null,r);let u=t.adjacent_to_cursor(o,e);if(!u||!(e?n<=u.to:n>=u.from))return n;let l=e?-1:1;if(n===o)return(e?u.from:u.to)-3*l;let a=e?u.to:u.from,h=a,f=e?u.from:u.to;for(;u?.empty();)h=e?u.to:u.from,f=e?u.from:u.to,u=t.adjacent_to_node(u,e,!0);if(s=Ie(h-l,i,e),!u){let m=Ie(f,i,e);return s!==null&&s!==1&&s!==m?f:dr(f,t,e,i,s)}let d=pr(h+3*l,u,t,e,i,s);return d===h+3*l?a:d}function pr(n,t,e,i,r,s=null){let o=i?t.to:t.from,u=i?t.from:t.to,l=i?-1:1,a=null;if(!t.empty()&&!t.cursor_infront(n,i)){let d=t.empty()||t.part_is_empty(!i)?null:Ie(o+3*l,r,i);if(d!==null&&s!==null&&s!==1&&d!==s)return n;if(t.touches_bracket(n,!i)&&(n=o+3*l),t.touches_separator(n)&&(n=t.middle+(i?0:2)),[n,a]=Ke(n,!i,r,s===1||s===null,s),t.part_is_empty(i)?a=s:a=Ie(u-4*l,r,i),t.touches_separator(n,!0,!0))if(t.part_is_empty(i))n=u+3*l;else{let m=t.middle+(i?0:2),v=Ie(m,r,i);a!==null&&a!==1&&a!==v||(n=Ke(m,!i,r,s===1||s===null,s)[0])}if(!t.cursor_infront(n,i))return n}let h=e.adjacent_to_node(t,i,!0),f=u;for(;h?.empty();)f=i?h.from:h.to,h=e.adjacent_to_node(h,i,!0);if(h){let d=i?h.to:h.from,m=pr(d+3*l,h,e,i,r,a);return m===d+3*l?u-3*l:m}else{let d=Ie(f,r,i);return a!==null&&a!==1&&a!==d?u-3*l:dr(f,e,i,r,a)}}function Yi(n,t,e,i,r,s,o,u=!1){let l=n.head,a=n.anchor,h=e.adjacent_to_cursor(t.head,r,!0,!s);if(h&&(r?l<=h.to:l>=h.from))if(s)h.encloses(t.head)?l=pr(t.head,h,e,r,i):l=dr(t.head,e,r,i);else{let f=l+(r?1:-1)+(!r&&u?1:0);if(h.touches_bracket(f,!r,!0,!0)&&(f=r?h.to-3:h.from+3),h.touches_separator(f,!0,!0)&&(f=h.middle+(r?0:2),l=f+(r?-1:1)),h.touches_brackets(f,!0,!0)){let d=h;for(h.touches_bracket(f,r,!0,!0)&&(h=e.adjacent_to_node(h,r,!0));h?.empty();)d=h,h=e.adjacent_to_node(h,r,!0);h?l=r?h.to-4:h.from+4:l=r?Math.max(0,d.from-1):Math.min(d.to+1,i.doc.length),u&&!r&&(l-=1)}}return o||(a=l),{selection:Js.EditorSelection.range(a,l)}}var mr=require("@codemirror/state");function Ji(n,t,e,i,r,s,o,u,l=!1){let a=[],h=e,f=0,d=n.from,m=n.to,v;if(!o){let A=r?m:d,O=s?Ke(A,!r,u)[0]:A+(r?-1:1),C=Yi({from:0,to:0,head:O,anchor:O},{from:0,to:0,head:A,anchor:A},t,u,r,s,o,!1);r?d=C.selection.head:m=C.selection.head}let S=t.filter_range(d,m,!0),N=S.nodes.length===1&&S.nodes[0].encloses_range(d,m),M=null,B=null;if(N&&(S.nodes[0].type===1||S.nodes[0].type===2&&S.nodes[0].part_encloses_range(d,m,!0)))v=r?d:m;else{let A=S.at_cursor(d),O=S.at_cursor(m,!1,!0),g=d;if(A){if(d!==A.to&&(d=A.cursor_move_outside(d,A.type!==1)),d===A.from){let V=t.adjacent_to_node(A,!0,!0);V&&V.type===1?A=V:A=void 0}A&&(A.type===1&&O?.type===2&&d<=O.middle+2?(M=A.to,B=n.from,d=A.from,A=void 0):A.type===2&&d<=A.middle?(M=d+3,d=A.from,A=void 0):d===A.to&&(A.type===1?d=A.to-3:A=void 0))}if(O){if(m!==O.from&&(m=O.cursor_move_outside(m,O.type===1)),m===O.to){let V=t.adjacent_to_node(O,!1,!0);V&&(V.type===1||V.type===2)?O=V:O=void 0}O&&m===O.from&&(O.type===1?m=O.from+3:O.type===2?(A?.type===1&&(M=d,d=A.from,console.error("BIG OL WARNING"),A=void 0),m=O.from+3):O=void 0)}let k=t.unwrap_in_range(i,d,m),C="";A&&((A.type===0||A.type===3||A.type===4)&&(C+=$[A.type][1]),A.type===2&&(d<=A.middle&&(C+=$[2][1]),C+=$[2][2])),A?.type!==1&&O?.type!==2&&(C+=$[1][0]),O?.type===2&&(C+=$[2][0]);let T=C.length;C+=k.output,(!O||O.type===0||O.type===3||O.type===4)&&(C+=$[1][1]),O&&((O.type===0||O.type===3||O.type===4)&&(C+=$[O.type][0]),O.type===2&&m>=O.middle+2&&(C+=$[2][1]));let _=C.length-k.output.length-T,I=T+_,H=m-d-k.output.length;M!==null&&(f-=6),e-=H-I,f+=H-I+T,a.push({from:d,to:m,insert:C}),M&&(k=t.unwrap_in_range(i,g,m)),v=(M??d)+(r?0:k.output.length)}let R;return l?R=mr.EditorSelection.range((B??d)+h,m+e):R=mr.EditorSelection.cursor(v+f+e),{changes:a,selection:R,offset:e}}var Qs=require("@codemirror/state");function gr(n,t,e,i,r,s,o){let u=r.adjacent_to_node(s,o,!0);return u&&(u.type===0||o&&u.type===2)?n=o?u.to-3:u.from+3:(n=o?s.from:s.to,i.inserted=`{++${i.inserted}++}`,t+=6,e-=3),{insertion_start:n,offset:t,node_offset:e}}function Xs(n,t,e){let i=t.at_cursor(n.to);e+=n.offset.added;let r=[],s=0,o=n.from;i?i.type===2?i.touches_left_bracket(n.to,!0,!0)?{insertion_start:o,offset:e,node_offset:s}=gr(o,e,s,n,t,i,!0):i.touches_separator(n.to,!1,!0)?o=i.middle:i.touches_right_bracket(n.to)&&(o=i.to-3):i.type===0?i.touches_left_bracket(n.from)?o=i.from+3:i.touches_right_bracket(n.to)&&(o=i.to-3):i.touches_left_bracket(n.from)?{insertion_start:o,offset:e,node_offset:s}=gr(o,e,s,n,t,i,!0):i.touches_right_bracket(n.to)&&({insertion_start:o,offset:e,node_offset:s}=gr(o,e,s,n,t,i,!1)):(n.inserted=`{++${n.inserted}++}`,e+=6,s-=3),r.push({from:o,to:o,insert:n.inserted});let u=Qs.EditorSelection.cursor(o+s+e);return{changes:r,selection:u,offset:e}}var Zs=require("@codemirror/state");function Qi(n,t,e,i){let r=[],s=0,o=n.from,u=n.to,l=null,a=t.filter_range(o,u,!0),h=a.at_cursor(o),f=a.at_cursor(u,!1,!0);if(h){if(o!==h.to&&(o=h.cursor_move_outside(o,h.type!==1)),o===h.from){let B=t.adjacent_to_node(h,!0,!0);B&&B.type===1?h=B:h=void 0}h&&(h.type===1||h.type===2&&o>=h.middle)&&(o=h.from,h=void 0)}if(f){if(u!==f.from&&(u=f.cursor_move_outside(u,!1)),u===f.to){let B=t.adjacent_to_node(f,!1,!0);B?.type===0?f=B:f=void 0}f&&(f.type===0?(l=Math.max(f.from+3,u),u=f.to,f=void 0):u===f.from?f=void 0:f.type===2&&u>=f.middle&&(l=u,u=f.to,f=void 0))}let d=t.unwrap_in_range(i,o,u).output,m=n.inserted;if(l){let B=u-l-3;m+=d.slice(d.length-B),d=d.slice(0,d.length-B)}let v="";h?h.type===2?o>=h.middle&&(v+=$[2][0]):(v+=$[h.type][1],v+=$[2][0]):v+=$[2][0],v+=d,v+=$[2][1],v+=m,f?.type!==0&&(v+=$[2][2]),f&&f.type!==0&&(v+=$[f.type][0],s-=3,f.type===2&&u>=f.middle&&(v+=$[2][1],s-=2)),r.push({from:o,to:u,insert:v});let S=u-o-d.length,N=v.length-(d.length+m.length);e+=N-S+n.inserted.length,s-=3;let M=Zs.EditorSelection.cursor(u+s+e);return{changes:r,selection:M,offset:e}}var hf=require("@codemirror/view");function $s(n,t,e){if(t.clipboardData&&n.clipboard_remove_syntax){let i=e.state.selection.main,s=e.state.field(vt).nodes.unwrap_in_range(e.state.doc,i.from,i.to).output;t.clipboardData.setData("text/plain",s),t.preventDefault()}}function ba(n,t,e,i,r){let s=t.from,o=t.to,u=i.nodes_in_range(s,o),l=i.unwrap_in_range(n,s,o,u);s=l.from,o=l.to;let a=0,h=0,f="";return l.front_node?l.front_node.type!==e&&(f+=$[l.front_node.type].at(-1),a+=3,f+=$[e].at(0)):f+=$[e].at(0),f+=l.output,l.back_node?l.back_node.type!==e&&(f+=$[e].at(-1),h-=3,f+=$[l.back_node.type].at(0)):f+=$[e].at(-1),h+=f.length-(t.to-t.from),{changes:[{from:s,to:o,insert:f}],selection:br.EditorSelection.range(s+a+r,o+h+r),offset:f.length-(t.to-t.from)}}function va(n,t,e){let i=n.cm.state.field(vt).nodes,r=n.cm.state.doc,s=[],o=[],u,l=0;e===1?u=(a,h,f,d)=>Ji(fr(h,a,!0),d,l,a,!1,!1,!0,n.cm.state,!0):e===2?u=(a,h,f,d)=>Qi(fr(h,a,!0),d,l,a):u=(a,h,f,d)=>ba(a,h,f,d,l);for(let a of n.cm.state.selection.ranges){let{changes:h,selection:f,offset:d}=u(r,a,e,i);s.push(...h),o.push(f),l=d}n.cm.dispatch(n.cm.state.update({changes:s,selection:br.EditorSelection.create(o)}))}function Ye(n,t,e){let i=n.field(vt).nodes;return(t||e)&&(i=i.filter_range(t??0,e??1/0,!0)),i.nodes.filter(r=>r.type===0||r.type===1||r.type===2).map(r=>({from:r.from,to:r.to,insert:r.accept()}))}async function to(n,t){t.sort((r,s)=>r.from-s.from);let e=await app.vault.cachedRead(n),i=ur(e,(r,s)=>r.accept(),t);await app.vault.modify(n,i)}function Je(n,t,e){let i=n.field(vt).nodes;return(t||e)&&(i=i.filter_range(t??0,e??1/0,!0)),i.nodes.filter(r=>r.type===0||r.type===1||r.type===2).map(r=>({from:r.from,to:r.to,insert:r.reject()}))}async function eo(n,t){t.sort((r,s)=>r.from-s.from);let e=await app.vault.cachedRead(n),i=ur(e,(r,s)=>r.reject(),t);await app.vault.modify(n,i)}var ya=Object.entries(js).map(([n,t])=>({id:`commentator-toggle-${n.toLowerCase()}`,name:`Mark as ${n}`,icon:n.toLowerCase(),editor_context:!0,regular_callback:(e,i)=>{va(e,i,t)}})),pi=[...ya,{id:"commentator-accept-all-suggestions",name:"Accept all suggestions",icon:"check-check",editor_context:!0,regular_callback:(n,t)=>{n.cm.dispatch(n.cm.state.update({changes:Ye(n.cm.state)}))}},{id:"commentator-reject-all-suggestions",name:"Reject all suggestions",icon:"cross",editor_context:!0,regular_callback:(n,t)=>{n.cm.dispatch(n.cm.state.update({changes:Je(n.cm.state)}))}},{id:"commentator-accept-selected-suggestions",name:"Accept suggestions in selection",icon:"check",editor_context:!0,check_callback:(n,t,e)=>{let i=fi(t.cm.state);if(n||!i)return i;let s=t.cm.state.selection.ranges.map(o=>Ye(t.cm.state,o.from,o.to));t.cm.dispatch(t.cm.state.update({changes:s}))}},{id:"commentator-reject-selected-suggestions",name:"Reject suggestions in selection",icon:"cross",editor_context:!0,check_callback:(n,t,e)=>{let i=fi(t.cm.state);if(n||!i)return i;let s=t.cm.state.selection.ranges.map(o=>Je(t.cm.state,o.from,o.to));t.cm.dispatch(t.cm.state.update({changes:s}))}}];var io=app.workspace.on("editor-menu",(n,t)=>{fi(t.cm.state)&&(n.addItem(e=>{e.setTitle("Accept changes").setIcon("check").setSection("criticmarkup").onClick(()=>{let r=t.cm.state.selection.ranges.map(s=>Ye(t.cm.state,s.from,s.to));t.cm.dispatch(t.cm.state.update({changes:r}))})}),n.addItem(e=>{e.setTitle("Reject changes").setIcon("cross").setSection("criticmarkup").onClick(()=>{let r=t.cm.state.selection.ranges.map(s=>Je(t.cm.state,s.from,s.to));t.cm.dispatch(t.cm.state.update({changes:r}))})}))});var mi=require("@codemirror/state"),pt=require("@codemirror/view"),Zt=require("obsidian");var en=require("@codemirror/state"),uo=require("@codemirror/view");var Xt=require("@codemirror/state"),le=require("@codemirror/view");var vr=Xt.Facet.define(),ro=5,xa={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Xt.RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Xi=Xt.Facet.define();function so(n){return[wa(),Xi.of({...xa,...n})]}var yr=Xt.Facet.define({combine:n=>n.some(t=>t)});function wa(n){let t=[ka];return n&&n.fixed===!1&&t.push(yr.of(!0)),t}var ka=le.ViewPlugin.fromClass(class{constructor(n){this.view=n;this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(Xi).map(t=>new Zi(n,t));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!n.state.facet(yr),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM.nextSibling)}gutters;dom;fixed;prevViewport;update(n){if(this.updateGutters(n)){let t=this.prevViewport,e=n.view.viewport,i=Math.min(t.to,e.to)-Math.max(t.from,e.from);this.syncGutters(i<(e.to-e.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(yr)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let t=this.dom.nextSibling;n&&this.dom.remove();let e=Xt.RangeSet.iter(this.view.state.facet(vr),this.view.viewport.from),i=[],r=this.gutters.map(s=>new wr(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(s.type)){let o=!0;for(let u of s.type)if(u.type==le.BlockType.Text&&o){xr(e,i,u.from);for(let l of r)l.line(this.view,u,i);o=!1}else if(u.widget)for(let l of r)l.widget(this.view,u)}else if(s.type==le.BlockType.Text){xr(e,i,s.from);for(let o of r)o.line(this.view,s,i)}for(let s of r)s.finish();n&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(n){let t=n.startState.facet(Xi),e=n.state.facet(Xi),i=n.docChanged||n.heightChanged||n.viewportChanged||!Xt.RangeSet.eq(n.startState.facet(vr),n.state.facet(vr),n.view.viewport.from,n.view.viewport.to);if(t==e)for(let r of this.gutters)r.update(n)&&(i=!0);else{i=!0;let r=[];for(let s of e){let o=t.indexOf(s);o<0?r.push(new Zi(this.view,s)):(this.gutters[o].update(n),r.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),r.indexOf(s)<0&&s.destroy();for(let s of r)this.dom.appendChild(s.dom);this.gutters=r}return i}moveGutter(n){let t=this.gutters[0],e=t.elements.findIndex(u=>u.markers.includes(n));if(e===-1)return;let i=t.elements[e],r=i.markers.indexOf(n),s=50,o=i.dom.children[r].offsetTop-i.block.top-s;if(Math.abs(o)<10&&(o=0),o){let u=t.elements[0];u.dom.style.marginTop=parseInt(u.dom.style.marginTop||"0")-o+"px"}}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>le.EditorView.scrollMargins.of(t=>{let e=t.plugin(n);return!e||e.gutters.length==0||!e.fixed?null:t.textDirection==le.Direction.LTR?{left:e.dom.offsetWidth}:{right:e.dom.offsetWidth}})});function no(n){return Array.isArray(n)?n:[n]}function xr(n,t,e){for(;n.value&&n.from<=e;)n.from==e&&t.push(n.value),n.next()}var wr=class{constructor(t,e,i){this.gutter=t;this.cursor=Xt.RangeSet.iter(t.markers,e.from),this.height=i}cursor;i=0;previousEnd=0;height=0;async addElement(t,e,i){let{gutter:r}=this,s=Math.max(e.top-this.height,0),o=e.top<this.height?this.height:e.top,u=42,l=18,a=16,h=6,f=0,d=4,m=150,v=0;for(let S of i){let N=S.node.text.match(/\n/g)?.length||0,M=S.node.to-S.node.from-6-N,B=Math.max(1,Math.ceil(M/u))+N;v+=Math.min(m,B*l+a+h+d)+ro}if(v+=f,this.i==r.elements.length){let S=new $i(t,v,s,i,e);r.elements.push(S),r.dom.appendChild(S.dom)}else r.elements[this.i].update(t,v,s,i,e);this.height=o+v,this.i++}line(t,e,i){let r=[];xr(this.cursor,r,e.from),i.length&&(r=r.concat(i));let s=this.gutter.config.lineMarker(t,e,r);s&&r.unshift(s);let o=this.gutter;r.length==0&&!o.config.renderEmptyElements||this.addElement(t,e,r)}widget(t,e){let i=this.gutter.config.widgetMarker(t,e.widget,e);i&&this.addElement(t,e,[i])}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}},Zi=class{constructor(t,e){this.view=t;this.config=e;this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,r=>{let s=r.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=r.clientY;let u=t.lineBlockAtHeight(o-t.documentTop);e.domEventHandlers[i](t,u,r)&&r.preventDefault()});this.markers=no(e.markers(t)),e.initialSpacer&&(this.spacer=new $i(t,0,0,[e.initialSpacer(t)],null),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}dom;elements=[];markers;spacer=null;update(t){let e=this.markers;if(this.markers=no(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],t);r!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[r])}let i=t.view.viewport;return!Xt.RangeSet.eq(this.markers,e,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}},$i=class{dom;height=-1;above=0;markers=[];block=null;constructor(t,e,i,r,s){this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,r)}update(t,e,i,r,s=null){this.block=s,this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),_a(this.markers,r)||this.setMarkers(t,r)}setMarkers(t,e){let i="cm-gutterElement",r=this.dom.firstChild;for(let s=0,o=0;;){let u=o,l=s<e.length?e[s++]:null,a=!1;if(l){let h=l.elementClass;h&&(i+=" "+h);for(let f=o;f<this.markers.length;f++)if(this.markers[f].compare(l)){u=f,a=!0;break}}else u=this.markers.length;for(;o<u;){let h=this.markers[o++];if(h.toDOM){h.destroy(r);let f=r.nextSibling;r.remove(),r=f}}if(!l)break;if(l.toDOM)if(a)r=r.nextSibling;else{let h=l.toDOM(t);h.style.marginBottom=ro+"px",this.dom.insertBefore(h,r)}a&&o++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}};function _a(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].compare(t[e]))return!1;return!0}var Ne=require("obsidian"),kr=class extends uo.GutterMarker{constructor(e,i){super();this.node=e;this.view=i}comment=null;eq(e){return this.node.equals(e.node)}toDOM(){let e="";this.comment=createDiv({cls:e}),this.comment.contentEditable="false";let i=new Ne.Component;this.comment.classList.add("criticmarkup-gutter-comment");let r=this.node.unwrap();return Ne.MarkdownRenderer.render(app,r||"&nbsp;",this.comment,"",i),this.comment.onblur=()=>{this.comment.innerText===r?(this.comment.replaceChildren(),this.comment.innerText="",this.comment.contentEditable="false",Ne.MarkdownRenderer.render(app,r||"&nbsp;",this.comment,"",i)):setTimeout(()=>this.view.dispatch({changes:{from:this.node.from+3,to:this.node.to-3,insert:this.comment.innerText}}))},this.comment.onkeyup=s=>{(s.ctrlKey||s.metaKey)&&s.key==="Enter"&&this.comment.blur()},this.comment.ondblclick=s=>{s.stopPropagation(),this.comment.contentEditable="true",this.comment.replaceChildren(),this.comment.innerText=r,this.comment.focus()},this.comment.onclick=s=>{let o=this.view.lineBlockAt(this.node.from).top-100;setTimeout(()=>{this.view.plugin(_r[1][0][0]).moveGutter(this),this.view.scrollDOM.scrollTo({top:o,behavior:"smooth"})},200)},i.load(),this.comment}focus(){this.comment.focus()}};function oo(n){let t=new en.RangeSetBuilder,e=n.field(Ne.editorEditorField),i=n.field(vt).nodes,r=!1,s,o=null;for(let u of i.nodes){if(u.type!==4)continue;let l=n.doc.lineAt(u.from);r&&l.from<=o?l=s:(r=u.to>l.to,o=u.to,s=l),t.add(l.from,l.to-1,new kr(u,e))}return t.finish()}var tn=en.StateField.define({create(n){return oo(n)},update(n,t){return t.docChanged?oo(t.state):n}}),_r=[tn,so({class:"criticmarkup-comment-gutter"+(app.vault.getConfig("cssTheme")==="Minimal"?" is-minimal":""),markers:n=>n.state.field(tn)})];var ho=n=>mi.StateField.define({create(t){return pt.Decoration.none},update(t,e){let i=e.state.field(Zt.editorLivePreviewField),r=i!==e.startState.field(Zt.editorLivePreviewField);if(!e.docChanged&&!r&&t.size)return t;if(r&&!i)return pt.Decoration.none;let s=new mi.RangeSetBuilder,o=e.state.field(vt).nodes;if(i)for(let u of o.nodes)u.type===4&&s.add(u.from,u.to,pt.Decoration.replace({widget:new Sr(u,n.comment_style==="block")}));return s.finish()},provide(t){return pt.EditorView.decorations.from(t)}}),Sr=class extends pt.WidgetType{constructor(e,i=!1){super();this.node=e;this.is_block=i;this.component=new Zt.Component}tooltip=null;icon=null;component;focused=!1;renderTooltip(){if(!this.tooltip){this.tooltip=document.createElement("div"),this.tooltip.classList.add("criticmarkup-comment-tooltip"),Zt.MarkdownRenderer.render(app,this.node.text,this.tooltip,"",this.component),this.component.load(),this.icon.appendChild(this.tooltip);let e=this.icon.getBoundingClientRect(),i=this.tooltip.getBoundingClientRect();this.tooltip.style.left=e.x-i.x-i.width/2+12+"px"}}unrenderTooltip(){!this.focused&&this.tooltip&&(this.component.unload(),this.icon.removeChild(this.tooltip),this.tooltip=null)}toDOM(e){return this.icon=document.createElement("span"),this.icon.classList.add("criticmarkup-comment-icon"),(0,Zt.setIcon)(this.icon,"message-square"),this.is_block?this.icon.onclick=i=>{let r=e.state.field(tn);i.preventDefault(),r.between(this.node.from,this.node.to,(s,o,u)=>{if(this.node.equals(u.node))return u.comment.dispatchEvent(new MouseEvent("dblclick")),!1})}:this.node.length&&(this.icon.onmouseenter=()=>{this.renderTooltip()},this.icon.onclick=()=>{this.renderTooltip(),this.focused=!0},this.icon.onmouseleave=()=>{this.unrenderTooltip(),this.focused=!1}),this.icon}};function lo(n,t,e){e&&(n.push(pt.Decoration.replace({attributes:{"data-contents":"string"}}).range(t.from,t.from+3)),n.push(pt.Decoration.replace({attributes:{"data-contents":"string"}}).range(t.to-3,t.to)))}function ge(n,t,e,i){i&&(e?n.push(pt.Decoration.replace({attributes:{"data-contents":"string"}}).range(t.from,t.from+3)):n.push(pt.Decoration.replace({attributes:{"data-contents":"string"}}).range(t.to-3,t.to)))}function ao(n,t){n.push(pt.Decoration.replace({}).range(t.from,t.to))}function be(n,t,e,i=null){t.type===2?i?t.part_is_empty(!0)||n.push(pt.Decoration.mark({attributes:{"data-contents":"string"},class:e}).range(t.from+3,t.middle)):t.part_is_empty(!1)||n.push(pt.Decoration.mark({attributes:{"data-contents":"string"},class:e}).range(t.middle+2,t.to-3)):t.empty()||n.push(pt.Decoration.mark({attributes:{"data-contents":"string"},class:e}).range(t.from+3,t.to-3))}var co=n=>mi.StateField.define({create(t){return pt.Decoration.none},update(t,e){let i=e.state.field(Zt.editorLivePreviewField),r=e.state.field(vt).nodes,s=[];for(let o of r.nodes)if(n.preview_mode)n.preview_mode===1?o.type===0?(ge(s,o,!0,i),be(s,o,"criticmarkup-accepted"),ge(s,o,!1,i)):o.type===1?ao(s,o):o.type===2?(s.push(pt.Decoration.replace({}).range(o.from,o.from+3)),be(s,o,"criticmarkup-accepted",!0),s.push(pt.Decoration.replace({}).range(o.middle,o.to))):lo(s,o,i):n.preview_mode===2&&(o.type===0?ao(s,o):o.type===1?(ge(s,o,!0,i),be(s,o,"criticmarkup-accepted"),ge(s,o,!1,i)):o.type===2?(s.push(pt.Decoration.replace({}).range(o.from,o.middle+2)),be(s,o,"criticmarkup-accepted",!1),s.push(pt.Decoration.replace({}).range(o.to-3,o.to))):lo(s,o,i));else{let u=e.selection?.ranges?.some(l=>o.partially_in_range(l.from,l.to));!n.suggest_mode&&u&&!n.editor_styling?be(s,o,"criticmarkup-editing"):o.type===2?(ge(s,o,!0,i),be(s,o,"criticmarkup-editing criticmarkup-inline criticmarkup-deletion criticmarkup-substitution",!0),i&&s.push(pt.Decoration.replace({attributes:{"data-contents":"string"}}).range(o.middle,o.middle+2)),be(s,o,"criticmarkup-editing criticmarkup-inline criticmarkup-addition criticmarkup-substitution",!1),ge(s,o,!1,i)):(ge(s,o,!0,i),be(s,o,`criticmarkup-editing criticmarkup-inline criticmarkup-${o.repr.toLowerCase()}`),ge(s,o,!1,i))}return pt.Decoration.set(s)},provide(t){return pt.EditorView.decorations.from(t)}});var fo=new Uint16Array('\u1D41<\xD5\u0131\u028A\u049D\u057B\u05D0\u0675\u06DE\u07A2\u07D6\u080F\u0A4A\u0A91\u0DA1\u0E6D\u0F09\u0F26\u10CA\u1228\u12E1\u1415\u149D\u14C3\u14DF\u1525\0\0\0\0\0\0\u156B\u16CD\u198D\u1C12\u1DDD\u1F7E\u2060\u21B0\u228D\u23C0\u23FB\u2442\u2824\u2912\u2D08\u2E48\u2FCE\u3016\u32BA\u3639\u37AC\u38FE\u3A28\u3A71\u3AE0\u3B2E\u0800EMabcfglmnoprstu\\bfms\x7F\x84\x8B\x90\x95\x98\xA6\xB3\xB9\xC8\xCFlig\u803B\xC6\u40C6P\u803B&\u4026cute\u803B\xC1\u40C1reve;\u4102\u0100iyx}rc\u803B\xC2\u40C2;\u4410r;\uC000\u{1D504}rave\u803B\xC0\u40C0pha;\u4391acr;\u4100d;\u6A53\u0100gp\x9D\xA1on;\u4104f;\uC000\u{1D538}plyFunction;\u6061ing\u803B\xC5\u40C5\u0100cs\xBE\xC3r;\uC000\u{1D49C}ign;\u6254ilde\u803B\xC3\u40C3ml\u803B\xC4\u40C4\u0400aceforsu\xE5\xFB\xFE\u0117\u011C\u0122\u0127\u012A\u0100cr\xEA\xF2kslash;\u6216\u0176\xF6\xF8;\u6AE7ed;\u6306y;\u4411\u0180crt\u0105\u010B\u0114ause;\u6235noullis;\u612Ca;\u4392r;\uC000\u{1D505}pf;\uC000\u{1D539}eve;\u42D8c\xF2\u0113mpeq;\u624E\u0700HOacdefhilorsu\u014D\u0151\u0156\u0180\u019E\u01A2\u01B5\u01B7\u01BA\u01DC\u0215\u0273\u0278\u027Ecy;\u4427PY\u803B\xA9\u40A9\u0180cpy\u015D\u0162\u017Aute;\u4106\u0100;i\u0167\u0168\u62D2talDifferentialD;\u6145leys;\u612D\u0200aeio\u0189\u018E\u0194\u0198ron;\u410Cdil\u803B\xC7\u40C7rc;\u4108nint;\u6230ot;\u410A\u0100dn\u01A7\u01ADilla;\u40B8terDot;\u40B7\xF2\u017Fi;\u43A7rcle\u0200DMPT\u01C7\u01CB\u01D1\u01D6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01E2\u01F8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020FoubleQuote;\u601Duote;\u6019\u0200lnpu\u021E\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6A74\u0180git\u022F\u0236\u023Aruent;\u6261nt;\u622FourIntegral;\u622E\u0100fr\u024C\u024E;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6A2Fcr;\uC000\u{1D49E}p\u0100;C\u0284\u0285\u62D3ap;\u624D\u0580DJSZacefios\u02A0\u02AC\u02B0\u02B4\u02B8\u02CB\u02D7\u02E1\u02E6\u0333\u048D\u0100;o\u0179\u02A5trahd;\u6911cy;\u4402cy;\u4405cy;\u440F\u0180grs\u02BF\u02C4\u02C7ger;\u6021r;\u61A1hv;\u6AE4\u0100ay\u02D0\u02D5ron;\u410E;\u4414l\u0100;t\u02DD\u02DE\u6207a;\u4394r;\uC000\u{1D507}\u0100af\u02EB\u0327\u0100cm\u02F0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031Ccute;\u40B4o\u0174\u030B\u030D;\u42D9bleAcute;\u42DDrave;\u4060ilde;\u42DCond;\u62C4ferentialD;\u6146\u0470\u033D\0\0\0\u0342\u0354\0\u0405f;\uC000\u{1D53B}\u0180;DE\u0348\u0349\u034D\u40A8ot;\u60DCqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03CF\u03E2\u03F8ontourIntegra\xEC\u0239o\u0274\u0379\0\0\u037B\xBB\u0349nArrow;\u61D3\u0100eo\u0387\u03A4ft\u0180ART\u0390\u0396\u03A1rrow;\u61D0ightArrow;\u61D4e\xE5\u02CAng\u0100LR\u03AB\u03C4eft\u0100AR\u03B3\u03B9rrow;\u67F8ightArrow;\u67FAightArrow;\u67F9ight\u0100AT\u03D8\u03DErrow;\u61D2ee;\u62A8p\u0241\u03E9\0\0\u03EFrrow;\u61D1ownArrow;\u61D5erticalBar;\u6225n\u0300ABLRTa\u0412\u042A\u0430\u045E\u047F\u037Crrow\u0180;BU\u041D\u041E\u0422\u6193ar;\u6913pArrow;\u61F5reve;\u4311eft\u02D2\u043A\0\u0446\0\u0450ightVector;\u6950eeVector;\u695Eector\u0100;B\u0459\u045A\u61BDar;\u6956ight\u01D4\u0467\0\u0471eeVector;\u695Fector\u0100;B\u047A\u047B\u61C1ar;\u6957ee\u0100;A\u0486\u0487\u62A4rrow;\u61A7\u0100ct\u0492\u0497r;\uC000\u{1D49F}rok;\u4110\u0800NTacdfglmopqstux\u04BD\u04C0\u04C4\u04CB\u04DE\u04E2\u04E7\u04EE\u04F5\u0521\u052F\u0536\u0552\u055D\u0560\u0565G;\u414AH\u803B\xD0\u40D0cute\u803B\xC9\u40C9\u0180aiy\u04D2\u04D7\u04DCron;\u411Arc\u803B\xCA\u40CA;\u442Dot;\u4116r;\uC000\u{1D508}rave\u803B\xC8\u40C8ement;\u6208\u0100ap\u04FA\u04FEcr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65FBerySmallSquare;\u65AB\u0100gp\u0526\u052Aon;\u4118f;\uC000\u{1D53C}silon;\u4395u\u0100ai\u053C\u0549l\u0100;T\u0542\u0543\u6A75ilde;\u6242librium;\u61CC\u0100ci\u0557\u055Ar;\u6130m;\u6A73a;\u4397ml\u803B\xCB\u40CB\u0100ip\u056A\u056Fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058D\u05B2\u05CCy;\u4424r;\uC000\u{1D509}lled\u0253\u0597\0\0\u05A3mallSquare;\u65FCerySmallSquare;\u65AA\u0370\u05BA\0\u05BF\0\0\u05C4f;\uC000\u{1D53D}All;\u6200riertrf;\u6131c\xF2\u05CB\u0600JTabcdfgorst\u05E8\u05EC\u05EF\u05FA\u0600\u0612\u0616\u061B\u061D\u0623\u066C\u0672cy;\u4403\u803B>\u403Emma\u0100;d\u05F7\u05F8\u4393;\u43DCreve;\u411E\u0180eiy\u0607\u060C\u0610dil;\u4122rc;\u411C;\u4413ot;\u4120r;\uC000\u{1D50A};\u62D9pf;\uC000\u{1D53E}eater\u0300EFGLST\u0635\u0644\u064E\u0656\u065B\u0666qual\u0100;L\u063E\u063F\u6265ess;\u62DBullEqual;\u6267reater;\u6AA2ess;\u6277lantEqual;\u6A7Eilde;\u6273cr;\uC000\u{1D4A2};\u626B\u0400Aacfiosu\u0685\u068B\u0696\u069B\u069E\u06AA\u06BE\u06CARDcy;\u442A\u0100ct\u0690\u0694ek;\u42C7;\u405Eirc;\u4124r;\u610ClbertSpace;\u610B\u01F0\u06AF\0\u06B2f;\u610DizontalLine;\u6500\u0100ct\u06C3\u06C5\xF2\u06A9rok;\u4126mp\u0144\u06D0\u06D8ownHum\xF0\u012Fqual;\u624F\u0700EJOacdfgmnostu\u06FA\u06FE\u0703\u0707\u070E\u071A\u071E\u0721\u0728\u0744\u0778\u078B\u078F\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803B\xCD\u40CD\u0100iy\u0713\u0718rc\u803B\xCE\u40CE;\u4418ot;\u4130r;\u6111rave\u803B\xCC\u40CC\u0180;ap\u0720\u072F\u073F\u0100cg\u0734\u0737r;\u412AinaryI;\u6148lie\xF3\u03DD\u01F4\u0749\0\u0762\u0100;e\u074D\u074E\u622C\u0100gr\u0753\u0758ral;\u622Bsection;\u62C2isible\u0100CT\u076C\u0772omma;\u6063imes;\u6062\u0180gpt\u077F\u0783\u0788on;\u412Ef;\uC000\u{1D540}a;\u4399cr;\u6110ilde;\u4128\u01EB\u079A\0\u079Ecy;\u4406l\u803B\xCF\u40CF\u0280cfosu\u07AC\u07B7\u07BC\u07C2\u07D0\u0100iy\u07B1\u07B5rc;\u4134;\u4419r;\uC000\u{1D50D}pf;\uC000\u{1D541}\u01E3\u07C7\0\u07CCr;\uC000\u{1D4A5}rcy;\u4408kcy;\u4404\u0380HJacfos\u07E4\u07E8\u07EC\u07F1\u07FD\u0802\u0808cy;\u4425cy;\u440Cppa;\u439A\u0100ey\u07F6\u07FBdil;\u4136;\u441Ar;\uC000\u{1D50E}pf;\uC000\u{1D542}cr;\uC000\u{1D4A6}\u0580JTaceflmost\u0825\u0829\u082C\u0850\u0863\u09B3\u09B8\u09C7\u09CD\u0A37\u0A47cy;\u4409\u803B<\u403C\u0280cmnpr\u0837\u083C\u0841\u0844\u084Dute;\u4139bda;\u439Bg;\u67EAlacetrf;\u6112r;\u619E\u0180aey\u0857\u085C\u0861ron;\u413Ddil;\u413B;\u441B\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087E\u08A9\u08B1\u08E0\u08E6\u08FC\u092F\u095B\u0390\u096A\u0100nr\u0883\u088FgleBracket;\u67E8row\u0180;BR\u0899\u089A\u089E\u6190ar;\u61E4ightArrow;\u61C6eiling;\u6308o\u01F5\u08B7\0\u08C3bleBracket;\u67E6n\u01D4\u08C8\0\u08D2eeVector;\u6961ector\u0100;B\u08DB\u08DC\u61C3ar;\u6959loor;\u630Aight\u0100AV\u08EF\u08F5rrow;\u6194ector;\u694E\u0100er\u0901\u0917e\u0180;AV\u0909\u090A\u0910\u62A3rrow;\u61A4ector;\u695Aiangle\u0180;BE\u0924\u0925\u0929\u62B2ar;\u69CFqual;\u62B4p\u0180DTV\u0937\u0942\u094CownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61BFar;\u6958ector\u0100;B\u0965\u0966\u61BCar;\u6952ight\xE1\u039Cs\u0300EFGLST\u097E\u098B\u0995\u099D\u09A2\u09ADqualGreater;\u62DAullEqual;\u6266reater;\u6276ess;\u6AA1lantEqual;\u6A7Dilde;\u6272r;\uC000\u{1D50F}\u0100;e\u09BD\u09BE\u62D8ftarrow;\u61DAidot;\u413F\u0180npw\u09D4\u0A16\u0A1Bg\u0200LRlr\u09DE\u09F7\u0A02\u0A10eft\u0100AR\u09E6\u09ECrrow;\u67F5ightArrow;\u67F7ightArrow;\u67F6eft\u0100ar\u03B3\u0A0Aight\xE1\u03BFight\xE1\u03CAf;\uC000\u{1D543}er\u0100LR\u0A22\u0A2CeftArrow;\u6199ightArrow;\u6198\u0180cht\u0A3E\u0A40\u0A42\xF2\u084C;\u61B0rok;\u4141;\u626A\u0400acefiosu\u0A5A\u0A5D\u0A60\u0A77\u0A7C\u0A85\u0A8B\u0A8Ep;\u6905y;\u441C\u0100dl\u0A65\u0A6FiumSpace;\u605Flintrf;\u6133r;\uC000\u{1D510}nusPlus;\u6213pf;\uC000\u{1D544}c\xF2\u0A76;\u439C\u0480Jacefostu\u0AA3\u0AA7\u0AAD\u0AC0\u0B14\u0B19\u0D91\u0D97\u0D9Ecy;\u440Acute;\u4143\u0180aey\u0AB4\u0AB9\u0ABEron;\u4147dil;\u4145;\u441D\u0180gsw\u0AC7\u0AF0\u0B0Eative\u0180MTV\u0AD3\u0ADF\u0AE8ediumSpace;\u600Bhi\u0100cn\u0AE6\u0AD8\xEB\u0AD9eryThi\xEE\u0AD9ted\u0100GL\u0AF8\u0B06reaterGreate\xF2\u0673essLes\xF3\u0A48Line;\u400Ar;\uC000\u{1D511}\u0200Bnpt\u0B22\u0B28\u0B37\u0B3Areak;\u6060BreakingSpace;\u40A0f;\u6115\u0680;CDEGHLNPRSTV\u0B55\u0B56\u0B6A\u0B7C\u0BA1\u0BEB\u0C04\u0C5E\u0C84\u0CA6\u0CD8\u0D61\u0D85\u6AEC\u0100ou\u0B5B\u0B64ngruent;\u6262pCap;\u626DoubleVerticalBar;\u6226\u0180lqx\u0B83\u0B8A\u0B9Bement;\u6209ual\u0100;T\u0B92\u0B93\u6260ilde;\uC000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0BB6\u0BB7\u0BBD\u0BC9\u0BD3\u0BD8\u0BE5\u626Fqual;\u6271ullEqual;\uC000\u2267\u0338reater;\uC000\u226B\u0338ess;\u6279lantEqual;\uC000\u2A7E\u0338ilde;\u6275ump\u0144\u0BF2\u0BFDownHump;\uC000\u224E\u0338qual;\uC000\u224F\u0338e\u0100fs\u0C0A\u0C27tTriangle\u0180;BE\u0C1A\u0C1B\u0C21\u62EAar;\uC000\u29CF\u0338qual;\u62ECs\u0300;EGLST\u0C35\u0C36\u0C3C\u0C44\u0C4B\u0C58\u626Equal;\u6270reater;\u6278ess;\uC000\u226A\u0338lantEqual;\uC000\u2A7D\u0338ilde;\u6274ested\u0100GL\u0C68\u0C79reaterGreater;\uC000\u2AA2\u0338essLess;\uC000\u2AA1\u0338recedes\u0180;ES\u0C92\u0C93\u0C9B\u6280qual;\uC000\u2AAF\u0338lantEqual;\u62E0\u0100ei\u0CAB\u0CB9verseElement;\u620CghtTriangle\u0180;BE\u0CCB\u0CCC\u0CD2\u62EBar;\uC000\u29D0\u0338qual;\u62ED\u0100qu\u0CDD\u0D0CuareSu\u0100bp\u0CE8\u0CF9set\u0100;E\u0CF0\u0CF3\uC000\u228F\u0338qual;\u62E2erset\u0100;E\u0D03\u0D06\uC000\u2290\u0338qual;\u62E3\u0180bcp\u0D13\u0D24\u0D4Eset\u0100;E\u0D1B\u0D1E\uC000\u2282\u20D2qual;\u6288ceeds\u0200;EST\u0D32\u0D33\u0D3B\u0D46\u6281qual;\uC000\u2AB0\u0338lantEqual;\u62E1ilde;\uC000\u227F\u0338erset\u0100;E\u0D58\u0D5B\uC000\u2283\u20D2qual;\u6289ilde\u0200;EFT\u0D6E\u0D6F\u0D75\u0D7F\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uC000\u{1D4A9}ilde\u803B\xD1\u40D1;\u439D\u0700Eacdfgmoprstuv\u0DBD\u0DC2\u0DC9\u0DD5\u0DDB\u0DE0\u0DE7\u0DFC\u0E02\u0E20\u0E22\u0E32\u0E3F\u0E44lig;\u4152cute\u803B\xD3\u40D3\u0100iy\u0DCE\u0DD3rc\u803B\xD4\u40D4;\u441Eblac;\u4150r;\uC000\u{1D512}rave\u803B\xD2\u40D2\u0180aei\u0DEE\u0DF2\u0DF6cr;\u414Cga;\u43A9cron;\u439Fpf;\uC000\u{1D546}enCurly\u0100DQ\u0E0E\u0E1AoubleQuote;\u601Cuote;\u6018;\u6A54\u0100cl\u0E27\u0E2Cr;\uC000\u{1D4AA}ash\u803B\xD8\u40D8i\u016C\u0E37\u0E3Cde\u803B\xD5\u40D5es;\u6A37ml\u803B\xD6\u40D6er\u0100BP\u0E4B\u0E60\u0100ar\u0E50\u0E53r;\u603Eac\u0100ek\u0E5A\u0E5C;\u63DEet;\u63B4arenthesis;\u63DC\u0480acfhilors\u0E7F\u0E87\u0E8A\u0E8F\u0E92\u0E94\u0E9D\u0EB0\u0EFCrtialD;\u6202y;\u441Fr;\uC000\u{1D513}i;\u43A6;\u43A0usMinus;\u40B1\u0100ip\u0EA2\u0EADncareplan\xE5\u069Df;\u6119\u0200;eio\u0EB9\u0EBA\u0EE0\u0EE4\u6ABBcedes\u0200;EST\u0EC8\u0EC9\u0ECF\u0EDA\u627Aqual;\u6AAFlantEqual;\u627Cilde;\u627Eme;\u6033\u0100dp\u0EE9\u0EEEuct;\u620Fortion\u0100;a\u0225\u0EF9l;\u621D\u0100ci\u0F01\u0F06r;\uC000\u{1D4AB};\u43A8\u0200Ufos\u0F11\u0F16\u0F1B\u0F1FOT\u803B"\u4022r;\uC000\u{1D514}pf;\u611Acr;\uC000\u{1D4AC}\u0600BEacefhiorsu\u0F3E\u0F43\u0F47\u0F60\u0F73\u0FA7\u0FAA\u0FAD\u1096\u10A9\u10B4\u10BEarr;\u6910G\u803B\xAE\u40AE\u0180cnr\u0F4E\u0F53\u0F56ute;\u4154g;\u67EBr\u0100;t\u0F5C\u0F5D\u61A0l;\u6916\u0180aey\u0F67\u0F6C\u0F71ron;\u4158dil;\u4156;\u4420\u0100;v\u0F78\u0F79\u611Cerse\u0100EU\u0F82\u0F99\u0100lq\u0F87\u0F8Eement;\u620Builibrium;\u61CBpEquilibrium;\u696Fr\xBB\u0F79o;\u43A1ght\u0400ACDFTUVa\u0FC1\u0FEB\u0FF3\u1022\u1028\u105B\u1087\u03D8\u0100nr\u0FC6\u0FD2gleBracket;\u67E9row\u0180;BL\u0FDC\u0FDD\u0FE1\u6192ar;\u61E5eftArrow;\u61C4eiling;\u6309o\u01F5\u0FF9\0\u1005bleBracket;\u67E7n\u01D4\u100A\0\u1014eeVector;\u695Dector\u0100;B\u101D\u101E\u61C2ar;\u6955loor;\u630B\u0100er\u102D\u1043e\u0180;AV\u1035\u1036\u103C\u62A2rrow;\u61A6ector;\u695Biangle\u0180;BE\u1050\u1051\u1055\u62B3ar;\u69D0qual;\u62B5p\u0180DTV\u1063\u106E\u1078ownVector;\u694FeeVector;\u695Cector\u0100;B\u1082\u1083\u61BEar;\u6954ector\u0100;B\u1091\u1092\u61C0ar;\u6953\u0100pu\u109B\u109Ef;\u611DndImplies;\u6970ightarrow;\u61DB\u0100ch\u10B9\u10BCr;\u611B;\u61B1leDelayed;\u69F4\u0680HOacfhimoqstu\u10E4\u10F1\u10F7\u10FD\u1119\u111E\u1151\u1156\u1161\u1167\u11B5\u11BB\u11BF\u0100Cc\u10E9\u10EEHcy;\u4429y;\u4428FTcy;\u442Ccute;\u415A\u0280;aeiy\u1108\u1109\u110E\u1113\u1117\u6ABCron;\u4160dil;\u415Erc;\u415C;\u4421r;\uC000\u{1D516}ort\u0200DLRU\u112A\u1134\u113E\u1149ownArrow\xBB\u041EeftArrow\xBB\u089AightArrow\xBB\u0FDDpArrow;\u6191gma;\u43A3allCircle;\u6218pf;\uC000\u{1D54A}\u0272\u116D\0\0\u1170t;\u621Aare\u0200;ISU\u117B\u117C\u1189\u11AF\u65A1ntersection;\u6293u\u0100bp\u118F\u119Eset\u0100;E\u1197\u1198\u628Fqual;\u6291erset\u0100;E\u11A8\u11A9\u6290qual;\u6292nion;\u6294cr;\uC000\u{1D4AE}ar;\u62C6\u0200bcmp\u11C8\u11DB\u1209\u120B\u0100;s\u11CD\u11CE\u62D0et\u0100;E\u11CD\u11D5qual;\u6286\u0100ch\u11E0\u1205eeds\u0200;EST\u11ED\u11EE\u11F4\u11FF\u627Bqual;\u6AB0lantEqual;\u627Dilde;\u627FTh\xE1\u0F8C;\u6211\u0180;es\u1212\u1213\u1223\u62D1rset\u0100;E\u121C\u121D\u6283qual;\u6287et\xBB\u1213\u0580HRSacfhiors\u123E\u1244\u1249\u1255\u125E\u1271\u1276\u129F\u12C2\u12C8\u12D1ORN\u803B\xDE\u40DEADE;\u6122\u0100Hc\u124E\u1252cy;\u440By;\u4426\u0100bu\u125A\u125C;\u4009;\u43A4\u0180aey\u1265\u126A\u126Fron;\u4164dil;\u4162;\u4422r;\uC000\u{1D517}\u0100ei\u127B\u1289\u01F2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128E\u1298kSpace;\uC000\u205F\u200ASpace;\u6009lde\u0200;EFT\u12AB\u12AC\u12B2\u12BC\u623Cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uC000\u{1D54B}ipleDot;\u60DB\u0100ct\u12D6\u12DBr;\uC000\u{1D4AF}rok;\u4166\u0AE1\u12F7\u130E\u131A\u1326\0\u132C\u1331\0\0\0\0\0\u1338\u133D\u1377\u1385\0\u13FF\u1404\u140A\u1410\u0100cr\u12FB\u1301ute\u803B\xDA\u40DAr\u0100;o\u1307\u1308\u619Fcir;\u6949r\u01E3\u1313\0\u1316y;\u440Eve;\u416C\u0100iy\u131E\u1323rc\u803B\xDB\u40DB;\u4423blac;\u4170r;\uC000\u{1D518}rave\u803B\xD9\u40D9acr;\u416A\u0100di\u1341\u1369er\u0100BP\u1348\u135D\u0100ar\u134D\u1350r;\u405Fac\u0100ek\u1357\u1359;\u63DFet;\u63B5arenthesis;\u63DDon\u0100;P\u1370\u1371\u62C3lus;\u628E\u0100gp\u137B\u137Fon;\u4172f;\uC000\u{1D54C}\u0400ADETadps\u1395\u13AE\u13B8\u13C4\u03E8\u13D2\u13D7\u13F3rrow\u0180;BD\u1150\u13A0\u13A4ar;\u6912ownArrow;\u61C5ownArrow;\u6195quilibrium;\u696Eee\u0100;A\u13CB\u13CC\u62A5rrow;\u61A5own\xE1\u03F3er\u0100LR\u13DE\u13E8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13F9\u13FA\u43D2on;\u43A5ing;\u416Ecr;\uC000\u{1D4B0}ilde;\u4168ml\u803B\xDC\u40DC\u0480Dbcdefosv\u1427\u142C\u1430\u1433\u143E\u1485\u148A\u1490\u1496ash;\u62ABar;\u6AEBy;\u4412ash\u0100;l\u143B\u143C\u62A9;\u6AE6\u0100er\u1443\u1445;\u62C1\u0180bty\u144C\u1450\u147Aar;\u6016\u0100;i\u144F\u1455cal\u0200BLST\u1461\u1465\u146A\u1474ar;\u6223ine;\u407Ceparator;\u6758ilde;\u6240ThinSpace;\u600Ar;\uC000\u{1D519}pf;\uC000\u{1D54D}cr;\uC000\u{1D4B1}dash;\u62AA\u0280cefos\u14A7\u14AC\u14B1\u14B6\u14BCirc;\u4174dge;\u62C0r;\uC000\u{1D51A}pf;\uC000\u{1D54E}cr;\uC000\u{1D4B2}\u0200fios\u14CB\u14D0\u14D2\u14D8r;\uC000\u{1D51B};\u439Epf;\uC000\u{1D54F}cr;\uC000\u{1D4B3}\u0480AIUacfosu\u14F1\u14F5\u14F9\u14FD\u1504\u150F\u1514\u151A\u1520cy;\u442Fcy;\u4407cy;\u442Ecute\u803B\xDD\u40DD\u0100iy\u1509\u150Drc;\u4176;\u442Br;\uC000\u{1D51C}pf;\uC000\u{1D550}cr;\uC000\u{1D4B4}ml;\u4178\u0400Hacdefos\u1535\u1539\u153F\u154B\u154F\u155D\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417D;\u4417ot;\u417B\u01F2\u1554\0\u155BoWidt\xE8\u0AD9a;\u4396r;\u6128pf;\u6124cr;\uC000\u{1D4B5}\u0BE1\u1583\u158A\u1590\0\u15B0\u15B6\u15BF\0\0\0\0\u15C6\u15DB\u15EB\u165F\u166D\0\u1695\u169B\u16B2\u16B9\0\u16BEcute\u803B\xE1\u40E1reve;\u4103\u0300;Ediuy\u159C\u159D\u15A1\u15A3\u15A8\u15AD\u623E;\uC000\u223E\u0333;\u623Frc\u803B\xE2\u40E2te\u80BB\xB4\u0306;\u4430lig\u803B\xE6\u40E6\u0100;r\xB2\u15BA;\uC000\u{1D51E}rave\u803B\xE0\u40E0\u0100ep\u15CA\u15D6\u0100fp\u15CF\u15D4sym;\u6135\xE8\u15D3ha;\u43B1\u0100ap\u15DFc\u0100cl\u15E4\u15E7r;\u4101g;\u6A3F\u0264\u15F0\0\0\u160A\u0280;adsv\u15FA\u15FB\u15FF\u1601\u1607\u6227nd;\u6A55;\u6A5Clope;\u6A58;\u6A5A\u0380;elmrsz\u1618\u1619\u161B\u161E\u163F\u164F\u1659\u6220;\u69A4e\xBB\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163A\u163C\u163E;\u69A8;\u69A9;\u69AA;\u69AB;\u69AC;\u69AD;\u69AE;\u69AFt\u0100;v\u1645\u1646\u621Fb\u0100;d\u164C\u164D\u62BE;\u699D\u0100pt\u1654\u1657h;\u6222\xBB\xB9arr;\u637C\u0100gp\u1663\u1667on;\u4105f;\uC000\u{1D552}\u0380;Eaeiop\u12C1\u167B\u167D\u1682\u1684\u1687\u168A;\u6A70cir;\u6A6F;\u624Ad;\u624Bs;\u4027rox\u0100;e\u12C1\u1692\xF1\u1683ing\u803B\xE5\u40E5\u0180cty\u16A1\u16A6\u16A8r;\uC000\u{1D4B6};\u402Amp\u0100;e\u12C1\u16AF\xF1\u0288ilde\u803B\xE3\u40E3ml\u803B\xE4\u40E4\u0100ci\u16C2\u16C8onin\xF4\u0272nt;\u6A11\u0800Nabcdefiklnoprsu\u16ED\u16F1\u1730\u173C\u1743\u1748\u1778\u177D\u17E0\u17E6\u1839\u1850\u170D\u193D\u1948\u1970ot;\u6AED\u0100cr\u16F6\u171Ek\u0200ceps\u1700\u1705\u170D\u1713ong;\u624Cpsilon;\u43F6rime;\u6035im\u0100;e\u171A\u171B\u623Dq;\u62CD\u0176\u1722\u1726ee;\u62BDed\u0100;g\u172C\u172D\u6305e\xBB\u172Drk\u0100;t\u135C\u1737brk;\u63B6\u0100oy\u1701\u1741;\u4431quo;\u601E\u0280cmprt\u1753\u175B\u1761\u1764\u1768aus\u0100;e\u010A\u0109ptyv;\u69B0s\xE9\u170Cno\xF5\u0113\u0180ahw\u176F\u1771\u1773;\u43B2;\u6136een;\u626Cr;\uC000\u{1D51F}g\u0380costuvw\u178D\u179D\u17B3\u17C1\u17D5\u17DB\u17DE\u0180aiu\u1794\u1796\u179A\xF0\u0760rc;\u65EFp\xBB\u1371\u0180dpt\u17A4\u17A8\u17ADot;\u6A00lus;\u6A01imes;\u6A02\u0271\u17B9\0\0\u17BEcup;\u6A06ar;\u6605riangle\u0100du\u17CD\u17D2own;\u65BDp;\u65B3plus;\u6A04e\xE5\u1444\xE5\u14ADarow;\u690D\u0180ako\u17ED\u1826\u1835\u0100cn\u17F2\u1823k\u0180lst\u17FA\u05AB\u1802ozenge;\u69EBriangle\u0200;dlr\u1812\u1813\u1818\u181D\u65B4own;\u65BEeft;\u65C2ight;\u65B8k;\u6423\u01B1\u182B\0\u1833\u01B2\u182F\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183E\u184D\u0100;q\u1843\u1846\uC000=\u20E5uiv;\uC000\u2261\u20E5t;\u6310\u0200ptwx\u1859\u185E\u1867\u186Cf;\uC000\u{1D553}\u0100;t\u13CB\u1863om\xBB\u13CCtie;\u62C8\u0600DHUVbdhmptuv\u1885\u1896\u18AA\u18BB\u18D7\u18DB\u18EC\u18FF\u1905\u190A\u1910\u1921\u0200LRlr\u188E\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18A1\u18A2\u18A4\u18A6\u18A8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18B3\u18B5\u18B7\u18B9;\u655D;\u655A;\u655C;\u6559\u0380;HLRhlr\u18CA\u18CB\u18CD\u18CF\u18D1\u18D3\u18D5\u6551;\u656C;\u6563;\u6560;\u656B;\u6562;\u655Fox;\u69C9\u0200LRlr\u18E4\u18E6\u18E8\u18EA;\u6555;\u6552;\u6510;\u650C\u0280;DUdu\u06BD\u18F7\u18F9\u18FB\u18FD;\u6565;\u6568;\u652C;\u6534inus;\u629Flus;\u629Eimes;\u62A0\u0200LRlr\u1919\u191B\u191D\u191F;\u655B;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193B\u6502;\u656A;\u6561;\u655E;\u653C;\u6524;\u651C\u0100ev\u0123\u1942bar\u803B\xA6\u40A6\u0200ceio\u1951\u1956\u195A\u1960r;\uC000\u{1D4B7}mi;\u604Fm\u0100;e\u171A\u171Cl\u0180;bh\u1968\u1969\u196B\u405C;\u69C5sub;\u67C8\u016C\u1974\u197El\u0100;e\u1979\u197A\u6022t\xBB\u197Ap\u0180;Ee\u012F\u1985\u1987;\u6AAE\u0100;q\u06DC\u06DB\u0CE1\u19A7\0\u19E8\u1A11\u1A15\u1A32\0\u1A37\u1A50\0\0\u1AB4\0\0\u1AC1\0\0\u1B21\u1B2E\u1B4D\u1B52\0\u1BFD\0\u1C0C\u0180cpr\u19AD\u19B2\u19DDute;\u4107\u0300;abcds\u19BF\u19C0\u19C4\u19CA\u19D5\u19D9\u6229nd;\u6A44rcup;\u6A49\u0100au\u19CF\u19D2p;\u6A4Bp;\u6A47ot;\u6A40;\uC000\u2229\uFE00\u0100eo\u19E2\u19E5t;\u6041\xEE\u0693\u0200aeiu\u19F0\u19FB\u1A01\u1A05\u01F0\u19F5\0\u19F8s;\u6A4Don;\u410Ddil\u803B\xE7\u40E7rc;\u4109ps\u0100;s\u1A0C\u1A0D\u6A4Cm;\u6A50ot;\u410B\u0180dmn\u1A1B\u1A20\u1A26il\u80BB\xB8\u01ADptyv;\u69B2t\u8100\xA2;e\u1A2D\u1A2E\u40A2r\xE4\u01B2r;\uC000\u{1D520}\u0180cei\u1A3D\u1A40\u1A4Dy;\u4447ck\u0100;m\u1A47\u1A48\u6713ark\xBB\u1A48;\u43C7r\u0380;Ecefms\u1A5F\u1A60\u1A62\u1A6B\u1AA4\u1AAA\u1AAE\u65CB;\u69C3\u0180;el\u1A69\u1A6A\u1A6D\u42C6q;\u6257e\u0261\u1A74\0\0\u1A88rrow\u0100lr\u1A7C\u1A81eft;\u61BAight;\u61BB\u0280RSacd\u1A92\u1A94\u1A96\u1A9A\u1A9F\xBB\u0F47;\u64C8st;\u629Birc;\u629Aash;\u629Dnint;\u6A10id;\u6AEFcir;\u69C2ubs\u0100;u\u1ABB\u1ABC\u6663it\xBB\u1ABC\u02EC\u1AC7\u1AD4\u1AFA\0\u1B0Aon\u0100;e\u1ACD\u1ACE\u403A\u0100;q\xC7\xC6\u026D\u1AD9\0\0\u1AE2a\u0100;t\u1ADE\u1ADF\u402C;\u4040\u0180;fl\u1AE8\u1AE9\u1AEB\u6201\xEE\u1160e\u0100mx\u1AF1\u1AF6ent\xBB\u1AE9e\xF3\u024D\u01E7\u1AFE\0\u1B07\u0100;d\u12BB\u1B02ot;\u6A6Dn\xF4\u0246\u0180fry\u1B10\u1B14\u1B17;\uC000\u{1D554}o\xE4\u0254\u8100\xA9;s\u0155\u1B1Dr;\u6117\u0100ao\u1B25\u1B29rr;\u61B5ss;\u6717\u0100cu\u1B32\u1B37r;\uC000\u{1D4B8}\u0100bp\u1B3C\u1B44\u0100;e\u1B41\u1B42\u6ACF;\u6AD1\u0100;e\u1B49\u1B4A\u6AD0;\u6AD2dot;\u62EF\u0380delprvw\u1B60\u1B6C\u1B77\u1B82\u1BAC\u1BD4\u1BF9arr\u0100lr\u1B68\u1B6A;\u6938;\u6935\u0270\u1B72\0\0\u1B75r;\u62DEc;\u62DFarr\u0100;p\u1B7F\u1B80\u61B6;\u693D\u0300;bcdos\u1B8F\u1B90\u1B96\u1BA1\u1BA5\u1BA8\u622Arcap;\u6A48\u0100au\u1B9B\u1B9Ep;\u6A46p;\u6A4Aot;\u628Dr;\u6A45;\uC000\u222A\uFE00\u0200alrv\u1BB5\u1BBF\u1BDE\u1BE3rr\u0100;m\u1BBC\u1BBD\u61B7;\u693Cy\u0180evw\u1BC7\u1BD4\u1BD8q\u0270\u1BCE\0\0\u1BD2re\xE3\u1B73u\xE3\u1B75ee;\u62CEedge;\u62CFen\u803B\xA4\u40A4earrow\u0100lr\u1BEE\u1BF3eft\xBB\u1B80ight\xBB\u1BBDe\xE4\u1BDD\u0100ci\u1C01\u1C07onin\xF4\u01F7nt;\u6231lcty;\u632D\u0980AHabcdefhijlorstuwz\u1C38\u1C3B\u1C3F\u1C5D\u1C69\u1C75\u1C8A\u1C9E\u1CAC\u1CB7\u1CFB\u1CFF\u1D0D\u1D7B\u1D91\u1DAB\u1DBB\u1DC6\u1DCDr\xF2\u0381ar;\u6965\u0200glrs\u1C48\u1C4D\u1C52\u1C54ger;\u6020eth;\u6138\xF2\u1133h\u0100;v\u1C5A\u1C5B\u6010\xBB\u090A\u016B\u1C61\u1C67arow;\u690Fa\xE3\u0315\u0100ay\u1C6E\u1C73ron;\u410F;\u4434\u0180;ao\u0332\u1C7C\u1C84\u0100gr\u02BF\u1C81r;\u61CAtseq;\u6A77\u0180glm\u1C91\u1C94\u1C98\u803B\xB0\u40B0ta;\u43B4ptyv;\u69B1\u0100ir\u1CA3\u1CA8sht;\u697F;\uC000\u{1D521}ar\u0100lr\u1CB3\u1CB5\xBB\u08DC\xBB\u101E\u0280aegsv\u1CC2\u0378\u1CD6\u1CDC\u1CE0m\u0180;os\u0326\u1CCA\u1CD4nd\u0100;s\u0326\u1CD1uit;\u6666amma;\u43DDin;\u62F2\u0180;io\u1CE7\u1CE8\u1CF8\u40F7de\u8100\xF7;o\u1CE7\u1CF0ntimes;\u62C7n\xF8\u1CF7cy;\u4452c\u026F\u1D06\0\0\u1D0Arn;\u631Eop;\u630D\u0280lptuw\u1D18\u1D1D\u1D22\u1D49\u1D55lar;\u4024f;\uC000\u{1D555}\u0280;emps\u030B\u1D2D\u1D37\u1D3D\u1D42q\u0100;d\u0352\u1D33ot;\u6251inus;\u6238lus;\u6214quare;\u62A1blebarwedg\xE5\xFAn\u0180adh\u112E\u1D5D\u1D67ownarrow\xF3\u1C83arpoon\u0100lr\u1D72\u1D76ef\xF4\u1CB4igh\xF4\u1CB6\u0162\u1D7F\u1D85karo\xF7\u0F42\u026F\u1D8A\0\0\u1D8Ern;\u631Fop;\u630C\u0180cot\u1D98\u1DA3\u1DA6\u0100ry\u1D9D\u1DA1;\uC000\u{1D4B9};\u4455l;\u69F6rok;\u4111\u0100dr\u1DB0\u1DB4ot;\u62F1i\u0100;f\u1DBA\u1816\u65BF\u0100ah\u1DC0\u1DC3r\xF2\u0429a\xF2\u0FA6angle;\u69A6\u0100ci\u1DD2\u1DD5y;\u445Fgrarr;\u67FF\u0900Dacdefglmnopqrstux\u1E01\u1E09\u1E19\u1E38\u0578\u1E3C\u1E49\u1E61\u1E7E\u1EA5\u1EAF\u1EBD\u1EE1\u1F2A\u1F37\u1F44\u1F4E\u1F5A\u0100Do\u1E06\u1D34o\xF4\u1C89\u0100cs\u1E0E\u1E14ute\u803B\xE9\u40E9ter;\u6A6E\u0200aioy\u1E22\u1E27\u1E31\u1E36ron;\u411Br\u0100;c\u1E2D\u1E2E\u6256\u803B\xEA\u40EAlon;\u6255;\u444Dot;\u4117\u0100Dr\u1E41\u1E45ot;\u6252;\uC000\u{1D522}\u0180;rs\u1E50\u1E51\u1E57\u6A9Aave\u803B\xE8\u40E8\u0100;d\u1E5C\u1E5D\u6A96ot;\u6A98\u0200;ils\u1E6A\u1E6B\u1E72\u1E74\u6A99nters;\u63E7;\u6113\u0100;d\u1E79\u1E7A\u6A95ot;\u6A97\u0180aps\u1E85\u1E89\u1E97cr;\u4113ty\u0180;sv\u1E92\u1E93\u1E95\u6205et\xBB\u1E93p\u01001;\u1E9D\u1EA4\u0133\u1EA1\u1EA3;\u6004;\u6005\u6003\u0100gs\u1EAA\u1EAC;\u414Bp;\u6002\u0100gp\u1EB4\u1EB8on;\u4119f;\uC000\u{1D556}\u0180als\u1EC4\u1ECE\u1ED2r\u0100;s\u1ECA\u1ECB\u62D5l;\u69E3us;\u6A71i\u0180;lv\u1EDA\u1EDB\u1EDF\u43B5on\xBB\u1EDB;\u43F5\u0200csuv\u1EEA\u1EF3\u1F0B\u1F23\u0100io\u1EEF\u1E31rc\xBB\u1E2E\u0269\u1EF9\0\0\u1EFB\xED\u0548ant\u0100gl\u1F02\u1F06tr\xBB\u1E5Dess\xBB\u1E7A\u0180aei\u1F12\u1F16\u1F1Als;\u403Dst;\u625Fv\u0100;D\u0235\u1F20D;\u6A78parsl;\u69E5\u0100Da\u1F2F\u1F33ot;\u6253rr;\u6971\u0180cdi\u1F3E\u1F41\u1EF8r;\u612Fo\xF4\u0352\u0100ah\u1F49\u1F4B;\u43B7\u803B\xF0\u40F0\u0100mr\u1F53\u1F57l\u803B\xEB\u40EBo;\u60AC\u0180cip\u1F61\u1F64\u1F67l;\u4021s\xF4\u056E\u0100eo\u1F6C\u1F74ctatio\xEE\u0559nential\xE5\u0579\u09E1\u1F92\0\u1F9E\0\u1FA1\u1FA7\0\0\u1FC6\u1FCC\0\u1FD3\0\u1FE6\u1FEA\u2000\0\u2008\u205Allingdotse\xF1\u1E44y;\u4444male;\u6640\u0180ilr\u1FAD\u1FB3\u1FC1lig;\u8000\uFB03\u0269\u1FB9\0\0\u1FBDg;\u8000\uFB00ig;\u8000\uFB04;\uC000\u{1D523}lig;\u8000\uFB01lig;\uC000fj\u0180alt\u1FD9\u1FDC\u1FE1t;\u666Dig;\u8000\uFB02ns;\u65B1of;\u4192\u01F0\u1FEE\0\u1FF3f;\uC000\u{1D557}\u0100ak\u05BF\u1FF7\u0100;v\u1FFC\u1FFD\u62D4;\u6AD9artint;\u6A0D\u0100ao\u200C\u2055\u0100cs\u2011\u2052\u03B1\u201A\u2030\u2038\u2045\u2048\0\u2050\u03B2\u2022\u2025\u2027\u202A\u202C\0\u202E\u803B\xBD\u40BD;\u6153\u803B\xBC\u40BC;\u6155;\u6159;\u615B\u01B3\u2034\0\u2036;\u6154;\u6156\u02B4\u203E\u2041\0\0\u2043\u803B\xBE\u40BE;\u6157;\u615C5;\u6158\u01B6\u204C\0\u204E;\u615A;\u615D8;\u615El;\u6044wn;\u6322cr;\uC000\u{1D4BB}\u0880Eabcdefgijlnorstv\u2082\u2089\u209F\u20A5\u20B0\u20B4\u20F0\u20F5\u20FA\u20FF\u2103\u2112\u2138\u0317\u213E\u2152\u219E\u0100;l\u064D\u2087;\u6A8C\u0180cmp\u2090\u2095\u209Dute;\u41F5ma\u0100;d\u209C\u1CDA\u43B3;\u6A86reve;\u411F\u0100iy\u20AA\u20AErc;\u411D;\u4433ot;\u4121\u0200;lqs\u063E\u0642\u20BD\u20C9\u0180;qs\u063E\u064C\u20C4lan\xF4\u0665\u0200;cdl\u0665\u20D2\u20D5\u20E5c;\u6AA9ot\u0100;o\u20DC\u20DD\u6A80\u0100;l\u20E2\u20E3\u6A82;\u6A84\u0100;e\u20EA\u20ED\uC000\u22DB\uFE00s;\u6A94r;\uC000\u{1D524}\u0100;g\u0673\u061Bmel;\u6137cy;\u4453\u0200;Eaj\u065A\u210C\u210E\u2110;\u6A92;\u6AA5;\u6AA4\u0200Eaes\u211B\u211D\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6A8Arox\xBB\u2124\u0100;q\u212E\u212F\u6A88\u0100;q\u212E\u211Bim;\u62E7pf;\uC000\u{1D558}\u0100ci\u2143\u2146r;\u610Am\u0180;el\u066B\u214E\u2150;\u6A8E;\u6A90\u8300>;cdlqr\u05EE\u2160\u216A\u216E\u2173\u2179\u0100ci\u2165\u2167;\u6AA7r;\u6A7Aot;\u62D7Par;\u6995uest;\u6A7C\u0280adels\u2184\u216A\u2190\u0656\u219B\u01F0\u2189\0\u218Epro\xF8\u209Er;\u6978q\u0100lq\u063F\u2196les\xF3\u2088i\xED\u066B\u0100en\u21A3\u21ADrtneqq;\uC000\u2269\uFE00\xC5\u21AA\u0500Aabcefkosy\u21C4\u21C7\u21F1\u21F5\u21FA\u2218\u221D\u222F\u2268\u227Dr\xF2\u03A0\u0200ilmr\u21D0\u21D4\u21D7\u21DBrs\xF0\u1484f\xBB\u2024il\xF4\u06A9\u0100dr\u21E0\u21E4cy;\u444A\u0180;cw\u08F4\u21EB\u21EFir;\u6948;\u61ADar;\u610Firc;\u4125\u0180alr\u2201\u220E\u2213rts\u0100;u\u2209\u220A\u6665it\xBB\u220Alip;\u6026con;\u62B9r;\uC000\u{1D525}s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223A\u223E\u2243\u225E\u2263rr;\u61FFtht;\u623Bk\u0100lr\u2249\u2253eftarrow;\u61A9ightarrow;\u61AAf;\uC000\u{1D559}bar;\u6015\u0180clt\u226F\u2274\u2278r;\uC000\u{1D4BD}as\xE8\u21F4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xBB\u1C5B\u0AE1\u22A3\0\u22AA\0\u22B8\u22C5\u22CE\0\u22D5\u22F3\0\0\u22F8\u2322\u2367\u2362\u237F\0\u2386\u23AA\u23B4cute\u803B\xED\u40ED\u0180;iy\u0771\u22B0\u22B5rc\u803B\xEE\u40EE;\u4438\u0100cx\u22BC\u22BFy;\u4435cl\u803B\xA1\u40A1\u0100fr\u039F\u22C9;\uC000\u{1D526}rave\u803B\xEC\u40EC\u0200;ino\u073E\u22DD\u22E9\u22EE\u0100in\u22E2\u22E6nt;\u6A0Ct;\u622Dfin;\u69DCta;\u6129lig;\u4133\u0180aop\u22FE\u231A\u231D\u0180cgt\u2305\u2308\u2317r;\u412B\u0180elp\u071F\u230F\u2313in\xE5\u078Ear\xF4\u0720h;\u4131f;\u62B7ed;\u41B5\u0280;cfot\u04F4\u232C\u2331\u233D\u2341are;\u6105in\u0100;t\u2338\u2339\u621Eie;\u69DDdo\xF4\u2319\u0280;celp\u0757\u234C\u2350\u235B\u2361al;\u62BA\u0100gr\u2355\u2359er\xF3\u1563\xE3\u234Darhk;\u6A17rod;\u6A3C\u0200cgpt\u236F\u2372\u2376\u237By;\u4451on;\u412Ff;\uC000\u{1D55A}a;\u43B9uest\u803B\xBF\u40BF\u0100ci\u238A\u238Fr;\uC000\u{1D4BE}n\u0280;Edsv\u04F4\u239B\u239D\u23A1\u04F3;\u62F9ot;\u62F5\u0100;v\u23A6\u23A7\u62F4;\u62F3\u0100;i\u0777\u23AElde;\u4129\u01EB\u23B8\0\u23BCcy;\u4456l\u803B\xEF\u40EF\u0300cfmosu\u23CC\u23D7\u23DC\u23E1\u23E7\u23F5\u0100iy\u23D1\u23D5rc;\u4135;\u4439r;\uC000\u{1D527}ath;\u4237pf;\uC000\u{1D55B}\u01E3\u23EC\0\u23F1r;\uC000\u{1D4BF}rcy;\u4458kcy;\u4454\u0400acfghjos\u240B\u2416\u2422\u2427\u242D\u2431\u2435\u243Bppa\u0100;v\u2413\u2414\u43BA;\u43F0\u0100ey\u241B\u2420dil;\u4137;\u443Ar;\uC000\u{1D528}reen;\u4138cy;\u4445cy;\u445Cpf;\uC000\u{1D55C}cr;\uC000\u{1D4C0}\u0B80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248D\u2491\u250E\u253D\u255A\u2580\u264E\u265E\u2665\u2679\u267D\u269A\u26B2\u26D8\u275D\u2768\u278B\u27C0\u2801\u2812\u0180art\u2477\u247A\u247Cr\xF2\u09C6\xF2\u0395ail;\u691Barr;\u690E\u0100;g\u0994\u248B;\u6A8Bar;\u6962\u0963\u24A5\0\u24AA\0\u24B1\0\0\0\0\0\u24B5\u24BA\0\u24C6\u24C8\u24CD\0\u24F9ute;\u413Amptyv;\u69B4ra\xEE\u084Cbda;\u43BBg\u0180;dl\u088E\u24C1\u24C3;\u6991\xE5\u088E;\u6A85uo\u803B\xAB\u40ABr\u0400;bfhlpst\u0899\u24DE\u24E6\u24E9\u24EB\u24EE\u24F1\u24F5\u0100;f\u089D\u24E3s;\u691Fs;\u691D\xEB\u2252p;\u61ABl;\u6939im;\u6973l;\u61A2\u0180;ae\u24FF\u2500\u2504\u6AABil;\u6919\u0100;s\u2509\u250A\u6AAD;\uC000\u2AAD\uFE00\u0180abr\u2515\u2519\u251Drr;\u690Crk;\u6772\u0100ak\u2522\u252Cc\u0100ek\u2528\u252A;\u407B;\u405B\u0100es\u2531\u2533;\u698Bl\u0100du\u2539\u253B;\u698F;\u698D\u0200aeuy\u2546\u254B\u2556\u2558ron;\u413E\u0100di\u2550\u2554il;\u413C\xEC\u08B0\xE2\u2529;\u443B\u0200cqrs\u2563\u2566\u256D\u257Da;\u6936uo\u0100;r\u0E19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694Bh;\u61B2\u0280;fgqs\u258B\u258C\u0989\u25F3\u25FF\u6264t\u0280ahlrt\u2598\u25A4\u25B7\u25C2\u25E8rrow\u0100;t\u0899\u25A1a\xE9\u24F6arpoon\u0100du\u25AF\u25B4own\xBB\u045Ap\xBB\u0966eftarrows;\u61C7ight\u0180ahs\u25CD\u25D6\u25DErrow\u0100;s\u08F4\u08A7arpoon\xF3\u0F98quigarro\xF7\u21F0hreetimes;\u62CB\u0180;qs\u258B\u0993\u25FAlan\xF4\u09AC\u0280;cdgs\u09AC\u260A\u260D\u261D\u2628c;\u6AA8ot\u0100;o\u2614\u2615\u6A7F\u0100;r\u261A\u261B\u6A81;\u6A83\u0100;e\u2622\u2625\uC000\u22DA\uFE00s;\u6A93\u0280adegs\u2633\u2639\u263D\u2649\u264Bppro\xF8\u24C6ot;\u62D6q\u0100gq\u2643\u2645\xF4\u0989gt\xF2\u248C\xF4\u099Bi\xED\u09B2\u0180ilr\u2655\u08E1\u265Asht;\u697C;\uC000\u{1D529}\u0100;E\u099C\u2663;\u6A91\u0161\u2669\u2676r\u0100du\u25B2\u266E\u0100;l\u0965\u2673;\u696Alk;\u6584cy;\u4459\u0280;acht\u0A48\u2688\u268B\u2691\u2696r\xF2\u25C1orne\xF2\u1D08ard;\u696Bri;\u65FA\u0100io\u269F\u26A4dot;\u4140ust\u0100;a\u26AC\u26AD\u63B0che\xBB\u26AD\u0200Eaes\u26BB\u26BD\u26C9\u26D4;\u6268p\u0100;p\u26C3\u26C4\u6A89rox\xBB\u26C4\u0100;q\u26CE\u26CF\u6A87\u0100;q\u26CE\u26BBim;\u62E6\u0400abnoptwz\u26E9\u26F4\u26F7\u271A\u272F\u2741\u2747\u2750\u0100nr\u26EE\u26F1g;\u67ECr;\u61FDr\xEB\u08C1g\u0180lmr\u26FF\u270D\u2714eft\u0100ar\u09E6\u2707ight\xE1\u09F2apsto;\u67FCight\xE1\u09FDparrow\u0100lr\u2725\u2729ef\xF4\u24EDight;\u61AC\u0180afl\u2736\u2739\u273Dr;\u6985;\uC000\u{1D55D}us;\u6A2Dimes;\u6A34\u0161\u274B\u274Fst;\u6217\xE1\u134E\u0180;ef\u2757\u2758\u1800\u65CAnge\xBB\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277C\u2785\u2787r\xF2\u08A8orne\xF2\u1D8Car\u0100;d\u0F98\u2783;\u696D;\u600Eri;\u62BF\u0300achiqt\u2798\u279D\u0A40\u27A2\u27AE\u27BBquo;\u6039r;\uC000\u{1D4C1}m\u0180;eg\u09B2\u27AA\u27AC;\u6A8D;\u6A8F\u0100bu\u252A\u27B3o\u0100;r\u0E1F\u27B9;\u601Arok;\u4142\u8400<;cdhilqr\u082B\u27D2\u2639\u27DC\u27E0\u27E5\u27EA\u27F0\u0100ci\u27D7\u27D9;\u6AA6r;\u6A79re\xE5\u25F2mes;\u62C9arr;\u6976uest;\u6A7B\u0100Pi\u27F5\u27F9ar;\u6996\u0180;ef\u2800\u092D\u181B\u65C3r\u0100du\u2807\u280Dshar;\u694Ahar;\u6966\u0100en\u2817\u2821rtneqq;\uC000\u2268\uFE00\xC5\u281E\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288E\u2893\u28A0\u28A5\u28A8\u28DA\u28E2\u28E4\u0A83\u28F3\u2902Dot;\u623A\u0200clpr\u284E\u2852\u2863\u287Dr\u803B\xAF\u40AF\u0100et\u2857\u2859;\u6642\u0100;e\u285E\u285F\u6720se\xBB\u285F\u0100;s\u103B\u2868to\u0200;dlu\u103B\u2873\u2877\u287Bow\xEE\u048Cef\xF4\u090F\xF0\u13D1ker;\u65AE\u0100oy\u2887\u288Cmma;\u6A29;\u443Cash;\u6014asuredangle\xBB\u1626r;\uC000\u{1D52A}o;\u6127\u0180cdn\u28AF\u28B4\u28C9ro\u803B\xB5\u40B5\u0200;acd\u1464\u28BD\u28C0\u28C4s\xF4\u16A7ir;\u6AF0ot\u80BB\xB7\u01B5us\u0180;bd\u28D2\u1903\u28D3\u6212\u0100;u\u1D3C\u28D8;\u6A2A\u0163\u28DE\u28E1p;\u6ADB\xF2\u2212\xF0\u0A81\u0100dp\u28E9\u28EEels;\u62A7f;\uC000\u{1D55E}\u0100ct\u28F8\u28FDr;\uC000\u{1D4C2}pos\xBB\u159D\u0180;lm\u2909\u290A\u290D\u43BCtimap;\u62B8\u0C00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297E\u2989\u2998\u29DA\u29E9\u2A15\u2A1A\u2A58\u2A5D\u2A83\u2A95\u2AA4\u2AA8\u2B04\u2B07\u2B44\u2B7F\u2BAE\u2C34\u2C67\u2C7C\u2CE9\u0100gt\u2947\u294B;\uC000\u22D9\u0338\u0100;v\u2950\u0BCF\uC000\u226B\u20D2\u0180elt\u295A\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61CDightarrow;\u61CE;\uC000\u22D8\u0338\u0100;v\u297B\u0C47\uC000\u226A\u20D2ightarrow;\u61CF\u0100Dd\u298E\u2993ash;\u62AFash;\u62AE\u0280bcnpt\u29A3\u29A7\u29AC\u29B1\u29CCla\xBB\u02DEute;\u4144g;\uC000\u2220\u20D2\u0280;Eiop\u0D84\u29BC\u29C0\u29C5\u29C8;\uC000\u2A70\u0338d;\uC000\u224B\u0338s;\u4149ro\xF8\u0D84ur\u0100;a\u29D3\u29D4\u666El\u0100;s\u29D3\u0B38\u01F3\u29DF\0\u29E3p\u80BB\xA0\u0B37mp\u0100;e\u0BF9\u0C00\u0280aeouy\u29F4\u29FE\u2A03\u2A10\u2A13\u01F0\u29F9\0\u29FB;\u6A43on;\u4148dil;\u4146ng\u0100;d\u0D7E\u2A0Aot;\uC000\u2A6D\u0338p;\u6A42;\u443Dash;\u6013\u0380;Aadqsx\u0B92\u2A29\u2A2D\u2A3B\u2A41\u2A45\u2A50rr;\u61D7r\u0100hr\u2A33\u2A36k;\u6924\u0100;o\u13F2\u13F0ot;\uC000\u2250\u0338ui\xF6\u0B63\u0100ei\u2A4A\u2A4Ear;\u6928\xED\u0B98ist\u0100;s\u0BA0\u0B9Fr;\uC000\u{1D52B}\u0200Eest\u0BC5\u2A66\u2A79\u2A7C\u0180;qs\u0BBC\u2A6D\u0BE1\u0180;qs\u0BBC\u0BC5\u2A74lan\xF4\u0BE2i\xED\u0BEA\u0100;r\u0BB6\u2A81\xBB\u0BB7\u0180Aap\u2A8A\u2A8D\u2A91r\xF2\u2971rr;\u61AEar;\u6AF2\u0180;sv\u0F8D\u2A9C\u0F8C\u0100;d\u2AA1\u2AA2\u62FC;\u62FAcy;\u445A\u0380AEadest\u2AB7\u2ABA\u2ABE\u2AC2\u2AC5\u2AF6\u2AF9r\xF2\u2966;\uC000\u2266\u0338rr;\u619Ar;\u6025\u0200;fqs\u0C3B\u2ACE\u2AE3\u2AEFt\u0100ar\u2AD4\u2AD9rro\xF7\u2AC1ightarro\xF7\u2A90\u0180;qs\u0C3B\u2ABA\u2AEAlan\xF4\u0C55\u0100;s\u0C55\u2AF4\xBB\u0C36i\xED\u0C5D\u0100;r\u0C35\u2AFEi\u0100;e\u0C1A\u0C25i\xE4\u0D90\u0100pt\u2B0C\u2B11f;\uC000\u{1D55F}\u8180\xAC;in\u2B19\u2B1A\u2B36\u40ACn\u0200;Edv\u0B89\u2B24\u2B28\u2B2E;\uC000\u22F9\u0338ot;\uC000\u22F5\u0338\u01E1\u0B89\u2B33\u2B35;\u62F7;\u62F6i\u0100;v\u0CB8\u2B3C\u01E1\u0CB8\u2B41\u2B43;\u62FE;\u62FD\u0180aor\u2B4B\u2B63\u2B69r\u0200;ast\u0B7B\u2B55\u2B5A\u2B5Flle\xEC\u0B7Bl;\uC000\u2AFD\u20E5;\uC000\u2202\u0338lint;\u6A14\u0180;ce\u0C92\u2B70\u2B73u\xE5\u0CA5\u0100;c\u0C98\u2B78\u0100;e\u0C92\u2B7D\xF1\u0C98\u0200Aait\u2B88\u2B8B\u2B9D\u2BA7r\xF2\u2988rr\u0180;cw\u2B94\u2B95\u2B99\u619B;\uC000\u2933\u0338;\uC000\u219D\u0338ghtarrow\xBB\u2B95ri\u0100;e\u0CCB\u0CD6\u0380chimpqu\u2BBD\u2BCD\u2BD9\u2B04\u0B78\u2BE4\u2BEF\u0200;cer\u0D32\u2BC6\u0D37\u2BC9u\xE5\u0D45;\uC000\u{1D4C3}ort\u026D\u2B05\0\0\u2BD6ar\xE1\u2B56m\u0100;e\u0D6E\u2BDF\u0100;q\u0D74\u0D73su\u0100bp\u2BEB\u2BED\xE5\u0CF8\xE5\u0D0B\u0180bcp\u2BF6\u2C11\u2C19\u0200;Ees\u2BFF\u2C00\u0D22\u2C04\u6284;\uC000\u2AC5\u0338et\u0100;e\u0D1B\u2C0Bq\u0100;q\u0D23\u2C00c\u0100;e\u0D32\u2C17\xF1\u0D38\u0200;Ees\u2C22\u2C23\u0D5F\u2C27\u6285;\uC000\u2AC6\u0338et\u0100;e\u0D58\u2C2Eq\u0100;q\u0D60\u2C23\u0200gilr\u2C3D\u2C3F\u2C45\u2C47\xEC\u0BD7lde\u803B\xF1\u40F1\xE7\u0C43iangle\u0100lr\u2C52\u2C5Ceft\u0100;e\u0C1A\u2C5A\xF1\u0C26ight\u0100;e\u0CCB\u2C65\xF1\u0CD7\u0100;m\u2C6C\u2C6D\u43BD\u0180;es\u2C74\u2C75\u2C79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2C8F\u2C94\u2C99\u2C9E\u2CA3\u2CB0\u2CB6\u2CD3\u2CE3ash;\u62ADarr;\u6904p;\uC000\u224D\u20D2ash;\u62AC\u0100et\u2CA8\u2CAC;\uC000\u2265\u20D2;\uC000>\u20D2nfin;\u69DE\u0180Aet\u2CBD\u2CC1\u2CC5rr;\u6902;\uC000\u2264\u20D2\u0100;r\u2CCA\u2CCD\uC000<\u20D2ie;\uC000\u22B4\u20D2\u0100At\u2CD8\u2CDCrr;\u6903rie;\uC000\u22B5\u20D2im;\uC000\u223C\u20D2\u0180Aan\u2CF0\u2CF4\u2D02rr;\u61D6r\u0100hr\u2CFA\u2CFDk;\u6923\u0100;o\u13E7\u13E5ear;\u6927\u1253\u1A95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2D2D\0\u2D38\u2D48\u2D60\u2D65\u2D72\u2D84\u1B07\0\0\u2D8D\u2DAB\0\u2DC8\u2DCE\0\u2DDC\u2E19\u2E2B\u2E3E\u2E43\u0100cs\u2D31\u1A97ute\u803B\xF3\u40F3\u0100iy\u2D3C\u2D45r\u0100;c\u1A9E\u2D42\u803B\xF4\u40F4;\u443E\u0280abios\u1AA0\u2D52\u2D57\u01C8\u2D5Alac;\u4151v;\u6A38old;\u69BClig;\u4153\u0100cr\u2D69\u2D6Dir;\u69BF;\uC000\u{1D52C}\u036F\u2D79\0\0\u2D7C\0\u2D82n;\u42DBave\u803B\xF2\u40F2;\u69C1\u0100bm\u2D88\u0DF4ar;\u69B5\u0200acit\u2D95\u2D98\u2DA5\u2DA8r\xF2\u1A80\u0100ir\u2D9D\u2DA0r;\u69BEoss;\u69BBn\xE5\u0E52;\u69C0\u0180aei\u2DB1\u2DB5\u2DB9cr;\u414Dga;\u43C9\u0180cdn\u2DC0\u2DC5\u01CDron;\u43BF;\u69B6pf;\uC000\u{1D560}\u0180ael\u2DD4\u2DD7\u01D2r;\u69B7rp;\u69B9\u0380;adiosv\u2DEA\u2DEB\u2DEE\u2E08\u2E0D\u2E10\u2E16\u6228r\xF2\u1A86\u0200;efm\u2DF7\u2DF8\u2E02\u2E05\u6A5Dr\u0100;o\u2DFE\u2DFF\u6134f\xBB\u2DFF\u803B\xAA\u40AA\u803B\xBA\u40BAgof;\u62B6r;\u6A56lope;\u6A57;\u6A5B\u0180clo\u2E1F\u2E21\u2E27\xF2\u2E01ash\u803B\xF8\u40F8l;\u6298i\u016C\u2E2F\u2E34de\u803B\xF5\u40F5es\u0100;a\u01DB\u2E3As;\u6A36ml\u803B\xF6\u40F6bar;\u633D\u0AE1\u2E5E\0\u2E7D\0\u2E80\u2E9D\0\u2EA2\u2EB9\0\0\u2ECB\u0E9C\0\u2F13\0\0\u2F2B\u2FBC\0\u2FC8r\u0200;ast\u0403\u2E67\u2E72\u0E85\u8100\xB6;l\u2E6D\u2E6E\u40B6le\xEC\u0403\u0269\u2E78\0\0\u2E7Bm;\u6AF3;\u6AFDy;\u443Fr\u0280cimpt\u2E8B\u2E8F\u2E93\u1865\u2E97nt;\u4025od;\u402Eil;\u6030enk;\u6031r;\uC000\u{1D52D}\u0180imo\u2EA8\u2EB0\u2EB4\u0100;v\u2EAD\u2EAE\u43C6;\u43D5ma\xF4\u0A76ne;\u660E\u0180;tv\u2EBF\u2EC0\u2EC8\u43C0chfork\xBB\u1FFD;\u43D6\u0100au\u2ECF\u2EDFn\u0100ck\u2ED5\u2EDDk\u0100;h\u21F4\u2EDB;\u610E\xF6\u21F4s\u0480;abcdemst\u2EF3\u2EF4\u1908\u2EF9\u2EFD\u2F04\u2F06\u2F0A\u2F0E\u402Bcir;\u6A23ir;\u6A22\u0100ou\u1D40\u2F02;\u6A25;\u6A72n\u80BB\xB1\u0E9Dim;\u6A26wo;\u6A27\u0180ipu\u2F19\u2F20\u2F25ntint;\u6A15f;\uC000\u{1D561}nd\u803B\xA3\u40A3\u0500;Eaceinosu\u0EC8\u2F3F\u2F41\u2F44\u2F47\u2F81\u2F89\u2F92\u2F7E\u2FB6;\u6AB3p;\u6AB7u\xE5\u0ED9\u0100;c\u0ECE\u2F4C\u0300;acens\u0EC8\u2F59\u2F5F\u2F66\u2F68\u2F7Eppro\xF8\u2F43urlye\xF1\u0ED9\xF1\u0ECE\u0180aes\u2F6F\u2F76\u2F7Approx;\u6AB9qq;\u6AB5im;\u62E8i\xED\u0EDFme\u0100;s\u2F88\u0EAE\u6032\u0180Eas\u2F78\u2F90\u2F7A\xF0\u2F75\u0180dfp\u0EEC\u2F99\u2FAF\u0180als\u2FA0\u2FA5\u2FAAlar;\u632Eine;\u6312urf;\u6313\u0100;t\u0EFB\u2FB4\xEF\u0EFBrel;\u62B0\u0100ci\u2FC0\u2FC5r;\uC000\u{1D4C5};\u43C8ncsp;\u6008\u0300fiopsu\u2FDA\u22E2\u2FDF\u2FE5\u2FEB\u2FF1r;\uC000\u{1D52E}pf;\uC000\u{1D562}rime;\u6057cr;\uC000\u{1D4C6}\u0180aeo\u2FF8\u3009\u3013t\u0100ei\u2FFE\u3005rnion\xF3\u06B0nt;\u6A16st\u0100;e\u3010\u3011\u403F\xF1\u1F19\xF4\u0F14\u0A80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30E0\u310E\u312B\u3147\u3162\u3172\u318E\u3206\u3215\u3224\u3229\u3258\u326E\u3272\u3290\u32B0\u32B7\u0180art\u3047\u304A\u304Cr\xF2\u10B3\xF2\u03DDail;\u691Car\xF2\u1C65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307F\u308F\u3094\u30CC\u0100eu\u306D\u3071;\uC000\u223D\u0331te;\u4155i\xE3\u116Emptyv;\u69B3g\u0200;del\u0FD1\u3089\u308B\u308D;\u6992;\u69A5\xE5\u0FD1uo\u803B\xBB\u40BBr\u0580;abcfhlpstw\u0FDC\u30AC\u30AF\u30B7\u30B9\u30BC\u30BE\u30C0\u30C3\u30C7\u30CAp;\u6975\u0100;f\u0FE0\u30B4s;\u6920;\u6933s;\u691E\xEB\u225D\xF0\u272El;\u6945im;\u6974l;\u61A3;\u619D\u0100ai\u30D1\u30D5il;\u691Ao\u0100;n\u30DB\u30DC\u6236al\xF3\u0F1E\u0180abr\u30E7\u30EA\u30EEr\xF2\u17E5rk;\u6773\u0100ak\u30F3\u30FDc\u0100ek\u30F9\u30FB;\u407D;\u405D\u0100es\u3102\u3104;\u698Cl\u0100du\u310A\u310C;\u698E;\u6990\u0200aeuy\u3117\u311C\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xEC\u0FF2\xE2\u30FA;\u4440\u0200clqs\u3134\u3137\u313D\u3144a;\u6937dhar;\u6969uo\u0100;r\u020E\u020Dh;\u61B3\u0180acg\u314E\u315F\u0F44l\u0200;ips\u0F78\u3158\u315B\u109Cn\xE5\u10BBar\xF4\u0FA9t;\u65AD\u0180ilr\u3169\u1023\u316Esht;\u697D;\uC000\u{1D52F}\u0100ao\u3177\u3186r\u0100du\u317D\u317F\xBB\u047B\u0100;l\u1091\u3184;\u696C\u0100;v\u318B\u318C\u43C1;\u43F1\u0180gns\u3195\u31F9\u31FCht\u0300ahlrst\u31A4\u31B0\u31C2\u31D8\u31E4\u31EErrow\u0100;t\u0FDC\u31ADa\xE9\u30C8arpoon\u0100du\u31BB\u31BFow\xEE\u317Ep\xBB\u1092eft\u0100ah\u31CA\u31D0rrow\xF3\u0FEAarpoon\xF3\u0551ightarrows;\u61C9quigarro\xF7\u30CBhreetimes;\u62CCg;\u42DAingdotse\xF1\u1F32\u0180ahm\u320D\u3210\u3213r\xF2\u0FEAa\xF2\u0551;\u600Foust\u0100;a\u321E\u321F\u63B1che\xBB\u321Fmid;\u6AEE\u0200abpt\u3232\u323D\u3240\u3252\u0100nr\u3237\u323Ag;\u67EDr;\u61FEr\xEB\u1003\u0180afl\u3247\u324A\u324Er;\u6986;\uC000\u{1D563}us;\u6A2Eimes;\u6A35\u0100ap\u325D\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6A12ar\xF2\u31E3\u0200achq\u327B\u3280\u10BC\u3285quo;\u603Ar;\uC000\u{1D4C7}\u0100bu\u30FB\u328Ao\u0100;r\u0214\u0213\u0180hir\u3297\u329B\u32A0re\xE5\u31F8mes;\u62CAi\u0200;efl\u32AA\u1059\u1821\u32AB\u65B9tri;\u69CEluhar;\u6968;\u611E\u0D61\u32D5\u32DB\u32DF\u332C\u3338\u3371\0\u337A\u33A4\0\0\u33EC\u33F0\0\u3428\u3448\u345A\u34AD\u34B1\u34CA\u34F1\0\u3616\0\0\u3633cute;\u415Bqu\xEF\u27BA\u0500;Eaceinpsy\u11ED\u32F3\u32F5\u32FF\u3302\u330B\u330F\u331F\u3326\u3329;\u6AB4\u01F0\u32FA\0\u32FC;\u6AB8on;\u4161u\xE5\u11FE\u0100;d\u11F3\u3307il;\u415Frc;\u415D\u0180Eas\u3316\u3318\u331B;\u6AB6p;\u6ABAim;\u62E9olint;\u6A13i\xED\u1204;\u4441ot\u0180;be\u3334\u1D47\u3335\u62C5;\u6A66\u0380Aacmstx\u3346\u334A\u3357\u335B\u335E\u3363\u336Drr;\u61D8r\u0100hr\u3350\u3352\xEB\u2228\u0100;o\u0A36\u0A34t\u803B\xA7\u40A7i;\u403Bwar;\u6929m\u0100in\u3369\xF0nu\xF3\xF1t;\u6736r\u0100;o\u3376\u2055\uC000\u{1D530}\u0200acoy\u3382\u3386\u3391\u33A0rp;\u666F\u0100hy\u338B\u338Fcy;\u4449;\u4448rt\u026D\u3399\0\0\u339Ci\xE4\u1464ara\xEC\u2E6F\u803B\xAD\u40AD\u0100gm\u33A8\u33B4ma\u0180;fv\u33B1\u33B2\u33B2\u43C3;\u43C2\u0400;deglnpr\u12AB\u33C5\u33C9\u33CE\u33D6\u33DE\u33E1\u33E6ot;\u6A6A\u0100;q\u12B1\u12B0\u0100;E\u33D3\u33D4\u6A9E;\u6AA0\u0100;E\u33DB\u33DC\u6A9D;\u6A9Fe;\u6246lus;\u6A24arr;\u6972ar\xF2\u113D\u0200aeit\u33F8\u3408\u340F\u3417\u0100ls\u33FD\u3404lsetm\xE9\u336Ahp;\u6A33parsl;\u69E4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341C\u341D\u6AAA\u0100;s\u3422\u3423\u6AAC;\uC000\u2AAC\uFE00\u0180flp\u342E\u3433\u3442tcy;\u444C\u0100;b\u3438\u3439\u402F\u0100;a\u343E\u343F\u69C4r;\u633Ff;\uC000\u{1D564}a\u0100dr\u344D\u0402es\u0100;u\u3454\u3455\u6660it\xBB\u3455\u0180csu\u3460\u3479\u349F\u0100au\u3465\u346Fp\u0100;s\u1188\u346B;\uC000\u2293\uFE00p\u0100;s\u11B4\u3475;\uC000\u2294\uFE00u\u0100bp\u347F\u348F\u0180;es\u1197\u119C\u3486et\u0100;e\u1197\u348D\xF1\u119D\u0180;es\u11A8\u11AD\u3496et\u0100;e\u11A8\u349D\xF1\u11AE\u0180;af\u117B\u34A6\u05B0r\u0165\u34AB\u05B1\xBB\u117Car\xF2\u1148\u0200cemt\u34B9\u34BE\u34C2\u34C5r;\uC000\u{1D4C8}tm\xEE\xF1i\xEC\u3415ar\xE6\u11BE\u0100ar\u34CE\u34D5r\u0100;f\u34D4\u17BF\u6606\u0100an\u34DA\u34EDight\u0100ep\u34E3\u34EApsilo\xEE\u1EE0h\xE9\u2EAFs\xBB\u2852\u0280bcmnp\u34FB\u355E\u1209\u358B\u358E\u0480;Edemnprs\u350E\u350F\u3511\u3515\u351E\u3523\u352C\u3531\u3536\u6282;\u6AC5ot;\u6ABD\u0100;d\u11DA\u351Aot;\u6AC3ult;\u6AC1\u0100Ee\u3528\u352A;\u6ACB;\u628Alus;\u6ABFarr;\u6979\u0180eiu\u353D\u3552\u3555t\u0180;en\u350E\u3545\u354Bq\u0100;q\u11DA\u350Feq\u0100;q\u352B\u3528m;\u6AC7\u0100bp\u355A\u355C;\u6AD5;\u6AD3c\u0300;acens\u11ED\u356C\u3572\u3579\u357B\u3326ppro\xF8\u32FAurlye\xF1\u11FE\xF1\u11F3\u0180aes\u3582\u3588\u331Bppro\xF8\u331Aq\xF1\u3317g;\u666A\u0680123;Edehlmnps\u35A9\u35AC\u35AF\u121C\u35B2\u35B4\u35C0\u35C9\u35D5\u35DA\u35DF\u35E8\u35ED\u803B\xB9\u40B9\u803B\xB2\u40B2\u803B\xB3\u40B3;\u6AC6\u0100os\u35B9\u35BCt;\u6ABEub;\u6AD8\u0100;d\u1222\u35C5ot;\u6AC4s\u0100ou\u35CF\u35D2l;\u67C9b;\u6AD7arr;\u697Bult;\u6AC2\u0100Ee\u35E4\u35E6;\u6ACC;\u628Blus;\u6AC0\u0180eiu\u35F4\u3609\u360Ct\u0180;en\u121C\u35FC\u3602q\u0100;q\u1222\u35B2eq\u0100;q\u35E7\u35E4m;\u6AC8\u0100bp\u3611\u3613;\u6AD4;\u6AD6\u0180Aan\u361C\u3620\u362Drr;\u61D9r\u0100hr\u3626\u3628\xEB\u222E\u0100;o\u0A2B\u0A29war;\u692Alig\u803B\xDF\u40DF\u0BE1\u3651\u365D\u3660\u12CE\u3673\u3679\0\u367E\u36C2\0\0\0\0\0\u36DB\u3703\0\u3709\u376C\0\0\0\u3787\u0272\u3656\0\0\u365Bget;\u6316;\u43C4r\xEB\u0E5F\u0180aey\u3666\u366B\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uC000\u{1D531}\u0200eiko\u3686\u369D\u36B5\u36BC\u01F2\u368B\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369B\u43B8ym;\u43D1\u0100cn\u36A2\u36B2k\u0100as\u36A8\u36AEppro\xF8\u12C1im\xBB\u12ACs\xF0\u129E\u0100as\u36BA\u36AE\xF0\u12C1rn\u803B\xFE\u40FE\u01EC\u031F\u36C6\u22E7es\u8180\xD7;bd\u36CF\u36D0\u36D8\u40D7\u0100;a\u190F\u36D5r;\u6A31;\u6A30\u0180eps\u36E1\u36E3\u3700\xE1\u2A4D\u0200;bcf\u0486\u36EC\u36F0\u36F4ot;\u6336ir;\u6AF1\u0100;o\u36F9\u36FC\uC000\u{1D565}rk;\u6ADA\xE1\u3362rime;\u6034\u0180aip\u370F\u3712\u3764d\xE5\u1248\u0380adempst\u3721\u374D\u3740\u3751\u3757\u375C\u375Fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65B5own\xBB\u1DBBeft\u0100;e\u2800\u373E\xF1\u092E;\u625Cight\u0100;e\u32AA\u374B\xF1\u105Aot;\u65ECinus;\u6A3Alus;\u6A39b;\u69CDime;\u6A3Bezium;\u63E2\u0180cht\u3772\u377D\u3781\u0100ry\u3777\u377B;\uC000\u{1D4C9};\u4446cy;\u445Brok;\u4167\u0100io\u378B\u378Ex\xF4\u1777head\u0100lr\u3797\u37A0eftarro\xF7\u084Fightarrow\xBB\u0F5D\u0900AHabcdfghlmoprstuw\u37D0\u37D3\u37D7\u37E4\u37F0\u37FC\u380E\u381C\u3823\u3834\u3851\u385D\u386B\u38A9\u38CC\u38D2\u38EA\u38F6r\xF2\u03EDar;\u6963\u0100cr\u37DC\u37E2ute\u803B\xFA\u40FA\xF2\u1150r\u01E3\u37EA\0\u37EDy;\u445Eve;\u416D\u0100iy\u37F5\u37FArc\u803B\xFB\u40FB;\u4443\u0180abh\u3803\u3806\u380Br\xF2\u13ADlac;\u4171a\xF2\u13C3\u0100ir\u3813\u3818sht;\u697E;\uC000\u{1D532}rave\u803B\xF9\u40F9\u0161\u3827\u3831r\u0100lr\u382C\u382E\xBB\u0957\xBB\u1083lk;\u6580\u0100ct\u3839\u384D\u026F\u383F\0\0\u384Arn\u0100;e\u3845\u3846\u631Cr\xBB\u3846op;\u630Fri;\u65F8\u0100al\u3856\u385Acr;\u416B\u80BB\xA8\u0349\u0100gp\u3862\u3866on;\u4173f;\uC000\u{1D566}\u0300adhlsu\u114B\u3878\u387D\u1372\u3891\u38A0own\xE1\u13B3arpoon\u0100lr\u3888\u388Cef\xF4\u382Digh\xF4\u382Fi\u0180;hl\u3899\u389A\u389C\u43C5\xBB\u13FAon\xBB\u389Aparrows;\u61C8\u0180cit\u38B0\u38C4\u38C8\u026F\u38B6\0\0\u38C1rn\u0100;e\u38BC\u38BD\u631Dr\xBB\u38BDop;\u630Eng;\u416Fri;\u65F9cr;\uC000\u{1D4CA}\u0180dir\u38D9\u38DD\u38E2ot;\u62F0lde;\u4169i\u0100;f\u3730\u38E8\xBB\u1813\u0100am\u38EF\u38F2r\xF2\u38A8l\u803B\xFC\u40FCangle;\u69A7\u0780ABDacdeflnoprsz\u391C\u391F\u3929\u392D\u39B5\u39B8\u39BD\u39DF\u39E4\u39E8\u39F3\u39F9\u39FD\u3A01\u3A20r\xF2\u03F7ar\u0100;v\u3926\u3927\u6AE8;\u6AE9as\xE8\u03E1\u0100nr\u3932\u3937grt;\u699C\u0380eknprst\u34E3\u3946\u394B\u3952\u395D\u3964\u3996app\xE1\u2415othin\xE7\u1E96\u0180hir\u34EB\u2EC8\u3959op\xF4\u2FB5\u0100;h\u13B7\u3962\xEF\u318D\u0100iu\u3969\u396Dgm\xE1\u33B3\u0100bp\u3972\u3984setneq\u0100;q\u397D\u3980\uC000\u228A\uFE00;\uC000\u2ACB\uFE00setneq\u0100;q\u398F\u3992\uC000\u228B\uFE00;\uC000\u2ACC\uFE00\u0100hr\u399B\u399Fet\xE1\u369Ciangle\u0100lr\u39AA\u39AFeft\xBB\u0925ight\xBB\u1051y;\u4432ash\xBB\u1036\u0180elr\u39C4\u39D2\u39D7\u0180;be\u2DEA\u39CB\u39CFar;\u62BBq;\u625Alip;\u62EE\u0100bt\u39DC\u1468a\xF2\u1469r;\uC000\u{1D533}tr\xE9\u39AEsu\u0100bp\u39EF\u39F1\xBB\u0D1C\xBB\u0D59pf;\uC000\u{1D567}ro\xF0\u0EFBtr\xE9\u39B4\u0100cu\u3A06\u3A0Br;\uC000\u{1D4CB}\u0100bp\u3A10\u3A18n\u0100Ee\u3980\u3A16\xBB\u397En\u0100Ee\u3992\u3A1E\xBB\u3990igzag;\u699A\u0380cefoprs\u3A36\u3A3B\u3A56\u3A5B\u3A54\u3A61\u3A6Airc;\u4175\u0100di\u3A40\u3A51\u0100bg\u3A45\u3A49ar;\u6A5Fe\u0100;q\u15FA\u3A4F;\u6259erp;\u6118r;\uC000\u{1D534}pf;\uC000\u{1D568}\u0100;e\u1479\u3A66at\xE8\u1479cr;\uC000\u{1D4CC}\u0AE3\u178E\u3A87\0\u3A8B\0\u3A90\u3A9B\0\0\u3A9D\u3AA8\u3AAB\u3AAF\0\0\u3AC3\u3ACE\0\u3AD8\u17DC\u17DFtr\xE9\u17D1r;\uC000\u{1D535}\u0100Aa\u3A94\u3A97r\xF2\u03C3r\xF2\u09F6;\u43BE\u0100Aa\u3AA1\u3AA4r\xF2\u03B8r\xF2\u09EBa\xF0\u2713is;\u62FB\u0180dpt\u17A4\u3AB5\u3ABE\u0100fl\u3ABA\u17A9;\uC000\u{1D569}im\xE5\u17B2\u0100Aa\u3AC7\u3ACAr\xF2\u03CEr\xF2\u0A01\u0100cq\u3AD2\u17B8r;\uC000\u{1D4CD}\u0100pt\u17D6\u3ADCr\xE9\u17D4\u0400acefiosu\u3AF0\u3AFD\u3B08\u3B0C\u3B11\u3B15\u3B1B\u3B21c\u0100uy\u3AF6\u3AFBte\u803B\xFD\u40FD;\u444F\u0100iy\u3B02\u3B06rc;\u4177;\u444Bn\u803B\xA5\u40A5r;\uC000\u{1D536}cy;\u4457pf;\uC000\u{1D56A}cr;\uC000\u{1D4CE}\u0100cm\u3B26\u3B29y;\u444El\u803B\xFF\u40FF\u0500acdefhiosw\u3B42\u3B48\u3B54\u3B58\u3B64\u3B69\u3B6D\u3B74\u3B7A\u3B80cute;\u417A\u0100ay\u3B4D\u3B52ron;\u417E;\u4437ot;\u417C\u0100et\u3B5D\u3B61tr\xE6\u155Fa;\u43B6r;\uC000\u{1D537}cy;\u4436grarr;\u61DDpf;\uC000\u{1D56B}cr;\uC000\u{1D4CF}\u0100jn\u3B85\u3B87;\u600Dj;\u600C'.split("").map(n=>n.charCodeAt(0)));var po=new Uint16Array("\u0200aglq	\x1B\u026D\0\0p;\u4026os;\u4027t;\u403Et;\u403Cuot;\u4022".split("").map(n=>n.charCodeAt(0)));var Cr,Sa=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Tr=(Cr=String.fromCodePoint)!==null&&Cr!==void 0?Cr:function(n){let t="";return n>65535&&(n-=65536,t+=String.fromCharCode(n>>>10&1023|55296),n=56320|n&1023),t+=String.fromCharCode(n),t};function Ar(n){var t;return n>=55296&&n<=57343||n>1114111?65533:(t=Sa.get(n))!==null&&t!==void 0?t:n}var Mt;(function(n){n[n.NUM=35]="NUM",n[n.SEMI=59]="SEMI",n[n.EQUALS=61]="EQUALS",n[n.ZERO=48]="ZERO",n[n.NINE=57]="NINE",n[n.LOWER_A=97]="LOWER_A",n[n.LOWER_F=102]="LOWER_F",n[n.LOWER_X=120]="LOWER_X",n[n.LOWER_Z=122]="LOWER_Z",n[n.UPPER_A=65]="UPPER_A",n[n.UPPER_F=70]="UPPER_F",n[n.UPPER_Z=90]="UPPER_Z"})(Mt||(Mt={}));var Ca=32,ve;(function(n){n[n.VALUE_LENGTH=49152]="VALUE_LENGTH",n[n.BRANCH_LENGTH=16256]="BRANCH_LENGTH",n[n.JUMP_TABLE=127]="JUMP_TABLE"})(ve||(ve={}));function Or(n){return n>=Mt.ZERO&&n<=Mt.NINE}function Ta(n){return n>=Mt.UPPER_A&&n<=Mt.UPPER_F||n>=Mt.LOWER_A&&n<=Mt.LOWER_F}function Aa(n){return n>=Mt.UPPER_A&&n<=Mt.UPPER_Z||n>=Mt.LOWER_A&&n<=Mt.LOWER_Z||Or(n)}function Oa(n){return n===Mt.EQUALS||Aa(n)}var Et;(function(n){n[n.EntityStart=0]="EntityStart",n[n.NumericStart=1]="NumericStart",n[n.NumericDecimal=2]="NumericDecimal",n[n.NumericHex=3]="NumericHex",n[n.NamedEntity=4]="NamedEntity"})(Et||(Et={}));var Wt;(function(n){n[n.Legacy=0]="Legacy",n[n.Strict=1]="Strict",n[n.Attribute=2]="Attribute"})(Wt||(Wt={}));var nn=class{constructor(t,e,i){this.decodeTree=t,this.emitCodePoint=e,this.errors=i,this.state=Et.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Wt.Strict}startEntity(t){this.decodeMode=t,this.state=Et.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,e){switch(this.state){case Et.EntityStart:return t.charCodeAt(e)===Mt.NUM?(this.state=Et.NumericStart,this.consumed+=1,this.stateNumericStart(t,e+1)):(this.state=Et.NamedEntity,this.stateNamedEntity(t,e));case Et.NumericStart:return this.stateNumericStart(t,e);case Et.NumericDecimal:return this.stateNumericDecimal(t,e);case Et.NumericHex:return this.stateNumericHex(t,e);case Et.NamedEntity:return this.stateNamedEntity(t,e)}}stateNumericStart(t,e){return e>=t.length?-1:(t.charCodeAt(e)|Ca)===Mt.LOWER_X?(this.state=Et.NumericHex,this.consumed+=1,this.stateNumericHex(t,e+1)):(this.state=Et.NumericDecimal,this.stateNumericDecimal(t,e))}addToNumericResult(t,e,i,r){if(e!==i){let s=i-e;this.result=this.result*Math.pow(r,s)+parseInt(t.substr(e,s),r),this.consumed+=s}}stateNumericHex(t,e){let i=e;for(;e<t.length;){let r=t.charCodeAt(e);if(Or(r)||Ta(r))e+=1;else return this.addToNumericResult(t,i,e,16),this.emitNumericEntity(r,3)}return this.addToNumericResult(t,i,e,16),-1}stateNumericDecimal(t,e){let i=e;for(;e<t.length;){let r=t.charCodeAt(e);if(Or(r))e+=1;else return this.addToNumericResult(t,i,e,10),this.emitNumericEntity(r,2)}return this.addToNumericResult(t,i,e,10),-1}emitNumericEntity(t,e){var i;if(this.consumed<=e)return(i=this.errors)===null||i===void 0||i.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Mt.SEMI)this.consumed+=1;else if(this.decodeMode===Wt.Strict)return 0;return this.emitCodePoint(Ar(this.result),this.consumed),this.errors&&(t!==Mt.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,e){let{decodeTree:i}=this,r=i[this.treeIndex],s=(r&ve.VALUE_LENGTH)>>14;for(;e<t.length;e++,this.excess++){let o=t.charCodeAt(e);if(this.treeIndex=Ea(i,r,this.treeIndex+Math.max(1,s),o),this.treeIndex<0)return this.result===0||this.decodeMode===Wt.Attribute&&(s===0||Oa(o))?0:this.emitNotTerminatedNamedEntity();if(r=i[this.treeIndex],s=(r&ve.VALUE_LENGTH)>>14,s!==0){if(o===Mt.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==Wt.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;let{result:e,decodeTree:i}=this,r=(i[e]&ve.VALUE_LENGTH)>>14;return this.emitNamedEntityData(e,r,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,e,i){let{decodeTree:r}=this;return this.emitCodePoint(e===1?r[t]&~ve.VALUE_LENGTH:r[t+1],i),e===3&&this.emitCodePoint(r[t+2],i),i}end(){var t;switch(this.state){case Et.NamedEntity:return this.result!==0&&(this.decodeMode!==Wt.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Et.NumericDecimal:return this.emitNumericEntity(0,2);case Et.NumericHex:return this.emitNumericEntity(0,3);case Et.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Et.EntityStart:return 0}}};function mo(n){let t="",e=new nn(n,i=>t+=Tr(i));return function(r,s){let o=0,u=0;for(;(u=r.indexOf("&",u))>=0;){t+=r.slice(o,u),e.startEntity(s);let a=e.write(r,u+1);if(a<0){o=u+e.end();break}o=u+a,u=a===0?o+1:o}let l=t+r.slice(o);return t="",l}}function Ea(n,t,e,i){let r=(t&ve.BRANCH_LENGTH)>>7,s=t&ve.JUMP_TABLE;if(r===0)return s!==0&&i===s?e:-1;if(s){let l=i-s;return l<0||l>=r?-1:n[e+l]-1}let o=e,u=o+r-1;for(;o<=u;){let l=o+u>>>1,a=n[l];if(a<i)o=l+1;else if(a>i)u=l-1;else return n[l+r]}return-1}var Ma=mo(fo),hd=mo(po);function Qe(n,t=Wt.Legacy){return Ma(n,t)}function rn(n){for(let t=1;t<n.length;t++)n[t][0]+=n[t-1][0]+1;return n}var Ia=new Map(rn([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(rn([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(rn([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(rn([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var Na=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),Pa=String.prototype.codePointAt!=null?(n,t)=>n.codePointAt(t):(n,t)=>(n.charCodeAt(t)&64512)===55296?(n.charCodeAt(t)-55296)*1024+n.charCodeAt(t+1)-56320+65536:n.charCodeAt(t);function Er(n,t){return function(i){let r,s=0,o="";for(;r=n.exec(i);)s!==r.index&&(o+=i.substring(s,r.index)),o+=t.get(r[0].charCodeAt(0)),s=r.index+1;return o+i.substring(s)}}var go=Er(/[&<>'"]/g,Na),bo=Er(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),vo=Er(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]));var yo;(function(n){n[n.XML=0]="XML",n[n.HTML=1]="HTML"})(yo||(yo={}));var xo;(function(n){n[n.UTF8=0]="UTF8",n[n.ASCII=1]="ASCII",n[n.Extensive=2]="Extensive",n[n.Attribute=3]="Attribute",n[n.Text=4]="Text"})(xo||(xo={}));async function Ir(n,t,e){let i=null,r=null,s=null,o=Qe(n.innerHTML,Wt.Strict);if(t){let m=t.getSectionInfo(n);if(m){let v=di(m.text),S=[...m.text.matchAll(/\n/g)].map(N=>N.index);if(r=m.lineStart?S[m.lineStart-1]+1:0,s=S[m.lineEnd]??m.text.length,i=v.nodes_in_range(r,s,!0),!i.length)return;if(i.length===1){let N=i[0],M=!1,B=null;if(N.type===2?N.part_encloses_range(r,s,!0)&&(M=!0,B=!0)||N.part_encloses_range(r,s,!1)&&(M=!0,B=!1):M=N.encloses_range(r,s),M){N.type===2&&(o=o.replace(/~>/g,""));let R=r===N.from;if(s===N.to){let O=o.lastIndexOf($[N.type].at(-1));o=o.substring(0,O)+o.substring(O+3)}if(R){let O=o.indexOf($[N.type][0]);o=o.substring(0,O)+o.substring(O+3)}n.innerHTML=N.postprocess(!1,e.preview_mode,"div",B,o);return}}}}o=o.replaceAll(/{<del>|{<\/del>/g,"{~~").replaceAll(/<del>}|<\/del>}/g,"~~}").replaceAll(/{<mark>|{<\/mark>/g,"{==").replaceAll(/<mark>}|<\/mark>}/g,"==}").replaceAll(/{=<mark>=}|{=<\/mark>=}/g,"{====}");let u=di(o).nodes;for(let m=0;m<u.length-1;m++){let v=u[m],S=u[m+1];v.equals(S)&&(u.splice(m,1),m--)}if(!u.length&&!i?.length)return;let l=0,a="",h=null,f=null,d=null;if(i!==null&&u.length!==i.length&&(f=r>i[0].from,d=s<i.at(-1).to,h=d?i.at(-1):i[0]),h&&f&&d&&h.type===2){let m=o.indexOf($[2][1]),v=new me(-1/0,m,1/0,o);a+=v.postprocess(!0,e.preview_mode,"span"),n.innerHTML=a;return}if(h&&!d){let m=o.indexOf($[h.type].at(-1))+3,v;if(h.type===2){let S=o.indexOf($[2][1]);v=new me(-1/0,S===-1?-1/0:S,m,o)}else v=new ci[h.type](-1/0,m,o);a+=v.postprocess(!0,e.preview_mode,"span"),l=v.to}for(let m of u)a+=o.slice(l,m.from)+m.postprocess(!0,e.preview_mode,"span"),l=m.to;if(h&&d){let m=o.lastIndexOf($[h.type][0]),v;h.type===2?v=new me(0,1/0,1/0,o.slice(m,-4)):v=new ci[h.type](0,1/0,o.slice(m,-4)),a+=o.slice(l,m)+v.postprocess(!0,e.preview_mode,"span"),l=1/0}a+=o.slice(l),n.innerHTML=a}function Nr(){for(let n of app.workspace.getLeavesOfType("markdown")){let t=n.view;for(let e of t.previewMode.renderer.sections.filter(i=>i.el.querySelector(".criticmarkup-preview")))e.rendered=!1,e.html="";t.previewMode.renderer.queueRender()}}function _o(){for(let n of app.workspace.getLeavesOfType("markdown"))n.view.previewMode.rerender(!0)}var au=require("@codemirror/view");var on=require("@codemirror/view"),$t=require("@codemirror/state"),Pr=require("@codemirror/language");function sn(n,t,e){if(n instanceof on.EditorView)for(let i of n.state.facet(on.EditorView.atomicRanges).map(r=>r(n)))i.between(t,t,(r,s)=>{r<t&&s>t&&(t=e?s:r)});return t}function So(n,t,e,i){if(n.state.readOnly)return!1;let r="delete.selection",{state:s}=n,o=s.changeByRange(l=>{let{from:a,to:h}=l;if(a==h){let f=t(a);f<a?(r="delete.backward",f=sn(n,f,!1)):f>a&&(r="delete.forward",f=sn(n,f,!0)),a=Math.min(a,f),h=Math.max(h,f)}else a=sn(n,a,!1),h=sn(n,h,!0);return a==h?{range:l}:{changes:{from:a,to:h},range:$t.EditorSelection.cursor(a)}});if(o.changes.empty)return!1;let u=[];return e!==void 0&&r==="delete.selection"&&u.push($t.Transaction.userEvent.of(e?"delete.selection.forward":"delete.selection.backward")),i&&u.push($t.Transaction.userEvent.of("delete.group")),n.dispatch(s.update(o,{scrollIntoView:!0,userEvent:r,annotations:u,effects:r=="delete.selection"?on.EditorView.announce.of(s.phrase("Selection deleted")):void 0})),!0}var Co=(n,t)=>So(n,e=>{let{state:i}=n,r=i.doc.lineAt(e),s,o;if(!t&&e>r.from&&e<r.from+200&&!/[^ \t]/.test(s=r.text.slice(0,e-r.from))){if(s[s.length-1]=="	")return e-1;let u=(0,$t.countColumn)(s,i.tabSize),l=u%(0,Pr.getIndentUnit)(i)||(0,Pr.getIndentUnit)(i);for(let a=0;a<l&&s[s.length-1-a]==" ";a++)e--;o=e}else o=(0,$t.findClusterBreak)(r.text,e-r.from,t,t)+r.from,o==e&&r.number!=(t?i.doc.lines:1)&&(o+=t?1:-1);return o},t),To=(n,t)=>So(n,e=>{let i=e,{state:r}=n,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let u=null;;){if(i==(t?s.to:s.from)){i==e&&s.number!=(t?r.doc.lines:1)&&(i+=t?1:-1);break}let l=(0,$t.findClusterBreak)(s.text,i-s.from,t)+s.from,a=s.text.slice(Math.min(i,l)-s.from,Math.max(i,l)-s.from),h=o(a);if(u!=null&&h!=u)break;(a!=" "||i!=e)&&(u=h),i=l}return i},t,!0),Ao=n=>To(n,!1),Oo=n=>To(n,!0),Dr=n=>Co(n,!1),Eo=n=>Co(n,!0);var ae=require("@codemirror/state"),gi=require("@codemirror/view");function Rr(n,t){return ae.EditorSelection.create(n.ranges.map(t),n.mainIndex)}function Pe(n,t,e,i,r){let s=[];return e!==void 0&&s.push(ae.Transaction.userEvent.of(e?"select.forward":"select.backward")),i&&s.push(ae.Transaction.userEvent.of("select.group")),r&&s.push(ae.Transaction.userEvent.of("select.extend")),s.length||(s=void 0),n.update({selection:t,scrollIntoView:!0,userEvent:"select",annotations:s})}function bi({state:n,dispatch:t},e,i,r){let s=Rr(n.selection,e);return s.eq(n.selection)?!1:(t(Pe(n,s,i,r)),!0)}function un(n,t){return ae.EditorSelection.cursor(t?n.to:n.from)}function Mo(n,t){return bi(n,e=>e.empty?n.moveByChar(e,t):un(e,t),t)}function Xe(n,t,e,i){let r=Rr(n.state.selection,s=>{let o=t(s);return ae.EditorSelection.range(s.anchor,o.head,o.goalColumn,o.bidiLevel||void 0)});return r.eq(n.state.selection)?!1:(n.dispatch(Pe(n.state,r,e,i,!0)),!0)}function Io(n,t){return Xe(n,e=>n.moveByChar(e,t),t)}function No(n,t){return bi(n,e=>e.empty?n.moveByGroup(e,t):un(e,t),t,!0)}function Po(n,t){return Xe(n,e=>n.moveByGroup(e,t),t,!0)}function Rt(n){return n.textDirectionAt(n.state.selection.main.head)==gi.Direction.LTR}function ln(n,t,e){let i=n.lineBlockAt(t.head),r=n.moveToLineBoundary(t,e);if(r.head==t.head&&r.head!=(e?i.to:i.from)&&(r=n.moveToLineBoundary(t,e,!1)),!e&&r.head==i.from&&i.length){let s=/^\s*/.exec(n.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;s&&t.head!=i.from+s&&(r=ae.EditorSelection.cursor(i.from+s))}return r}function Do(n,t){return bi(n,e=>{if(!e.empty)return un(e,t);let i=n.moveVertically(e,t);return i.head!=e.head?i:n.moveToLineBoundary(e,t)},t,!1)}function Ro(n,t){return Xe(n,e=>n.moveVertically(e,t),t)}function Bo(n){let t=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,e=0,i=0,r;if(t){for(let s of n.state.facet(gi.EditorView.scrollMargins)){let o=s(n);o?.top&&(e=Math.max(o?.top,e)),o?.bottom&&(i=Math.max(o?.bottom,i))}r=n.scrollDOM.clientHeight-e-i}else r=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:e,marginBottom:i,selfScroll:t,height:Math.max(n.defaultLineHeight,r-5)}}function Lo(n,t){let e=Bo(n),{state:i}=n,r=Rr(i.selection,o=>o.empty?n.moveVertically(o,t,e.height):un(o,t));if(r.eq(i.selection))return!1;let s;if(e.selfScroll){let o=n.coordsAtPos(i.selection.main.head),u=n.scrollDOM.getBoundingClientRect(),l=u.top+e.marginTop,a=u.bottom-e.marginBottom;o&&o.top>l&&o.bottom<a&&(s=gi.EditorView.scrollIntoView(r.main.head,{y:"start",yMargin:o.top-l}))}return n.dispatch(Pe(i,r,t),{effects:s}),!0}function zo(n,t){return Xe(n,e=>n.moveVertically(e,t,Bo(n).height),t)}var Fo=n=>Mo(n,!Rt(n)),Ho=n=>No(n,!Rt(n)),Vo=n=>Io(n,!Rt(n)),qo=n=>Po(n,!Rt(n)),Uo=n=>Do(n,!1),Wo=n=>Ro(n,!1),jo=n=>bi(n,t=>ln(n,t,!Rt(n)),!Rt(n)),Go=n=>Xe(n,t=>ln(n,t,!Rt(n)),!Rt(n)),Ko=n=>Mo(n,Rt(n)),Yo=n=>No(n,Rt(n)),Jo=n=>Io(n,Rt(n)),Qo=n=>Po(n,Rt(n)),Xo=n=>Do(n,!0),Zo=n=>Ro(n,!0),$o=n=>bi(n,t=>ln(n,t,Rt(n))),tu=n=>Xe(n,t=>ln(n,t,Rt(n))),eu=({state:n,dispatch:t})=>(t(Pe(n,{anchor:n.selection.main.anchor,head:0},!1)),!0),iu=({state:n,dispatch:t})=>(t(Pe(n,{anchor:n.selection.main.anchor,head:n.doc.length},!0)),!0),nu=({state:n,dispatch:t})=>(t(Pe(n,{anchor:0},!0)),!0),ru=({state:n,dispatch:t})=>(t(Pe(n,{anchor:n.doc.length},!1)),!0),su=n=>Lo(n,!1),ou=n=>Lo(n,!0),uu=n=>zo(n,!1),lu=n=>zo(n,!0);var hu=require("@codemirror/state"),Ba=[{key:"ArrowLeft",run:Fo,shift:Vo,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Ho,shift:qo,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:jo,shift:Go,preventDefault:!0},{key:"ArrowRight",run:Ko,shift:Jo,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Yo,shift:Qo,preventDefault:!0},{mac:"Cmd-ArrowRight",run:$o,shift:tu,preventDefault:!0},{key:"ArrowUp",run:Uo,shift:Wo},{mac:"Cmd-ArrowUp",run:nu,shift:eu,preventDefault:!0},{mac:"Ctrl-ArrowUp",run:su,shift:uu,preventDefault:!0},{key:"ArrowDown",run:Xo,shift:Zo,preventDefault:!0},{mac:"Cmd-ArrowDown",run:ru,shift:iu,preventDefault:!0},{mac:"Ctrl-ArrowDown",run:ou,shift:lu,preventDefault:!0},{key:"Backspace",run:Dr,shift:Dr,preventDefault:!0},{key:"Delete",run:Eo,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Ao,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:Oo,preventDefault:!0}],cu=hu.Prec.highest(au.keymap.of(Ba));var vi=require("@codemirror/state");var La={moveByCharacters:{group:!1}};function za(n,t){return t.some(e=>e.startsWith(n))}var fu=n=>vi.EditorState.transactionFilter.of(t=>Fa(t,n));function Fa(n,t){let e=hr(n),i=app.workspace.activeEditor?.editor?.cm.cm!==void 0;if(!n.docChanged&&n.selection&&i&&(cr(n)&&e.push(n.startState.selection.ranges[0].from<n.selection.ranges[0].from?"select.forward":"select.backward"),La[app.workspace.activeEditor?.editor?.cm.cm?.state.vim.lastMotion?.name]?.group&&e.push("select.group")),n.docChanged){let r=Ks(n.changes,n.startState.doc);if(!(n.isUserEvent("input")||n.isUserEvent("paste")||n.isUserEvent("delete")))return n;let o;if(r[0].offset.added&&r[0].offset.removed)o=2;else if(r[0].offset.added)o=0;else if(r[0].offset.removed)o=1;else return console.error("No operation type could be determined"),n;let u=n.startState.field(vt).nodes,l=[],a=[];if(o===0){let h=0;for(let f of r){let d=Xs(f,u,h);l.push(...d.changes),a.push(d.selection),h=d.offset}}else if(o===1){let h=hr(n),f=h.includes("delete.backward")||h.includes("delete.selection.backward"),d=h.includes("delete.group"),m=h.includes("delete.selection"),v=0;for(let S of r){let N=Ji(S,u,v,n.startState.doc,f,d,m,n.startState);l.push(...N.changes),a.push(N.selection),v=N.offset}}else if(o===2){let h=0;for(let f of r){let d=Qi(f,u,h,n.startState.doc);l.push(...d.changes),a.push(d.selection),h=d.offset}}return n.startState.update({changes:l,selection:vi.EditorSelection.create(a),userEvent:"ignore"})}else if(za("select",e)&&cr(n)&&t.alternative_cursor_movement){if(e.includes("select.pointer"))return n;let r=n.startState.field(vt).nodes,s=e.includes("select.backward"),o=e.includes("select.group"),u=e.includes("select.extend"),l=[];for(let[a,h]of n.selection.ranges.entries()){let f=Yi(h,n.startState.selection.ranges[a],r,n.startState,s,o,u,i);l.push(f.selection)}return n.startState.update({selection:vi.EditorSelection.create(l),filter:!1})}return n}var du=require("@codemirror/view"),De=require("@codemirror/state");var pu=De.Prec.high(du.EditorView.inputHandler.of((n,t,e,i)=>{let r=n.state.doc.sliceString(t-2,t)+i,s;if((s=Gs[r])!==void 0){let o=[{from:t,to:e+1,insert:i+s.join("")}];return n.dispatch({changes:o,selection:De.EditorSelection.cursor(e+1)}),!0}return!1})),mu=De.EditorState.transactionFilter.of(n=>{if(n.isUserEvent("select")){let t=n.startState.selection.main,e=n.selection.main;if(e.anchor===e.head){let i=n.startState.field(vt).nodes,r=i.at_cursor(t.head),s=i.at_cursor(e.head);if(r&&r!==s&&(r.type===2||r.type===3)){let o=r.unwrap(),u=!1,l=0,a=o.search(/\S/);a>=1&&(u=!0,o=o.slice(a),l+=a);let h=o.match(/\n\s*\n/g);if(h&&(u=!0,o=o.replace(/\n\s*\n/g,`
`),l+=h.reduce((f,d)=>f+d.length,0)),u)return{changes:[{from:r.from+3,to:r.to-3,insert:o}],selection:De.EditorSelection.cursor(e.head-l)}}}}return n});var bu=require("obsidian"),an=require("@codemirror/state"),Ze=require("@codemirror/view");var Br=class extends Ze.GutterMarker{constructor(e,i,r){super();this.type=e;this.top=i;this.bottom=r}toDOM(){let e="";return this.type.has(0)&&(e+="criticmarkup-gutter-addition "),this.type.has(1)&&(e+="criticmarkup-gutter-deletion "),this.type.has(2)&&(e+="criticmarkup-gutter-substitution "),this.top&&(e+="criticmarkup-gutter-top "),this.bottom&&(e+="criticmarkup-gutter-bottom "),createDiv({cls:e})}},gu=Ze.ViewPlugin.fromClass(class{markers=an.RangeSet.empty;constructMarkers(t){let e=t.state.field(vt).nodes,i=new an.RangeSetBuilder,r={};for(let s of e.nodes){if(!t.visibleRanges.some(a=>s.partially_in_range(a.from,a.to)))continue;let o=t.state.doc.lineAt(s.from).number,u=t.state.doc.lineAt(s.to).number,l=Array.from({length:u-o+1},(a,h)=>o+h);r[o]?r[o].isStart=!0:r[o]={isStart:!0,isEnd:!1,types:new Set};for(let a of l)r[a]?(r[a].isEnd=!1,r[a].types.add(s.type)):r[a]={isStart:!1,isEnd:!1,types:new Set([s.type])};r[u]&&(r[u].isEnd=!0)}for(let[s,o]of Object.entries(r)){let u=t.state.doc.line(Number(s));i.add(u.from,u.to,new Br(o.types,o.isStart,o.isEnd))}this.markers=i.finish()}constructor(t){this.constructMarkers(t)}update(t){(t.docChanged||t.viewportChanged||t.heightChanged)&&this.constructMarkers(t.view)}}),vu=n=>[gu,(0,Ze.gutter)({class:"criticmarkup-gutter"+(n.settings.hide_empty_gutter?"":" criticmarkup-gutter-show-empty")+(n.app.vault.getConfig("cssTheme")==="Minimal"?" is-minimal":""),markers:t=>t.plugin(gu).markers,domEventHandlers:{click:(t,e,i)=>{let r=new bu.Menu;return r.addItem(s=>{s.setTitle("Accept changes").setIcon("check").onClick(()=>{t.dispatch({changes:Ye(t.state,e.from,e.to)})})}),r.addItem(s=>{s.setTitle("Reject changes").setIcon("cross").onClick(()=>{t.dispatch({changes:Je(t.state,e.from,e.to)})})}),r.showAtMouseEvent(i),!1}}})];var yu=require("obsidian"),yi=new WeakMap;function xi(n){let t=[{icon:"message-square",tooltip:"Show all suggestions",label:"Showing suggestions"},{icon:"check",tooltip:'Preview "accept all"',label:'Previewing "accept all"'},{icon:"cross",tooltip:'Preview "reject all"',label:'Previewing "reject all"'}];for(let e of app.workspace.getLeavesOfType("markdown")){let i=e.view;if(yi.has(i))continue;let{icon:r,tooltip:s,label:o}=t[n.settings.preview_mode],u=i.addAction(r,s,()=>{n.settings.preview_mode=(n.settings.preview_mode+1)%t.length;let{icon:a,tooltip:h,label:f}=t[n.settings.preview_mode];(0,yu.setIcon)(u,a),u.setAttribute("aria-label",h),l.innerText=f,n.saveSettings()}),l=u.createSpan({text:o,cls:"criticmarkup-suggestion-status"});u.parentElement.insertBefore(l,u),yi.set(i,{button:u,status:l})}}async function Lr(){for(let n of app.workspace.getLeavesOfType("markdown")){let t=n.view;if(!yi.has(t))continue;let e=yi.get(t);e&&(e.button.detach(),e.status.detach()),yi.delete(t)}}var xu=require("obsidian"),Re=new WeakMap,wu=[{icon:"file-edit",tooltip:"Directly edit document",label:"Editing"},{icon:"edit",tooltip:"Mark edits as suggestions",label:"Suggesting"}];function wi(n){for(let t of app.workspace.getLeavesOfType("markdown")){let e=t.view;if(Re.has(e))continue;let{icon:i,tooltip:r,label:s}=wu[+n.settings.suggest_mode],o=e.addAction(i,r,()=>{n.settings.suggest_mode=!n.settings.suggest_mode,zr(n),n.saveSettings()}),u=o.createSpan({text:s,cls:"criticmarkup-suggestion-status"});o.parentElement.insertBefore(u,o),Re.set(e,{button:o,status:u})}}async function zr(n){for(let t of app.workspace.getLeavesOfType("markdown")){let e=t.view;if(!Re.has(e))continue;let i=Re.get(e);if(i){let{icon:r,tooltip:s,label:o}=wu[+n.settings.suggest_mode];(0,xu.setIcon)(i.button,r),i.button.setAttribute("aria-label",s),i.status.innerText=o}}}async function Fr(){for(let n of app.workspace.getLeavesOfType("markdown")){let t=n.view;if(!Re.has(t))continue;let e=Re.get(t);e&&(e.button.detach(),e.status.detach()),Re.delete(t)}}function ku(n,t){let e=Object.keys(t).map(i=>Ha(n,i,t[i]));return e.length===1?e[0]:function(){e.forEach(i=>i())}}function Ha(n,t,e){let i=n[t],r=n.hasOwnProperty(t),s=e(i);return i&&Object.setPrototypeOf(s,i),Object.setPrototypeOf(o,s),n[t]=o,u;function o(...l){return s===i&&n[t]===o&&u(),s.apply(this,l)}function u(){n[t]===o&&(r?n[t]=i:delete n[t]),s!==i&&(s=i,Object.setPrototypeOf(o,i||Function))}}var ol=require("obsidian");function lt(){}function Ct(n,t){for(let e in t)n[e]=t[e];return n}function Hr(n){return n()}function hn(){return Object.create(null)}function Nt(n){n.forEach(Hr)}function he(n){return typeof n=="function"}function at(n,t){return n!=n?t==t:n!==t||n&&typeof n=="object"||typeof n=="function"}function _u(n){return Object.keys(n).length===0}function ye(n,t,e,i){if(n){let r=Su(n,t,e,i);return n[0](r)}}function Su(n,t,e,i){return n[1]&&i?Ct(e.ctx.slice(),n[1](i(t))):e.ctx}function xe(n,t,e,i){if(n[2]&&i){let r=n[2](i(e));if(t.dirty===void 0)return r;if(typeof r=="object"){let s=[],o=Math.max(t.dirty.length,r.length);for(let u=0;u<o;u+=1)s[u]=t.dirty[u]|r[u];return s}return t.dirty|r}return t.dirty}function we(n,t,e,i,r,s){if(r){let o=Su(t,e,i,s);n.p(o,r)}}function ke(n){if(n.ctx.length>32){let t=[],e=n.ctx.length/32;for(let i=0;i<e;i++)t[i]=-1;return t}return-1}function It(n){let t={};for(let e in n)e[0]!=="$"&&(t[e]=n[e]);return t}function Cu(n){return n&&he(n.destroy)?n.destroy:lt}var Vr=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var cn=class n{_listeners="WeakMap"in Vr?new WeakMap:void 0;_observer=void 0;options;constructor(t){this.options=t}observe(t,e){return this._listeners.set(t,e),this._getObserver().observe(t,this.options),()=>{this._listeners.delete(t),this._observer.unobserve(t)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver(t=>{for(let e of t)n.entries.set(e.target,e),this._listeners.get(e.target)?.(e)}))}};cn.entries="WeakMap"in Vr?new WeakMap:void 0;var Tu=!1;function Au(){Tu=!0}function Ou(){Tu=!1}function ct(n,t){n.appendChild(t)}function K(n,t,e){n.insertBefore(t,e||null)}function W(n){n.parentNode&&n.parentNode.removeChild(n)}function tt(n){return document.createElement(n)}function Ua(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Bt(n){return document.createTextNode(n)}function wt(){return Bt(" ")}function _i(){return Bt("")}function mt(n,t,e,i){return n.addEventListener(t,e,i),()=>n.removeEventListener(t,e,i)}function G(n,t,e){e==null?n.removeAttribute(t):n.getAttribute(t)!==e&&n.setAttribute(t,e)}function Eu(n){return Array.from(n.childNodes)}function te(n,t){t=""+t,n.data!==t&&(n.data=t)}function ee(n,t,e,i){e==null?n.style.removeProperty(t):n.style.setProperty(t,e,i?"important":"")}var fn;function Wa(){if(fn===void 0){fn=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{fn=!0}}return fn}function qr(n,t){getComputedStyle(n).position==="static"&&(n.style.position="relative");let i=tt("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;let r=Wa(),s;return r?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=mt(window,"message",o=>{o.source===i.contentWindow&&t()})):(i.src="about:blank",i.onload=()=>{s=mt(i.contentWindow,"resize",t),t()}),ct(n,i),()=>{(r||s&&i.contentWindow)&&s(),W(i)}}function Lt(n,t,e){n.classList.toggle(t,!!e)}var ki=class{is_svg=!1;e=void 0;n=void 0;t=void 0;a=void 0;constructor(t=!1){this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,i=null){this.e||(this.is_svg?this.e=Ua(e.nodeName):this.e=tt(e.nodeType===11?"TEMPLATE":e.nodeName),this.t=e.tagName!=="TEMPLATE"?e:e.content,this.c(t)),this.i(i)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)K(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(W)}};function Mu(n){let t={};return n.childNodes.forEach(e=>{t[e.slot||"default"]=!0}),t}var _e;function ce(n){_e=n}function Ur(){if(!_e)throw new Error("Function called outside component initialization");return _e}function Be(n){Ur().$$.on_mount.push(n)}function Wr(n){Ur().$$.on_destroy.push(n)}var Le=[];var Gt=[],ti=[],Gr=[],Nu=Promise.resolve(),Kr=!1;function Yr(){Kr||(Kr=!0,Nu.then(mn))}function dn(){return Yr(),Nu}function Se(n){ti.push(n)}function pn(n){Gr.push(n)}var jr=new Set,$e=0;function mn(){if($e!==0)return;let n=_e;do{try{for(;$e<Le.length;){let t=Le[$e];$e++,ce(t),Qa(t.$$)}}catch(t){throw Le.length=0,$e=0,t}for(ce(null),Le.length=0,$e=0;Gt.length;)Gt.pop()();for(let t=0;t<ti.length;t+=1){let e=ti[t];jr.has(e)||(jr.add(e),e())}ti.length=0}while(Le.length);for(;Gr.length;)Gr.pop()();Kr=!1,jr.clear(),ce(n)}function Qa(n){if(n.fragment!==null){n.update(),Nt(n.before_update);let t=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,t),n.after_update.forEach(Se)}}function Pu(n){let t=[],e=[];ti.forEach(i=>n.indexOf(i)===-1?t.push(i):e.push(i)),e.forEach(i=>i()),ti=t}var gn=new Set,ze;function Ht(){ze={r:0,c:[],p:ze}}function Vt(){ze.r||Nt(ze.c),ze=ze.p}function j(n,t){n&&n.i&&(gn.delete(n),n.i(t))}function Y(n,t,e,i){if(n&&n.o){if(gn.has(n))return;gn.add(n),ze.c.push(()=>{gn.delete(n),i&&(e&&n.d(1),i())}),n.o(t)}else i&&i()}function Ce(n){return n?.length!==void 0?n:Array.from(n)}function Du(n,t){Y(n,1,1,()=>{t.delete(n.key)})}function Ru(n,t,e,i,r,s,o,u,l,a,h,f){let d=n.length,m=s.length,v=d,S={};for(;v--;)S[n[v].key]=v;let N=[],M=new Map,B=new Map,R=[];for(v=m;v--;){let k=f(r,s,v),C=e(k),T=o.get(C);T?i&&R.push(()=>T.p(k,t)):(T=a(C,k),T.c()),M.set(C,N[v]=T),C in S&&B.set(C,Math.abs(v-S[C]))}let A=new Set,O=new Set;function g(k){j(k,1),k.m(u,h),o.set(k.key,k),h=k.first,m--}for(;d&&m;){let k=N[m-1],C=n[d-1],T=k.key,_=C.key;k===C?(h=k.first,d--,m--):M.has(_)?!o.has(T)||A.has(T)?g(k):O.has(_)?d--:B.get(T)>B.get(_)?(O.add(T),g(k)):(A.add(_),d--):(l(C,o),d--)}for(;d--;){let k=n[d];M.has(k.key)||l(k,o)}for(;m;)g(N[m-1]);return Nt(R),N}var Xa=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Za=new Set([...Xa]);function bn(n,t,e){let i=n.$$.props[t];i!==void 0&&(n.$$.bound[i]=e,e(n.$$.ctx[i]))}function Tt(n){n&&n.c()}function kt(n,t,e){let{fragment:i,after_update:r}=n.$$;i&&i.m(t,e),Se(()=>{let s=n.$$.on_mount.map(Hr).filter(he);n.$$.on_destroy?n.$$.on_destroy.push(...s):Nt(s),n.$$.on_mount=[]}),r.forEach(Se)}function _t(n,t){let e=n.$$;e.fragment!==null&&(Pu(e.after_update),Nt(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function th(n,t){n.$$.dirty[0]===-1&&(Le.push(n),Yr(),n.$$.dirty.fill(0)),n.$$.dirty[t/31|0]|=1<<t%31}function ft(n,t,e,i,r,s,o,u=[-1]){let l=_e;ce(n);let a=n.$$={fragment:null,ctx:[],props:s,update:lt,not_equal:r,bound:hn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:hn(),dirty:u,skip_bound:!1,root:t.target||l.$$.root};o&&o(a.root);let h=!1;if(a.ctx=e?e(n,t.props||{},(f,d,...m)=>{let v=m.length?m[0]:d;return a.ctx&&r(a.ctx[f],a.ctx[f]=v)&&(!a.skip_bound&&a.bound[f]&&a.bound[f](v),h&&th(n,f)),d}):[],a.update(),h=!0,Nt(a.before_update),a.fragment=i?i(a.ctx):!1,t.target){if(t.hydrate){Au();let f=Eu(t.target);a.fragment&&a.fragment.l(f),f.forEach(W)}else a.fragment&&a.fragment.c();t.intro&&j(n.$$.fragment),kt(n,t.target,t.anchor),Ou(),mn()}ce(l)}var eh;typeof HTMLElement=="function"&&(eh=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(n,t,e){super(),this.$$ctor=n,this.$$s=t,e&&this.attachShadow({mode:"open"})}addEventListener(n,t,e){if(this.$$l[n]=this.$$l[n]||[],this.$$l[n].push(t),this.$$c){let i=this.$$c.$on(n,t);this.$$l_u.set(t,i)}super.addEventListener(n,t,e)}removeEventListener(n,t,e){if(super.removeEventListener(n,t,e),this.$$c){let i=this.$$l_u.get(t);i&&(i(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let n=function(r){return()=>{let s;return{c:function(){s=tt("slot"),r!=="default"&&G(s,"name",r)},m:function(l,a){K(l,s,a)},d:function(l){l&&W(s)}}}};if(await Promise.resolve(),!this.$$cn)return;let t={},e=Mu(this);for(let r of this.$$s)r in e&&(t[r]=[n(r)]);for(let r of this.attributes){let s=this.$$g_p(r.name);s in this.$$d||(this.$$d[s]=Jr(s,r.value,this.$$p_d,"toProp"))}this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:t,$$scope:{ctx:[]}}});let i=()=>{this.$$r=!0;for(let r in this.$$p_d)if(this.$$d[r]=this.$$c.$$.ctx[this.$$c.$$.props[r]],this.$$p_d[r].reflect){let s=Jr(r,this.$$d[r],this.$$p_d,"toAttribute");s==null?this.removeAttribute(r):this.setAttribute(this.$$p_d[r].attribute||r,s)}this.$$r=!1};this.$$c.$$.after_update.push(i),i();for(let r in this.$$l)for(let s of this.$$l[r]){let o=this.$$c.$on(r,s);this.$$l_u.set(s,o)}this.$$l={}}}attributeChangedCallback(n,t,e){this.$$r||(n=this.$$g_p(n),this.$$d[n]=Jr(n,e,this.$$p_d,"toProp"),this.$$c?.$set({[n]:this.$$d[n]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(n){return Object.keys(this.$$p_d).find(t=>this.$$p_d[t].attribute===n||!this.$$p_d[t].attribute&&t.toLowerCase()===n)||n}});function Jr(n,t,e,i){let r=e[n]?.type;if(t=r==="Boolean"&&typeof t!="boolean"?t!=null:t,!i||!e[n])return t;if(i==="toAttribute")switch(r){case"Object":case"Array":return t==null?null:JSON.stringify(t);case"Boolean":return t?"":null;case"Number":return t??null;default:return t}else switch(r){case"Object":case"Array":return t&&JSON.parse(t);case"Boolean":return t;case"Number":return t!=null?+t:t;default:return t}}var ot=class{$$=void 0;$$set=void 0;$destroy(){_t(this,1),this.$destroy=lt}$on(t,e){if(!he(e))return lt;let i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{let r=i.indexOf(e);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!_u(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}};var Bu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Bu);function Lu(n){let t,e;return{c(){t=tt("div"),e=Bt(n[0])},m(i,r){K(i,t,r),ct(t,e)},p(i,r){r&1&&te(e,i[0])},d(i){i&&W(t)}}}function zu(n){let t,e;return t=new Kt({props:{icon:n[1],size:n[3]}}),{c(){Tt(t.$$.fragment)},m(i,r){kt(t,i,r),e=!0},p(i,r){let s={};r&2&&(s.icon=i[1]),r&8&&(s.size=i[3]),t.$set(s)},i(i){e||(j(t.$$.fragment,i),e=!0)},o(i){Y(t.$$.fragment,i),e=!1},d(i){_t(t,i)}}}function ih(n){let t,e,i,r,s,o,u=n[0]&&Lu(n),l=n[1]&&zu(n);return{c(){t=tt("button"),u&&u.c(),e=wt(),l&&l.c(),G(t,"class",i=n[5].class),G(t,"aria-label",n[2]),Lt(t,"svelcomlib-icon-text",n[1])},m(a,h){K(a,t,h),u&&u.m(t,null),ct(t,e),l&&l.m(t,null),r=!0,s||(o=mt(t,"click",function(){he(n[4])&&n[4].apply(this,arguments)}),s=!0)},p(a,[h]){n=a,n[0]?u?u.p(n,h):(u=Lu(n),u.c(),u.m(t,e)):u&&(u.d(1),u=null),n[1]?l?(l.p(n,h),h&2&&j(l,1)):(l=zu(n),l.c(),j(l,1),l.m(t,null)):l&&(Ht(),Y(l,1,1,()=>{l=null}),Vt()),(!r||h&32&&i!==(i=n[5].class))&&G(t,"class",i),(!r||h&4)&&G(t,"aria-label",n[2]),(!r||h&34)&&Lt(t,"svelcomlib-icon-text",n[1])},i(a){r||(j(l),r=!0)},o(a){Y(l),r=!1},d(a){a&&W(t),u&&u.d(),l&&l.d(),s=!1,o()}}}function nh(n,t,e){let{text:i=""}=t,{icon:r=""}=t,{tooltip:s=""}=t,{size:o=null}=t,{onClick:u}=t;return n.$$set=l=>{e(5,t=Ct(Ct({},t),It(l))),"text"in l&&e(0,i=l.text),"icon"in l&&e(1,r=l.icon),"tooltip"in l&&e(2,s=l.tooltip),"size"in l&&e(3,o=l.size),"onClick"in l&&e(4,u=l.onClick)},t=It(t),[i,r,s,o,u,t]}var Qr=class extends ot{constructor(t){super(),ft(this,t,nh,ih,at,{text:0,icon:1,tooltip:2,size:3,onClick:4})}},vn=Qr;var Hu=require("obsidian");function rh(n){let t,e=n[0].outerHTML+"",i;return{c(){t=new ki(!1),i=_i(),t.a=i},m(r,s){t.m(e,r,s),K(r,i,s)},p(r,[s]){s&1&&e!==(e=r[0].outerHTML+"")&&t.p(e)},i:lt,o:lt,d(r){r&&(W(i),t.d())}}}function sh(n,t,e){let{icon:i}=t,{size:r=null}=t,{stroke_width:s=null}=t,o=null;return n.$$set=u=>{e(4,t=Ct(Ct({},t),It(u))),"icon"in u&&e(1,i=u.icon),"size"in u&&e(2,r=u.size),"stroke_width"in u&&e(3,s=u.stroke_width)},n.$$.update=()=>{i.startsWith("<svg")?e(0,o=new DOMParser().parseFromString(i,"text/html").body.childNodes[0]):e(0,o=(0,Hu.getIcon)(i)),t.class&&o.classList.add(...t.class.split(" ")),n.$$.dirty&5&&o&&r&&(typeof r=="number"?(e(0,o.style.width=r+"px",o),e(0,o.style.height=r+"px",o)):Array.isArray(r)?(e(0,o.style.width=r[0]+"px",o),e(0,o.style.height=r[1]+"px",o)):(e(0,o.style.width=`var(--${r})`,o),e(0,o.style.height=`var(--${r})`,o))),n.$$.dirty&9&&o&&s&&e(0,o.style.strokeWidth=s+"px",o)},t=It(t),[o,i,r,s]}var Xr=class extends ot{constructor(t){super(),ft(this,t,sh,rh,at,{icon:1,size:2,stroke_width:3})}},Kt=Xr;function oh(n){let t,e,i,r;return{c(){t=tt("input"),G(t,"type",n[0]),t.value=n[1],G(t,"placeholder",n[2]),t.readOnly=n[5],G(t,"class",e=n[6].class),Lt(t,"svelcomlib-input-success",n[4]),Lt(t,"svelcomlib-input-fail",n[4]===!1)},m(s,o){K(s,t,o),i||(r=mt(t,"input",n[7]),i=!0)},p(s,[o]){o&1&&G(t,"type",s[0]),o&2&&t.value!==s[1]&&(t.value=s[1]),o&4&&G(t,"placeholder",s[2]),o&32&&(t.readOnly=s[5]),o&64&&e!==(e=s[6].class)&&G(t,"class",e),o&80&&Lt(t,"svelcomlib-input-success",s[4]),o&80&&Lt(t,"svelcomlib-input-fail",s[4]===!1)},i:lt,o:lt,d(s){s&&W(t),i=!1,r()}}}function uh(n,t,e){let{type:i}=t,{value:r}=t,{placeholder:s=""}=t,{onChange:o=()=>{}}=t,{valid:u=!1}=t,{readonly:l=!1}=t,a=h=>o(h.target.value);return n.$$set=h=>{e(6,t=Ct(Ct({},t),It(h))),"type"in h&&e(0,i=h.type),"value"in h&&e(1,r=h.value),"placeholder"in h&&e(2,s=h.placeholder),"onChange"in h&&e(3,o=h.onChange),"valid"in h&&e(4,u=h.valid),"readonly"in h&&e(5,l=h.readonly)},t=It(t),[i,r,s,o,u,l,t,a]}var Zr=class extends ot{constructor(t){super(),ft(this,t,uh,oh,at,{type:0,value:1,placeholder:2,onChange:3,valid:4,readonly:5})}},yn=Zr;function Vu(n){let t,e;return t=new Kt({props:{icon:n[1][n[0]].icon,size:n[2]}}),{c(){Tt(t.$$.fragment)},m(i,r){kt(t,i,r),e=!0},p(i,r){let s={};r&3&&(s.icon=i[1][i[0]].icon),r&4&&(s.size=i[2]),t.$set(s)},i(i){e||(j(t.$$.fragment,i),e=!0)},o(i){Y(t.$$.fragment,i),e=!1},d(i){_t(t,i)}}}function qu(n){let t=n[1][n[0]].text+"",e;return{c(){e=Bt(t)},m(i,r){K(i,e,r)},p(i,r){r&3&&t!==(t=i[1][i[0]].text+"")&&te(e,t)},d(i){i&&W(e)}}}function lh(n){let t,e,i,r,s,o,u,l=n[1][n[0]].icon&&Vu(n),a=n[1][n[0]].text&&qu(n);return{c(){t=tt("div"),l&&l.c(),e=wt(),a&&a.c(),G(t,"class",i=n[5].class+" svelcomlib-icon-text"),G(t,"aria-label",r=n[1][n[0]].tooltip)},m(h,f){K(h,t,f),l&&l.m(t,null),ct(t,e),a&&a.m(t,null),s=!0,o||(u=[mt(t,"click",n[6]),mt(t,"contextmenu",function(){he(n[4])&&n[4].apply(this,arguments)})],o=!0)},p(h,[f]){n=h,n[1][n[0]].icon?l?(l.p(n,f),f&3&&j(l,1)):(l=Vu(n),l.c(),j(l,1),l.m(t,e)):l&&(Ht(),Y(l,1,1,()=>{l=null}),Vt()),n[1][n[0]].text?a?a.p(n,f):(a=qu(n),a.c(),a.m(t,null)):a&&(a.d(1),a=null),(!s||f&32&&i!==(i=n[5].class+" svelcomlib-icon-text"))&&G(t,"class",i),(!s||f&3&&r!==(r=n[1][n[0]].tooltip))&&G(t,"aria-label",r)},i(h){s||(j(l),s=!0)},o(h){Y(l),s=!1},d(h){h&&W(t),l&&l.d(),a&&a.d(),o=!1,Nt(u)}}}function ah(n,t,e){let{states:i}=t,{value:r=0}=t,{size:s=null}=t,{onClick:o=()=>{}}=t,{onContextMenu:u=()=>{}}=t,l=()=>{e(0,r=(r+1)%i.length),o()};return n.$$set=a=>{e(5,t=Ct(Ct({},t),It(a))),"states"in a&&e(1,i=a.states),"value"in a&&e(0,r=a.value),"size"in a&&e(2,s=a.size),"onClick"in a&&e(3,o=a.onClick),"onContextMenu"in a&&e(4,u=a.onContextMenu)},t=It(t),[r,i,s,o,u,t,l]}var $r=class extends ot{constructor(t){super(),ft(this,t,ah,lh,at,{states:1,value:0,size:2,onClick:3,onContextMenu:4})}},ei=$r;function Wu(n,t,e){let i=n.slice();return i[23]=t[e],i}var hh=n=>({item:n&16,index:n&16}),ju=n=>({item:n[23].data,index:n[23].index});function ch(n){let t;return{c(){t=Bt("Missing template")},m(e,i){K(e,t,i)},d(e){e&&W(t)}}}function Gu(n,t){let e,i,r,s=t[15].default,o=ye(s,t,t[14],ju),u=o||ch(t);return{key:n,first:null,c(){e=tt("div"),u&&u.c(),i=wt(),G(e,"class","svelcomlib-virtual-list-row"),this.first=e},m(l,a){K(l,e,a),u&&u.m(e,null),ct(e,i),r=!0},p(l,a){t=l,o&&o.p&&(!r||a&16400)&&we(o,s,t,t[14],r?xe(s,t[14],a,hh):ke(t[14]),ju)},i(l){r||(j(u,l),r=!0)},o(l){Y(u,l),r=!1},d(l){l&&W(e),u&&u.d(l)}}}function fh(n){let t,e,i=[],r=new Map,s,o,u,l,a=Ce(n[4]),h=f=>f[23].index;for(let f=0;f<a.length;f+=1){let d=Wu(n,a,f),m=h(d);r.set(m,i[f]=Gu(m,d))}return{c(){t=tt("div"),e=tt("div");for(let f=0;f<i.length;f+=1)i[f].c();G(e,"class","svelcomlib-virtual-list-contents"),ee(e,"padding-top",n[5]+"px"),ee(e,"padding-bottom",n[6]+"px"),G(t,"class","svelcomlib-virtual-list-viewport"),ee(t,"height",n[0]),Se(()=>n[18].call(t))},m(f,d){K(f,t,d),ct(t,e);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(e,null);n[16](e),n[17](t),s=qr(t,n[18].bind(t)),o=!0,u||(l=mt(t,"scroll",n[7]),u=!0)},p(f,[d]){d&16400&&(a=Ce(f[4]),Ht(),i=Ru(i,d,h,1,f,a,r,e,Du,Gu,null,Wu),Vt()),(!o||d&32)&&ee(e,"padding-top",f[5]+"px"),(!o||d&64)&&ee(e,"padding-bottom",f[6]+"px"),(!o||d&1)&&ee(t,"height",f[0])},i(f){if(!o){for(let d=0;d<a.length;d+=1)j(i[d]);o=!0}},o(f){for(let d=0;d<i.length;d+=1)Y(i[d]);o=!1},d(f){f&&W(t);for(let d=0;d<i.length;d+=1)i[d].d();n[16](null),n[17](null),s(),u=!1,l()}}}function dh(n,t,e){let{$$slots:i={},$$scope:r}=t,{items:s}=t,{height:o="100%"}=t,{itemHeight:u=void 0}=t,{start:l=0}=t,{end:a=0}=t,h=[],f,d,m,v=0,S,N,M=0,B=0,R;async function A(_,I,H){_.length<l&&await g(_.length-1,{behavior:"auto"});let{scrollTop:J}=d;await dn();let it=M-J,Q=l;for(;it<I&&Q<_.length;){let nt=f[Q-l];nt||(e(9,a=Q+1),await dn(),nt=f[Q-l]);let rt=h[Q]=H||nt.offsetHeight;it+=rt,Q+=1}e(9,a=Q);let zt=_.length-a;R=(M+it)/a,e(6,B=zt*R),h.length=_.length}async function O(){let{scrollTop:_}=d;for(let J=0;J<f.length;J+=1)h[l+J]=u||f[J].offsetHeight;let I=0,H=0;for(;I<s.length;){let J=h[I]||R;if(H+J>_){e(8,l=I),e(5,M=H);break}H+=J,I+=1}for(;I<s.length&&(H+=h[I]||R,I+=1,!(H>_+v)););e(9,a=I);let V=s.length-a;for(R=H/a;I<s.length;)h[I++]=R;e(6,B=V*R)}async function g(_,I){let{scrollTop:H}=d,it=(_-l)*(u||R);I={left:0,top:H+it,behavior:"smooth",...I},d.scrollTo(I)}Be(()=>{f=m.getElementsByClassName("svelcomlib-virtual-list-row"),e(13,N=!0)});function k(_){Gt[_?"unshift":"push"](()=>{m=_,e(3,m)})}function C(_){Gt[_?"unshift":"push"](()=>{d=_,e(2,d)})}function T(){v=this.offsetHeight,e(1,v)}return n.$$set=_=>{"items"in _&&e(10,s=_.items),"height"in _&&e(0,o=_.height),"itemHeight"in _&&e(11,u=_.itemHeight),"start"in _&&e(8,l=_.start),"end"in _&&e(9,a=_.end),"$$scope"in _&&e(14,r=_.$$scope)},n.$$.update=()=>{n.$$.dirty&1792&&e(4,S=s.slice(l,a).map((_,I)=>({index:I+l,data:_}))),n.$$.dirty&11266&&N&&A(s,v,u)},[o,v,d,m,S,M,B,O,l,a,s,u,g,N,r,i,k,C,T]}var ts=class extends ot{constructor(t){super(),ft(this,t,dh,fh,at,{items:10,height:0,itemHeight:11,start:8,end:9,scrollToIndex:12})}get scrollToIndex(){return this.$$.ctx[12]}},xn=ts;var wh=n=>({}),Ku=n=>({});function kh(n){let t,e,i,r=n[1].container,s=ye(r,n,n[0],Ku);return{c(){t=tt("div"),e=tt("div"),s&&s.c(),G(e,"class","nav-buttons-container"),G(t,"class","nav-header")},m(o,u){K(o,t,u),ct(t,e),s&&s.m(e,null),i=!0},p(o,[u]){s&&s.p&&(!i||u&1)&&we(s,r,o,o[0],i?xe(r,o[0],u,wh):ke(o[0]),Ku)},i(o){i||(j(s,o),i=!0)},o(o){Y(s,o),i=!1},d(o){o&&W(t),s&&s.d(o)}}}function _h(n,t,e){let{$$slots:i={},$$scope:r}=t;return n.$$set=s=>{"$$scope"in s&&e(0,r=s.$$scope)},[r,i]}var es=class extends ot{constructor(t){super(),ft(this,t,_h,kh,at,{})}},wn=es;var kn=require("obsidian");function Sh(n){let t;return{c(){t=tt("div")},m(e,i){K(e,t,i),n[3](t)},p:lt,i:lt,o:lt,d(e){e&&W(t),n[3](null)}}}function Ch(n,t,e){let{plugin:i}=t,{text:r}=t,s;Be(async()=>{let u=new kn.Component;await kn.MarkdownRenderer.render(i.app,r,s,"",u),u.load()});function o(u){Gt[u?"unshift":"push"](()=>{s=u,e(0,s)})}return n.$$set=u=>{"plugin"in u&&e(1,i=u.plugin),"text"in u&&e(2,r=u.text)},[s,i,r,o]}var is=class extends ot{constructor(t){super(),ft(this,t,Ch,Sh,at,{plugin:1,text:2})}},Si=is;var Th=n=>({class:n&1}),Yu=n=>({class:n[0].class}),Ah=n=>({class:n&1}),Ju=n=>({class:n[0].class});function Oh(n){let t,e,i=n[2].header,r=ye(i,n,n[1],Ju),s=n[2].view,o=ye(s,n,n[1],Yu);return{c(){r&&r.c(),t=wt(),o&&o.c()},m(u,l){r&&r.m(u,l),K(u,t,l),o&&o.m(u,l),e=!0},p(u,[l]){r&&r.p&&(!e||l&3)&&we(r,i,u,u[1],e?xe(i,u[1],l,Ah):ke(u[1]),Ju),o&&o.p&&(!e||l&3)&&we(o,s,u,u[1],e?xe(s,u[1],l,Th):ke(u[1]),Yu)},i(u){e||(j(r,u),j(o,u),e=!0)},o(u){Y(r,u),Y(o,u),e=!1},d(u){u&&W(t),r&&r.d(u),o&&o.d(u)}}}function Eh(n,t,e){let{$$slots:i={},$$scope:r}=t;return n.$$set=s=>{e(0,t=Ct(Ct({},t),It(s))),"$$scope"in s&&e(1,r=s.$$scope)},t=It(t),[t,r,i]}var ns=class extends ot{constructor(t){super(),ft(this,t,Eh,Oh,at,{})}},_n=ns;function Sn(n,t){let e=i=>{let r=i.target;!i.target||t&&r.closest(t)||n&&!n.contains(r)&&!i.defaultPrevented&&n.dispatchEvent(new CustomEvent("click_outside"))};return document.addEventListener("click",e,!0),{destroy(){document.removeEventListener("click",e,!0)}}}var Yt=require("obsidian");var ii=Vn(Cn()),el=Vn(Zu()),il=Vn(tl()),ie=require("obsidian");function ss(n){let t=new Blob([n],{type:"text/javascript"}),e=URL.createObjectURL(t),i=new Worker(e,{name:"Commentator Indexer"});return URL.revokeObjectURL(e),i}function os(){return ss('var Hh=Object.defineProperty;var zh=(s,t,e)=>t in s?Hh(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var zi=(s,t,e)=>(zh(s,typeof t!="symbol"?t+"":t,e),e);var _h=0;var W=class{constructor(t={}){this.id=_h++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn\'t define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can\'t add per-node props to node types");return typeof t!="function"&&(t=Wt.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}};W.closedBy=new W({deserialize:s=>s.split(" ")});W.openedBy=new W({deserialize:s=>s.split(" ")});W.group=new W({deserialize:s=>s.split(" ")});W.contextHash=new W({perNode:!0});W.lookAhead=new W({perNode:!0});W.mounted=new W({perNode:!0});var Vh=Object.create(null),Wt=class s{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):Vh,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),n=new s(t.name||"",e,t.id,i);if(t.props){for(let r of t.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can\'t store a per-node prop on a node type");e[r[0].id]=r[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(W.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return i=>{for(let n=i.prop(W.group),r=-1;r<(n?n.length:0);r++){let o=e[r<0?i.name:n[r]];if(o)return o}}}};Wt.none=new Wt("",Object.create(null),0,8);var _i=new WeakMap,to=new WeakMap,it;(function(s){s[s.ExcludeBuffers=1]="ExcludeBuffers",s[s.IncludeAnonymous=2]="IncludeAnonymous",s[s.IgnoreMounts=4]="IgnoreMounts",s[s.IgnoreOverlays=8]="IgnoreOverlays"})(it||(it={}));var Vt=class s{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,l]of r)this.props[typeof o=="number"?o:o.id]=l}}toString(){let t=this.prop(W.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let n=i.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new Ee(this.topNode,t)}cursorAt(t,e=0,i=0){let n=_i.get(this)||this.topNode,r=new Ee(n);return r.moveTo(t,e),_i.set(this,r._tree),r}get topNode(){return new ue(this,0,0,null)}resolve(t,e=0){let i=De(_i.get(this)||this.topNode,t,e,!1);return _i.set(this,i),i}resolveInner(t,e=0){let i=De(to.get(this)||this.topNode,t,e,!0);return to.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t,o=t.mode||0,l=(o&it.IncludeAnonymous)>0;for(let h=this.cursor(o|it.IncludeAnonymous);;){let a=!1;if(h.from<=r&&h.to>=n&&(!l&&h.type.isAnonymous||e(h)!==!1)){if(h.firstChild())continue;a=!0}for(;a&&i&&(l||!h.type.isAnonymous)&&i(h),!h.nextSibling();){if(!h.parent())return;a=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:hs(Wt.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,n)=>new s(this.type,e,i,n,this.propValues),t.makeTree||((e,i,n)=>new s(Wt.none,e,i,n)))}static build(t){return Wh(t)}};Vt.empty=new Vt(Wt.none,[],[],0);var rs=class s{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new s(this.buffer,this.index)}},fe=class s{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return Wt.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),t+=4,i==t)return r;let o=[];for(;t<i;)o.push(this.childString(t)),t=this.buffer[t+3];return r+"("+o.join(",")+")"}findChild(t,e,i,n,r){let{buffer:o}=this,l=-1;for(let h=t;h!=e&&!(io(r,n,o[h+1],o[h+2])&&(l=h,i>0));h=o[h+3]);return l}slice(t,e,i){let n=this.buffer,r=new Uint16Array(e-t),o=0;for(let l=t,h=0;l<e;){r[h++]=n[l++],r[h++]=n[l++]-i;let a=r[h++]=n[l++]-i;r[h++]=n[l++]-t,o=Math.max(o,a)}return new s(r,o,this.set)}};function io(s,t,e,i){switch(s){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function no(s,t){let e=s.childBefore(t);for(;e;){let i=e.lastChild;if(!i||i.to!=e.to)break;i.type.isError&&i.from==i.to?(s=e,e=i.prevSibling):e=i}return s}function De(s,t,e,i){for(var n;s.from==s.to||(e<1?s.from>=t:s.from>t)||(e>-1?s.to<=t:s.to<t);){let o=!i&&s instanceof ue&&s.index<0?null:s.parent;if(!o)return s;s=o}let r=i?0:it.IgnoreOverlays;if(i)for(let o=s,l=o.parent;l;o=l,l=o.parent)o instanceof ue&&o.index<0&&((n=l.enter(t,e,r))===null||n===void 0?void 0:n.from)!=o.from&&(s=l);for(;;){let o=s.enter(t,e,r);if(!o)return s;s=o}}var ue=class s{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let o=this;;){for(let{children:l,positions:h}=o._tree,a=e>0?l.length:-1;t!=a;t+=e){let f=l[t],u=h[t]+o.from;if(io(n,i,u,u+f.length)){if(f instanceof fe){if(r&it.ExcludeBuffers)continue;let c=f.findChild(0,f.buffer.length,e,i-u,n);if(c>-1)return new ri(new os(o,f,t,u),null,c)}else if(r&it.IncludeAnonymous||!f.type.isAnonymous||ls(f)){let c;if(!(r&it.IgnoreMounts)&&f.props&&(c=f.prop(W.mounted))&&!c.overlay)return new s(c.tree,u,t,o);let d=new s(f,u,t,o);return r&it.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(e<0?f.children.length-1:0,e,i,n)}}}if(r&it.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?t=o.index+e:t=e<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&it.IgnoreOverlays)&&(n=this._tree.prop(W.mounted))&&n.overlay){let r=t-this.from;for(let{from:o,to:l}of n.overlay)if((e>0?o<=r:o<r)&&(e<0?l>=r:l>r))return new s(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new Ee(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return De(this,t,e,!1)}resolveInner(t,e=0){return De(this,t,e,!0)}enterUnfinishedNodesBefore(t){return no(this,t)}getChild(t,e=null,i=null){let n=Wi(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Wi(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return $i(this,t)}};function Wi(s,t,e,i){let n=s.cursor(),r=[];if(!n.firstChild())return r;if(e!=null){for(;!n.type.is(e);)if(!n.nextSibling())return r}for(;;){if(i!=null&&n.type.is(i))return r;if(n.type.is(t)&&r.push(n.node),!n.nextSibling())return i==null?r:[]}}function $i(s,t,e=t.length-1){for(let i=s.parent;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}var os=class{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}},ri=class s{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new s(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&it.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new s(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new s(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new s(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new Ee(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let o=i.buffer[this.index+1];t.push(i.slice(n,r,o)),e.push(0)}return new Vt(this.type,t,e,this.to-this.from)}resolve(t,e=0){return De(this,t,e,!1)}resolveInner(t,e=0){return De(this,t,e,!0)}enterUnfinishedNodesBefore(t){return no(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=Wi(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return Wi(this,t,e,i)}get node(){return this}matchContext(t){return $i(this,t)}},Ee=class{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof ue)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return t?t instanceof ue?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&it.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&it.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&it.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(e.findChild(n,this.index,-1,0,4))}else{let n=e.buffer[this.index+3];if(n<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(n.buffer.buffer[r+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let r=e+t,o=t<0?-1:i._tree.children.length;r!=o;r+=t){let l=i._tree.children[r];if(this.mode&it.IncludeAnonymous||l instanceof fe||!l.type.isAnonymous||ls(l))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let o=t;o;o=o._parent)if(o.index==n){if(n==this.index)return o;e=o,i=r+1;break t}n=this.stack[--r]}for(let n=i;n<this.stack.length;n++)e=new ri(this.buffer,e,this.stack[n]);return this.bufferNode=new ri(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return $i(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return $i(this.node,t,n);let o=i[e.buffer[this.stack[r]]];if(!o.isAnonymous){if(t[n]&&t[n]!=o.name)return!1;n--}}return!0}};function ls(s){return s.children.some(t=>t instanceof fe||!t.type.isAnonymous||ls(t))}function Wh(s){var t;let{buffer:e,nodeSet:i,maxBufferLength:n=1024,reused:r=[],minRepeatType:o=i.types.length}=s,l=Array.isArray(e)?new rs(e,e.length):e,h=i.types,a=0,f=0;function u(w,S,y,A,I){let{id:O,start:v,end:P,size:N}=l,_=f;for(;N<0;)if(l.next(),N==-1){let tt=r[O];y.push(tt),A.push(v-w);return}else if(N==-3){a=O;return}else if(N==-4){f=O;return}else throw new RangeError(`Unrecognized record size: ${N}`);let dt=h[O],Z,J,ni=v-w;if(P-v<=n&&(J=m(l.pos-S,I))){let tt=new Uint16Array(J.size-J.skip),V=l.pos-J.size,Y=tt.length;for(;l.pos>V;)Y=g(J.start,tt,Y);Z=new fe(tt,P-J.start,i),ni=J.start-w}else{let tt=l.pos-N;l.next();let V=[],Y=[],ot=O>=o?O:-1,pt=0,_t=P;for(;l.pos>tt;)ot>=0&&l.id==ot&&l.size>=0?(l.end<=_t-n&&(d(V,Y,v,pt,l.end,_t,ot,_),pt=V.length,_t=l.end),l.next()):u(v,tt,V,Y,ot);if(ot>=0&&pt>0&&pt<V.length&&d(V,Y,v,pt,v,_t,ot,_),V.reverse(),Y.reverse(),ot>-1&&pt>0){let si=c(dt);Z=hs(dt,V,Y,0,V.length,0,P-v,si,si)}else Z=p(dt,V,Y,P-v,_-P)}y.push(Z),A.push(ni)}function c(w){return(S,y,A)=>{let I=0,O=S.length-1,v,P;if(O>=0&&(v=S[O])instanceof Vt){if(!O&&v.type==w&&v.length==A)return v;(P=v.prop(W.lookAhead))&&(I=y[O]+v.length+P)}return p(w,S,y,A,I)}}function d(w,S,y,A,I,O,v,P){let N=[],_=[];for(;w.length>A;)N.push(w.pop()),_.push(S.pop()+y-I);w.push(p(i.types[v],N,_,O-I,P-O)),S.push(I-y)}function p(w,S,y,A,I=0,O){if(a){let v=[W.contextHash,a];O=O?[v].concat(O):[v]}if(I>25){let v=[W.lookAhead,I];O=O?[v].concat(O):[v]}return new Vt(w,S,y,A,O)}function m(w,S){let y=l.fork(),A=0,I=0,O=0,v=y.end-n,P={size:0,start:0,skip:0};t:for(let N=y.pos-w;y.pos>N;){let _=y.size;if(y.id==S&&_>=0){P.size=A,P.start=I,P.skip=O,O+=4,A+=4,y.next();continue}let dt=y.pos-_;if(_<0||dt<N||y.start<v)break;let Z=y.id>=o?4:0,J=y.start;for(y.next();y.pos>dt;){if(y.size<0)if(y.size==-3)Z+=4;else break t;else y.id>=o&&(Z+=4);y.next()}I=J,A+=_,O+=Z}return(S<0||A==w)&&(P.size=A,P.start=I,P.skip=O),P.size>4?P:void 0}function g(w,S,y){let{id:A,start:I,end:O,size:v}=l;if(l.next(),v>=0&&A<o){let P=y;if(v>4){let N=l.pos-(v-4);for(;l.pos>N;)y=g(w,S,y)}S[--y]=P,S[--y]=O-w,S[--y]=I-w,S[--y]=A}else v==-3?a=A:v==-4&&(f=A);return y}let b=[],D=[];for(;l.pos>0;)u(s.start||0,s.bufferStart||0,b,D,-1);let M=(t=s.length)!==null&&t!==void 0?t:b.length?D[0]+b[0].length:0;return new Vt(h[s.topID],b.reverse(),D.reverse(),M)}var eo=new WeakMap;function Vi(s,t){if(!s.isAnonymous||t instanceof fe||t.type!=s)return 1;let e=eo.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=s||!(i instanceof Vt)){e=1;break}e+=Vi(s,i)}eo.set(t,e)}return e}function hs(s,t,e,i,n,r,o,l,h){let a=0;for(let p=i;p<n;p++)a+=Vi(s,t[p]);let f=Math.ceil(a*1.5/8),u=[],c=[];function d(p,m,g,b,D){for(let M=g;M<b;){let w=M,S=m[M],y=Vi(s,p[M]);for(M++;M<b;M++){let A=Vi(s,p[M]);if(y+A>=f)break;y+=A}if(M==w+1){if(y>f){let A=p[w];d(A.children,A.positions,0,A.children.length,m[w]+D);continue}u.push(p[w])}else{let A=m[M-1]+p[M-1].length-S;u.push(hs(s,p,m,w,M,S,A,null,h))}c.push(S+D-r)}}return d(t,e,i,n,0),(l||h)(u,c,o)}var Ie=class s{constructor(t,e,i,n,r=!1,o=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],i=!1){let n=[new s(0,t.length,t,0,!1,i)];for(let r of e)r.to>t.length&&n.push(r);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,o=t.length?t[0]:null;for(let l=0,h=0,a=0;;l++){let f=l<e.length?e[l]:null,u=f?f.fromA:1e9;if(u-h>=i)for(;o&&o.from<u;){let c=o;if(h>=c.from||u<=c.to||a){let d=Math.max(c.from,h)-a,p=Math.min(c.to,u)-a;c=d>=p?null:new s(d,p,c.tree,c.offset+a,l>0,!!f)}if(c&&n.push(c),o.to>u)break;o=r<t.length?t[r++]:null}if(!f)break;h=f.toA,a=f.toA-f.toB}return n}};var Qf=new W({perNode:!0});var X=class s{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),Be.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let i=[];return this.decompose(t,e,i,0),Be.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new pe(this),r=new pe(t);for(let o=e,l=e;;){if(n.next(o),r.next(o),o=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(l+=n.value.length,n.done||l>=i)return!0}}iter(t=1){return new pe(this,t)}iterRange(t,e=this.length){return new Ui(this,t,e)}iterLines(t,e){let i;if(t==null)i=this.iter();else{e==null&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new Gi(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?s.empty:t.length<=32?new gt(t):Be.from(gt.split(t,[]))}},gt=class s extends X{constructor(t,e=$h(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let r=0;;r++){let o=this.text[r],l=n+o.length;if((e?i:l)>=t)return new us(n,l,i,o);n=l+1,i++}}decompose(t,e,i,n){let r=t<=0&&e>=this.length?this:new s(so(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(n&1){let o=i.pop(),l=Ki(r.text,o.text.slice(),0,r.length);if(l.length<=32)i.push(new s(l,o.length+r.length));else{let h=l.length>>1;i.push(new s(l.slice(0,h)),new s(l.slice(h)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof s))return super.replace(t,e,i);let n=Ki(this.text,Ki(i.text,so(this.text,0,t)),e),r=this.length+i.length-(e-t);return n.length<=32?new s(n,r):Be.from(s.split(n,[]),r)}sliceString(t,e=this.length,i=`\n`){let n="";for(let r=0,o=0;r<=e&&o<this.text.length;o++){let l=this.text[o],h=r+l.length;r>t&&o&&(n+=i),t<h&&e>r&&(n+=l.slice(Math.max(0,t-r),e-r)),r=h+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let r of t)i.push(r),n+=r.length+1,i.length==32&&(e.push(new s(i,n)),i=[],n=-1);return n>-1&&e.push(new s(i,n)),e}},Be=class s extends X{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let i of t)this.lines+=i.lines}lineInner(t,e,i,n){for(let r=0;;r++){let o=this.children[r],l=n+o.length,h=i+o.lines-1;if((e?h:l)>=t)return o.lineInner(t,e,i,n);n=l+1,i=h+1}}decompose(t,e,i,n){for(let r=0,o=0;o<=e&&r<this.children.length;r++){let l=this.children[r],h=o+l.length;if(t<=h&&e>=o){let a=n&((o<=t?1:0)|(h>=e?2:0));o>=t&&h<=e&&!a?i.push(l):l.decompose(t-o,e-o,i,a)}o=h+1}}replace(t,e,i){if(i.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let o=this.children[n],l=r+o.length;if(t>=r&&e<=l){let h=o.replace(t-r,e-r,i),a=this.lines-o.lines+h.lines;if(h.lines<a>>5-1&&h.lines>a>>5+1){let f=this.children.slice();return f[n]=h,new s(f,this.length-(e-t)+i.length)}return super.replace(r,l,h)}r=l+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i=`\n`){let n="";for(let r=0,o=0;r<this.children.length&&o<=e;r++){let l=this.children[r],h=o+l.length;o>t&&r&&(n+=i),t<h&&e>o&&(n+=l.sliceString(t-o,e-o,i)),o=h+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof s))return 0;let i=0,[n,r,o,l]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==o||r==l)return i;let h=this.children[n],a=t.children[r];if(h!=a)return i+h.scanIdentical(a,e);i+=h.length+1}}static from(t,e=t.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let d of t)i+=d.lines;if(i<32){let d=[];for(let p of t)p.flatten(d);return new gt(d,e)}let n=Math.max(32,i>>5),r=n<<1,o=n>>1,l=[],h=0,a=-1,f=[];function u(d){let p;if(d.lines>r&&d instanceof s)for(let m of d.children)u(m);else d.lines>o&&(h>o||!h)?(c(),l.push(d)):d instanceof gt&&h&&(p=f[f.length-1])instanceof gt&&d.lines+p.lines<=32?(h+=d.lines,a+=d.length+1,f[f.length-1]=new gt(p.text.concat(d.text),p.length+1+d.length)):(h+d.lines>n&&c(),h+=d.lines,a+=d.length+1,f.push(d))}function c(){h!=0&&(l.push(f.length==1?f[0]:s.from(f,a)),a=-1,h=f.length=0)}for(let d of t)u(d);return c(),l.length==1?l[0]:new s(l,e)}};X.empty=new gt([""],0);function $h(s){let t=-1;for(let e of s)t+=e.length+1;return t}function Ki(s,t,e=0,i=1e9){for(let n=0,r=0,o=!0;r<s.length&&n<=i;r++){let l=s[r],h=n+l.length;h>=e&&(h>i&&(l=l.slice(0,i-n)),n<e&&(l=l.slice(e-n)),o?(t[t.length-1]+=l,o=!1):t.push(l)),n=h+1}return t}function so(s,t,e){return Ki(s,[""],t,e)}var pe=class{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof gt?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],r=this.offsets[i],o=r>>1,l=n instanceof gt?n.text.length:n.children.length;if(o==(e>0?l:0)){if(i==0)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(e>0?0:1)){if(this.offsets[i]+=e,t==0)return this.lineBreak=!0,this.value=`\n`,this;t--}else if(n instanceof gt){let h=n.text[o+(e<0?-1:0)];if(this.offsets[i]+=e,h.length>Math.max(0,t))return this.value=t==0?h:e>0?h.slice(t):h.slice(0,h.length-t),this;t-=h.length}else{let h=n.children[o+(e<0?-1:0)];t>h.length?(t-=h.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(h),this.offsets.push(e>0?1:(h instanceof gt?h.text.length:h.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}},Ui=class{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new pe(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}},Gi=class{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol!="undefined"&&(X.prototype[Symbol.iterator]=function(){return this.iter()},pe.prototype[Symbol.iterator]=Ui.prototype[Symbol.iterator]=Gi.prototype[Symbol.iterator]=function(){return this});var us=class{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}},Ne="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(s=>s?parseInt(s,36):1);for(let s=1;s<Ne.length;s++)Ne[s]+=Ne[s-1];function qh(s){for(let t=1;t<Ne.length;t+=2)if(Ne[t]>s)return Ne[t-1]<=s;return!1}function ro(s){return s>=127462&&s<=127487}var oo=8205;function lo(s,t,e=!0,i=!0){return(e?go:jh)(s,t,i)}function go(s,t,e){if(t==s.length)return t;t&&mo(s.charCodeAt(t))&&bo(s.charCodeAt(t-1))&&t--;let i=as(s,t);for(t+=ho(i);t<s.length;){let n=as(s,t);if(i==oo||n==oo||e&&qh(n))t+=ho(n),i=n;else if(ro(n)){let r=0,o=t-2;for(;o>=0&&ro(as(s,o));)r++,o-=2;if(r%2==0)break;t+=2}else break}return t}function jh(s,t,e){for(;t>0;){let i=go(s,t-2,e);if(i<t)return i;t--}return 0}function mo(s){return s>=56320&&s<57344}function bo(s){return s>=55296&&s<56320}function as(s,t){let e=s.charCodeAt(t);if(!bo(e)||t+1==s.length)return e;let i=s.charCodeAt(t+1);return mo(i)?(e-55296<<10)+(i-56320)+65536:e}function ho(s){return s<65536?1:2}var cs=/\\r\\n?|\\n/,Xt=function(s){return s[s.Simple=0]="Simple",s[s.TrackDel=1]="TrackDel",s[s.TrackBefore=2]="TrackBefore",s[s.TrackAfter=3]="TrackAfter",s}(Xt||(Xt={})),ge=class s{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let r=this.sections[e++],o=this.sections[e++];o<0?(t(i,n,r),n+=r):n+=o,i+=r}}iterChangedRanges(t,e=!1){ds(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new s(t)}composeDesc(t){return this.empty?t:t.empty?this:yo(this,t)}mapDesc(t,e=!1){return t.empty?this:ps(this,t,e)}mapPos(t,e=-1,i=Xt.Simple){let n=0,r=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],h=this.sections[o++],a=n+l;if(h<0){if(a>t)return r+(t-n);r+=l}else{if(i!=Xt.Simple&&a>=t&&(i==Xt.TrackDel&&n<t&&a>t||i==Xt.TrackBefore&&n<t||i==Xt.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!l)return t==n||e<0?r:r+h;r+=h}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let r=this.sections[i++],o=this.sections[i++],l=n+r;if(o>=0&&n<=e&&l>=t)return n<t&&l>e?"cover":!0;n=l}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new s(t)}static create(t){return new s(t)}},Pt=class s extends ge{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return ds(this,(e,i,n,r,o)=>t=t.replace(n,n+(i-e),o),!1),t}mapDesc(t,e=!1){return ps(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,r=0;n<e.length;n+=2){let o=e[n],l=e[n+1];if(l>=0){e[n]=l,e[n+1]=o;let h=n>>1;for(;i.length<h;)i.push(X.empty);i.push(o?t.slice(r,r+o):X.empty)}r+=o}return new s(e,i)}compose(t){return this.empty?t:t.empty?this:yo(this,t,!0)}map(t,e=!1){return t.empty?this:ps(this,t,e,!0)}iterChanges(t,e=!1){ds(this,t,e)}get desc(){return ge.create(this.sections)}filter(t){let e=[],i=[],n=[],r=new me(this);t:for(let o=0,l=0;;){let h=o==t.length?1e9:t[o++];for(;l<h||l==h&&r.len==0;){if(r.done)break t;let f=Math.min(r.len,h-l);nt(n,f,-1);let u=r.ins==-1?-1:r.off==0?r.ins:0;nt(e,f,u),u>0&&Qt(i,e,r.text),r.forward(f),l+=f}let a=t[o++];for(;l<a;){if(r.done)break t;let f=Math.min(r.len,a-l);nt(e,f,-1),nt(n,f,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(f),l+=f}}return{changes:new s(e,i),filtered:ge.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):n==0?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],r=[],o=0,l=null;function h(f=!1){if(!f&&!n.length)return;o<e&&nt(n,e-o,-1);let u=new s(n,r);l=l?l.compose(u.map(l)):u,n=[],r=[],o=0}function a(f){if(Array.isArray(f))for(let u of f)a(u);else if(f instanceof s){if(f.length!=e)throw new RangeError(`Mismatched change set length (got ${f.length}, expected ${e})`);h(),l=l?l.compose(f.map(l)):f}else{let{from:u,to:c=u,insert:d}=f;if(u>c||u<0||c>e)throw new RangeError(`Invalid change range ${u} to ${c} (in doc of length ${e})`);let p=d?typeof d=="string"?X.of(d.split(i||cs)):d:X.empty,m=p.length;if(u==c&&m==0)return;u<o&&h(),u>o&&nt(n,u-o,-1),nt(n,c-u,m),Qt(r,n,p),o=c}}return a(t),h(!l),l}static empty(t){return new s(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let r=t[n];if(typeof r=="number")e.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)e.push(r[0],0);else{for(;i.length<n;)i.push(X.empty);i[n]=X.of(r.slice(1)),e.push(r[0],i[n].length)}}}return new s(e,i)}static createSet(t,e){return new s(t,e)}};function nt(s,t,e,i=!1){if(t==0&&e<=0)return;let n=s.length-2;n>=0&&e<=0&&e==s[n+1]?s[n]+=t:t==0&&s[n]==0?s[n+1]+=e:i?(s[n]+=t,s[n+1]+=e):s.push(t,e)}function Qt(s,t,e){if(e.length==0)return;let i=t.length-2>>1;if(i<s.length)s[s.length-1]=s[s.length-1].append(e);else{for(;s.length<i;)s.push(X.empty);s.push(e)}}function ds(s,t,e){let i=s.inserted;for(let n=0,r=0,o=0;o<s.sections.length;){let l=s.sections[o++],h=s.sections[o++];if(h<0)n+=l,r+=l;else{let a=n,f=r,u=X.empty;for(;a+=l,f+=h,h&&i&&(u=u.append(i[o-2>>1])),!(e||o==s.sections.length||s.sections[o+1]<0);)l=s.sections[o++],h=s.sections[o++];t(n,a,r,f,u),n=a,r=f}}}function ps(s,t,e,i=!1){let n=[],r=i?[]:null,o=new me(s),l=new me(t);for(let h=-1;;)if(o.ins==-1&&l.ins==-1){let a=Math.min(o.len,l.len);nt(n,a,-1),o.forward(a),l.forward(a)}else if(l.ins>=0&&(o.ins<0||h==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!e))){let a=l.len;for(nt(n,l.ins,-1);a;){let f=Math.min(o.len,a);o.ins>=0&&h<o.i&&o.len<=f&&(nt(n,0,o.ins),r&&Qt(r,n,o.text),h=o.i),o.forward(f),a-=f}l.next()}else if(o.ins>=0){let a=0,f=o.len;for(;f;)if(l.ins==-1){let u=Math.min(f,l.len);a+=u,f-=u,l.forward(u)}else if(l.ins==0&&l.len<f)f-=l.len,l.next();else break;nt(n,a,h<o.i?o.ins:0),r&&h<o.i&&Qt(r,n,o.text),h=o.i,o.forward(o.len-f)}else{if(o.done&&l.done)return r?Pt.createSet(n,r):ge.create(n);throw new Error("Mismatched change set lengths")}}function yo(s,t,e=!1){let i=[],n=e?[]:null,r=new me(s),o=new me(t);for(let l=!1;;){if(r.done&&o.done)return n?Pt.createSet(i,n):ge.create(i);if(r.ins==0)nt(i,r.len,0,l),r.next();else if(o.len==0&&!o.done)nt(i,0,o.ins,l),n&&Qt(n,i,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let h=Math.min(r.len2,o.len),a=i.length;if(r.ins==-1){let f=o.ins==-1?-1:o.off?0:o.ins;nt(i,h,f,l),n&&f&&Qt(n,i,o.text)}else o.ins==-1?(nt(i,r.off?0:r.len,h,l),n&&Qt(n,i,r.textBit(h))):(nt(i,r.off?0:r.len,o.off?0:o.ins,l),n&&!o.off&&Qt(n,i,o.text));l=(r.ins>h||o.ins>=0&&o.len>h)&&(l||i.length>a),r.forward2(h),o.forward(h)}}}}var me=class{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?X.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?X.empty:e[i].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}},Re=class s{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let t=this.flags&3;return t==3?null:t}get goalColumn(){let t=this.flags>>5;return t==33554431?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new s(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return at.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return at.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return at.range(t.anchor,t.head)}static create(t,e,i){return new s(t,e,i)}},at=class s{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:s.create(this.ranges.map(i=>i.map(t,e)),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new s([this.main],0)}addRange(t,e=!0){return s.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,s.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new s(t.ranges.map(e=>Re.fromJSON(e)),t.main)}static single(t,e=t){return new s([s.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=i:r.from<i)return s.normalized(t.slice(),e);i=r.to}return new s(t,e)}static cursor(t,e=0,i,n){return Re.create(t,t,(e==0?0:e<0?4:8)|(i==null?3:Math.min(2,i))|(n!=null?n:33554431)<<5)}static range(t,e,i,n){let r=(i!=null?i:33554431)<<5|(n==null?3:Math.min(2,n));return e<t?Re.create(e,t,24|r):Re.create(t,e,(e>t?4:0)|r)}static normalized(t,e=0){let i=t[e];t.sort((n,r)=>n.from-r.from),e=t.indexOf(i);for(let n=1;n<t.length;n++){let r=t[n],o=t[n-1];if(r.empty?r.from<=o.to:r.from<o.to){let l=o.from,h=Math.max(r.to,o.to);n<=e&&e--,t.splice(--n,2,r.anchor>r.head?s.range(h,l):s.range(l,h))}}return new s(t,e)}};function wo(s,t){for(let e of s.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}var Ss=0,mt=class s{constructor(t,e,i,n,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=Ss++,this.default=t([]),this.extensions=typeof r=="function"?r(this):r}static define(t={}){return new s(t.combine||(e=>e),t.compareInput||((e,i)=>e===i),t.compare||(t.combine?(e,i)=>e===i:Cs),!!t.static,t.enables)}of(t){return new Le([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can\'t compute a static facet");return new Le(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can\'t compute a static facet");return new Le(t,this,2,e)}from(t,e){return e||(e=i=>i),this.compute([t],i=>e(i.field(t)))}};function Cs(s,t){return s==t||s.length==t.length&&s.every((e,i)=>e===t[i])}var Le=class{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=Ss++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,r=this.id,o=t[r]>>1,l=this.type==2,h=!1,a=!1,f=[];for(let u of this.dependencies)u=="doc"?h=!0:u=="selection"?a=!0:((e=t[u.id])!==null&&e!==void 0?e:1)&1||f.push(t[u.id]);return{create(u){return u.values[o]=i(u),1},update(u,c){if(h&&c.docChanged||a&&(c.docChanged||c.selection)||gs(u,f)){let d=i(u);if(l?!ao(d,u.values[o],n):!n(d,u.values[o]))return u.values[o]=d,1}return 0},reconfigure:(u,c)=>{let d,p=c.config.address[r];if(p!=null){let m=Qi(c,p);if(this.dependencies.every(g=>g instanceof mt?c.facet(g)===u.facet(g):g instanceof te?c.field(g,!1)==u.field(g,!1):!0)||(l?ao(d=i(u),m,n):n(d=i(u),m)))return u.values[o]=m,0}else d=i(u);return u.values[o]=d,1}}}};function ao(s,t,e){if(s.length!=t.length)return!1;for(let i=0;i<s.length;i++)if(!e(s[i],t[i]))return!1;return!0}function gs(s,t){let e=!1;for(let i of t)li(s,i)&1&&(e=!0);return e}function Kh(s,t,e){let i=e.map(h=>s[h.id]),n=e.map(h=>h.type),r=i.filter(h=>!(h&1)),o=s[t.id]>>1;function l(h){let a=[];for(let f=0;f<i.length;f++){let u=Qi(h,i[f]);if(n[f]==2)for(let c of u)a.push(c);else a.push(u)}return t.combine(a)}return{create(h){for(let a of i)li(h,a);return h.values[o]=l(h),1},update(h,a){if(!gs(h,r))return 0;let f=l(h);return t.compare(f,h.values[o])?0:(h.values[o]=f,1)},reconfigure(h,a){let f=gs(h,i),u=a.config.facets[t.id],c=a.facet(t);if(u&&!f&&Cs(e,u))return h.values[o]=c,0;let d=l(h);return t.compare(d,c)?(h.values[o]=c,0):(h.values[o]=d,1)}}}var fo=mt.define({static:!0}),te=class s{constructor(t,e,i,n,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new s(Ss++,t.create,t.update,t.compare||((i,n)=>i===n),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(fo).find(i=>i.field==this);return((e==null?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:i=>(i.values[e]=this.create(i),1),update:(i,n)=>{let r=i.values[e],o=this.updateF(r,n);return this.compareF(r,o)?0:(i.values[e]=o,1)},reconfigure:(i,n)=>n.config.address[this.id]!=null?(i.values[e]=n.field(this),0):(i.values[e]=this.create(i),1)}}init(t){return[this,fo.of({field:this,create:t})]}get extension(){return this}},ce={lowest:4,low:3,default:2,high:1,highest:0};function oi(s){return t=>new Ji(t,s)}var tu={highest:oi(ce.highest),high:oi(ce.high),default:oi(ce.default),low:oi(ce.low),lowest:oi(ce.lowest)},Ji=class{constructor(t,e){this.inner=t,this.prec=e}},Yi=class s{of(t){return new hi(this,t)}reconfigure(t){return s.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}},hi=class{constructor(t,e){this.compartment=t,this.inner=e}},Xi=class s{constructor(t,e,i,n,r,o){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],r=Object.create(null),o=new Map;for(let c of Uh(t,e,o))c instanceof te?n.push(c):(r[c.facet.id]||(r[c.facet.id]=[])).push(c);let l=Object.create(null),h=[],a=[];for(let c of n)l[c.id]=a.length<<1,a.push(d=>c.slot(d));let f=i==null?void 0:i.config.facets;for(let c in r){let d=r[c],p=d[0].facet,m=f&&f[c]||[];if(d.every(g=>g.type==0))if(l[p.id]=h.length<<1|1,Cs(m,d))h.push(i.facet(p));else{let g=p.combine(d.map(b=>b.value));h.push(i&&p.compare(g,i.facet(p))?i.facet(p):g)}else{for(let g of d)g.type==0?(l[g.id]=h.length<<1|1,h.push(g.value)):(l[g.id]=a.length<<1,a.push(b=>g.dynamicSlot(b)));l[p.id]=a.length<<1,a.push(g=>Kh(g,p,d))}}let u=a.map(c=>c(l));return new s(t,o,u,l,h,r)}};function Uh(s,t,e){let i=[[],[],[],[],[]],n=new Map;function r(o,l){let h=n.get(o);if(h!=null){if(h<=l)return;let a=i[h].indexOf(o);a>-1&&i[h].splice(a,1),o instanceof hi&&e.delete(o.compartment)}if(n.set(o,l),Array.isArray(o))for(let a of o)r(a,l);else if(o instanceof hi){if(e.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let a=t.get(o.compartment)||o.inner;e.set(o.compartment,a),r(a,l)}else if(o instanceof Ji)r(o.inner,o.prec);else if(o instanceof te)i[l].push(o),o.provides&&r(o.provides,l);else if(o instanceof Le)i[l].push(o),o.facet.extensions&&r(o.facet.extensions,ce.default);else{let a=o.extension;if(!a)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(a,l)}}return r(s,ce.default),i.reduce((o,l)=>o.concat(l))}function li(s,t){if(t&1)return 2;let e=t>>1,i=s.status[e];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;s.status[e]=4;let n=s.computeSlot(s,s.config.dynamicSlots[e]);return s.status[e]=2|n}function Qi(s,t){return t&1?s.config.staticValues[t>>1]:s.values[t>>1]}var xo=mt.define(),ko=mt.define({combine:s=>s.some(t=>t),static:!0}),vo=mt.define({combine:s=>s.length?s[0]:void 0,static:!0}),So=mt.define(),Co=mt.define(),Ao=mt.define(),Oo=mt.define({combine:s=>s.length?s[0]:!1}),be=class{constructor(t,e){this.type=t,this.value=e}static define(){return new ms}},ms=class{of(t){return new be(this,t)}},bs=class{constructor(t){this.map=t}of(t){return new lt(this,t)}},lt=class s{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new s(this.type,e)}is(t){return this.type==t}static define(t={}){return new bs(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let r=n.map(e);r&&i.push(r)}return i}};lt.reconfigure=lt.define();lt.appendConfig=lt.define();var At=class s{constructor(t,e,i,n,r,o){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,i&&wo(i,e.newLength),r.some(l=>l.type==s.time)||(this.annotations=r.concat(s.time.of(Date.now())))}static create(t,e,i,n,r,o){return new s(t,e,i,n,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(s.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}};At.time=be.define();At.userEvent=be.define();At.addToHistory=be.define();At.remote=be.define();function Gh(s,t){let e=[];for(let i=0,n=0;;){let r,o;if(i<s.length&&(n==t.length||t[n]>=s[i]))r=s[i++],o=s[i++];else if(n<t.length)r=t[n++],o=t[n++];else return e;!e.length||e[e.length-1]<r?e.push(r,o):e[e.length-1]<o&&(e[e.length-1]=o)}}function Mo(s,t,e){var i;let n,r,o;return e?(n=t.changes,r=Pt.empty(t.changes.length),o=s.changes.compose(t.changes)):(n=t.changes.map(s.changes),r=s.changes.mapDesc(t.changes,!0),o=s.changes.compose(n)),{changes:o,selection:t.selection?t.selection.map(r):(i=s.selection)===null||i===void 0?void 0:i.map(n),effects:lt.mapEffects(s.effects,n).concat(lt.mapEffects(t.effects,r)),annotations:s.annotations.length?s.annotations.concat(t.annotations):t.annotations,scrollIntoView:s.scrollIntoView||t.scrollIntoView}}function ys(s,t,e){let i=t.selection,n=Fe(t.annotations);return t.userEvent&&(n=n.concat(At.userEvent.of(t.userEvent))),{changes:t.changes instanceof Pt?t.changes:Pt.of(t.changes||[],e,s.facet(vo)),selection:i&&(i instanceof at?i:at.single(i.anchor,i.head)),effects:Fe(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function To(s,t,e){let i=ys(s,t.length?t[0]:{},s.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let r=1;r<t.length;r++){t[r].filter===!1&&(e=!1);let o=!!t[r].sequential;i=Mo(i,ys(s,t[r],o?i.changes.newLength:s.doc.length),o)}let n=At.create(s,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return Yh(e?Jh(n):n)}function Jh(s){let t=s.startState,e=!0;for(let n of t.facet(So)){let r=n(s);if(r===!1){e=!1;break}Array.isArray(r)&&(e=e===!0?r:Gh(e,r))}if(e!==!0){let n,r;if(e===!1)r=s.changes.invertedDesc,n=Pt.empty(t.doc.length);else{let o=s.changes.filter(e);n=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}s=At.create(t,n,s.selection&&s.selection.map(r),lt.mapEffects(s.effects,r),s.annotations,s.scrollIntoView)}let i=t.facet(Co);for(let n=i.length-1;n>=0;n--){let r=i[n](s);r instanceof At?s=r:Array.isArray(r)&&r.length==1&&r[0]instanceof At?s=r[0]:s=To(t,Fe(r),!1)}return s}function Yh(s){let t=s.startState,e=t.facet(Ao),i=s;for(let n=e.length-1;n>=0;n--){let r=e[n](s);r&&Object.keys(r).length&&(i=Mo(i,ys(t,r,s.changes.newLength),!0))}return i==s?s:At.create(t,s.changes,s.selection,i.effects,i.annotations,i.scrollIntoView)}var Xh=[];function Fe(s){return s==null?Xh:Array.isArray(s)?s:[s]}var Zt=function(s){return s[s.Word=0]="Word",s[s.Space=1]="Space",s[s.Other=2]="Other",s}(Zt||(Zt={})),Qh=/[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/,ws;try{ws=new RegExp("[\\\\p{Alphabetic}\\\\p{Number}_]","u")}catch(s){}function Zh(s){if(ws)return ws.test(s);for(let t=0;t<s.length;t++){let e=s[t];if(/\\w/.test(e)||e>"\\x80"&&(e.toUpperCase()!=e.toLowerCase()||Qh.test(e)))return!0}return!1}function ta(s){return t=>{if(!/\\S/.test(t))return Zt.Space;if(Zh(t))return Zt.Word;for(let e=0;e<s.length;e++)if(t.indexOf(s[e])>-1)return Zt.Word;return Zt.Other}}var Tt=class s{constructor(t,e,i,n,r,o){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)li(this,l<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(i==null){if(e)throw new RangeError("Field is not present in this state");return}return li(this,i),Qi(this,i)}update(...t){return To(this,t,!0)}applyTransaction(t){let e=this.config,{base:i,compartments:n}=e;for(let o of t.effects)o.is(Yi.reconfigure)?(e&&(n=new Map,e.compartments.forEach((l,h)=>n.set(h,l)),e=null),n.set(o.value.compartment,o.value.extension)):o.is(lt.reconfigure)?(e=null,i=o.value):o.is(lt.appendConfig)&&(e=null,i=Fe(i).concat(o.value));let r;e?r=t.startState.values.slice():(e=Xi.resolve(i,n,this),r=new s(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(l,h)=>h.reconfigure(l,this),null).values),new s(e,t.newDoc,t.newSelection,r,(o,l)=>l.update(o,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:at.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),r=[i.range],o=Fe(i.effects);for(let l=1;l<e.ranges.length;l++){let h=t(e.ranges[l]),a=this.changes(h.changes),f=a.map(n);for(let c=0;c<l;c++)r[c]=r[c].map(f);let u=n.mapDesc(a,!0);r.push(h.range.map(u)),n=n.compose(f),o=lt.mapEffects(o,f).concat(lt.mapEffects(Fe(h.effects),u))}return{changes:n,selection:at.create(r,e.mainIndex),effects:o}}changes(t=[]){return t instanceof Pt?t:Pt.of(t,this.doc.length,this.facet(s.lineSeparator))}toText(t){return X.of(t.split(this.facet(s.lineSeparator)||cs))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(li(this,e),Qi(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof te&&this.config.address[n.id]!=null&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let r in i)if(Object.prototype.hasOwnProperty.call(t,r)){let o=i[r],l=t[r];n.push(o.init(h=>o.spec.fromJSON(l,h)))}}return s.create({doc:t.doc,selection:at.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=Xi.resolve(t.extensions||[],new Map),i=t.doc instanceof X?t.doc:X.of((t.doc||"").split(e.staticFacet(s.lineSeparator)||cs)),n=t.selection?t.selection instanceof at?t.selection:at.single(t.selection.anchor,t.selection.head):at.single(0);return wo(n,i.length),e.staticFacet(ko)||(n=n.asSingle()),new s(e,i,n,e.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(s.tabSize)}get lineBreak(){return this.facet(s.lineSeparator)||`\n`}get readOnly(){return this.facet(Oo)}phrase(t,...e){for(let i of this.facet(s.phrases))if(Object.prototype.hasOwnProperty.call(i,t)){t=i[t];break}return e.length&&(t=t.replace(/\\$(\\$|\\d*)/g,(i,n)=>{if(n=="$")return"$";let r=+(n||1);return!r||r>e.length?i:e[r-1]})),t}languageDataAt(t,e,i=-1){let n=[];for(let r of this.facet(xo))for(let o of r(this,e,i))Object.prototype.hasOwnProperty.call(o,t)&&n.push(o[t]);return n}charCategorizer(t){return ta(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),o=t-i,l=t-i;for(;o>0;){let h=lo(e,o,!1);if(r(e.slice(h,o))!=Zt.Word)break;o=h}for(;l<n;){let h=lo(e,l);if(r(e.slice(l,h))!=Zt.Word)break;l=h}return o==l?null:at.range(o+i,l+i)}};Tt.allowMultipleSelections=ko;Tt.tabSize=mt.define({combine:s=>s.length?s[0]:4});Tt.lineSeparator=vo;Tt.readOnly=Oo;Tt.phrases=mt.define({compare(s,t){let e=Object.keys(s),i=Object.keys(t);return e.length==i.length&&e.every(n=>s[n]==t[n])}});Tt.languageData=xo;Tt.changeFilter=So;Tt.transactionFilter=Co;Tt.transactionExtender=Ao;Yi.reconfigure=lt.define();var He=class{eq(t){return this==t}range(t,e=t){return ai.create(t,e,this)}};He.prototype.startSide=He.prototype.endSide=0;He.prototype.point=!1;He.prototype.mapMode=Xt.TrackDel;var ai=class s{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new s(t,e,i)}};function xs(s,t){return s.from-t.from||s.value.startSide-t.value.startSide}var ks=class s{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let r=i?this.to:this.from;for(let o=n,l=r.length;;){if(o==l)return o;let h=o+l>>1,a=r[h]-t||(i?this.value[h].endSide:this.value[h].startSide)-e;if(h==o)return a>=0?o:l;a>=0?l=h:o=h+1}}between(t,e,i,n){for(let r=this.findIndex(e,-1e9,!0),o=this.findIndex(i,1e9,!1,r);r<o;r++)if(n(this.from[r]+t,this.to[r]+t,this.value[r])===!1)return!1}map(t,e){let i=[],n=[],r=[],o=-1,l=-1;for(let h=0;h<this.value.length;h++){let a=this.value[h],f=this.from[h]+t,u=this.to[h]+t,c,d;if(f==u){let p=e.mapPos(f,a.startSide,a.mapMode);if(p==null||(c=d=p,a.startSide!=a.endSide&&(d=e.mapPos(f,a.endSide),d<c)))continue}else if(c=e.mapPos(f,a.startSide),d=e.mapPos(u,a.endSide),c>d||c==d&&a.startSide>0&&a.endSide<=0)continue;(d-c||a.endSide-a.startSide)<0||(o<0&&(o=c),a.point&&(l=Math.max(l,d-c)),i.push(a),n.push(c-o),r.push(d-o))}return{mapped:i.length?new s(n,r,i,l):null,pos:o}}},ee=class s{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new s(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:r=this.length}=t,o=t.filter;if(e.length==0&&!o)return this;if(i&&(e=e.slice().sort(xs)),this.isEmpty)return e.length?s.of(e):this;let l=new tn(this,null,-1).goto(0),h=0,a=[],f=new Zi;for(;l.value||h<e.length;)if(h<e.length&&(l.from-e[h].from||l.startSide-e[h].value.startSide)>=0){let u=e[h++];f.addInner(u.from,u.to,u.value)||a.push(u)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(h==e.length||this.chunkEnd(l.chunkIndex)<e[h].from)&&(!o||n>this.chunkEnd(l.chunkIndex)||r<this.chunkPos[l.chunkIndex])&&f.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||n>l.to||r<l.from||o(l.from,l.to,l.value))&&(f.addInner(l.from,l.to,l.value)||a.push(ai.create(l.from,l.to,l.value))),l.next());return f.finishInner(this.nextLayer.isEmpty&&!a.length?s.empty:this.nextLayer.update({add:a,filter:o,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],h=this.chunk[o],a=t.touchesRange(l,l+h.length);if(a===!1)n=Math.max(n,h.maxPoint),e.push(h),i.push(t.mapPos(l));else if(a===!0){let{mapped:f,pos:u}=h.map(l,t);f&&(n=Math.max(n,f.maxPoint),e.push(f),i.push(u))}}let r=this.nextLayer.map(t);return e.length==0?r:new s(i,e,r||s.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],o=this.chunk[n];if(e>=r&&t<=r+o.length&&o.between(r,t-r,e-r,i)===!1)return}this.nextLayer.between(t,e,i)}}iter(t=0){return fi.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return fi.from(t).goto(e)}static compare(t,e,i,n,r=-1){let o=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),l=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),h=uo(o,l,i),a=new de(o,h,r),f=new de(l,h,r);i.iterGaps((u,c,d)=>co(a,u,f,c,d,n)),i.empty&&i.length==0&&co(a,0,f,0,0,n)}static eq(t,e,i=0,n){n==null&&(n=1e9-1);let r=t.filter(f=>!f.isEmpty&&e.indexOf(f)<0),o=e.filter(f=>!f.isEmpty&&t.indexOf(f)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let l=uo(r,o),h=new de(r,l,0).goto(i),a=new de(o,l,0).goto(i);for(;;){if(h.to!=a.to||!vs(h.active,a.active)||h.point&&(!a.point||!h.point.eq(a.point)))return!1;if(h.to>n)return!0;h.next(),a.next()}}static spans(t,e,i,n,r=-1){let o=new de(t,null,r).goto(e),l=e,h=o.openStart;for(;;){let a=Math.min(o.to,i);if(o.point){let f=o.activeForPoint(o.to),u=o.pointFrom<e?f.length+1:Math.min(f.length,h);n.point(l,a,o.point,f,u,o.pointRank),h=Math.min(o.openEnd(a),f.length)}else a>l&&(n.span(l,a,o.active,h),h=o.openEnd(a));if(o.to>i)return h+(o.point&&o.to>i?1:0);l=o.to,o.next()}}static of(t,e=!1){let i=new Zi;for(let n of t instanceof ai?[t]:e?ea(t):t)i.add(n.from,n.to,n.value);return i.finish()}};ee.empty=new ee([],[],null,-1);function ea(s){if(s.length>1)for(let t=s[0],e=1;e<s.length;e++){let i=s[e];if(xs(t,i)>0)return s.slice().sort(xs);t=i}return s}ee.empty.nextLayer=ee.empty;var Zi=class s{finishChunk(t){this.chunks.push(new ks(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new s)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(ee.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=ee.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}};function uo(s,t,e){let i=new Map;for(let r of s)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&i.set(r.chunk[o],r.chunkPos[o]);let n=new Set;for(let r of t)for(let o=0;o<r.chunk.length;o++){let l=i.get(r.chunk[o]);l!=null&&(e?e.mapPos(l):l)==r.chunkPos[o]&&!(e!=null&&e.touchesRange(l,l+r.chunk[o].length))&&n.add(r.chunk[o])}return n}var tn=class{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<t||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}},fi=class s{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let r=0;r<t.length;r++)for(let o=t[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&n.push(new tn(o,e,i,r));return n.length==1?n[0]:new s(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let i=this.heap.length>>1;i>=0;i--)fs(this.heap,i);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let i=this.heap.length>>1;i>=0;i--)fs(this.heap,i);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),fs(this.heap,0)}}};function fs(s,t){for(let e=s[t];;){let i=(t<<1)+1;if(i>=s.length)break;let n=s[i];if(i+1<s.length&&n.compare(s[i+1])>=0&&(n=s[i+1],i++),e.compare(n)<0)break;s[i]=e,s[t]=n,t=i}}var de=class{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=fi.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){qi(this.active,t),qi(this.activeTo,t),qi(this.activeRank,t),this.minActive=po(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=r;)e++;ji(this.active,e,i),ji(this.activeTo,e,n),ji(this.activeRank,e,r),t&&ji(t,e,this.cursor.from),this.minActive=po(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&qi(i,n)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(i),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let n=i.length-1;n>=0&&i[n]<t;n--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}};function co(s,t,e,i,n,r){s.goto(t),e.goto(i);let o=i+n,l=i,h=i-t;for(;;){let a=s.to+h-e.to||s.endSide-e.endSide,f=a<0?s.to+h:e.to,u=Math.min(f,o);if(s.point||e.point?s.point&&e.point&&(s.point==e.point||s.point.eq(e.point))&&vs(s.activeForPoint(s.to),e.activeForPoint(e.to))||r.comparePoint(l,u,s.point,e.point):u>l&&!vs(s.active,e.active)&&r.compareRange(l,u,s.active,e.active),f>o)break;l=f,a<=0&&s.next(),a>=0&&e.next()}}function vs(s,t){if(s.length!=t.length)return!1;for(let e=0;e<s.length;e++)if(s[e]!=t[e]&&!s[e].eq(t[e]))return!1;return!0}function qi(s,t){for(let e=t,i=s.length-1;e<i;e++)s[e]=s[e+1];s.pop()}function ji(s,t,e){for(let i=s.length-1;i>=t;i--)s[i+1]=s[i];s[t]=e}function po(s,t){let e=-1,i=1e9;for(let n=0;n<t.length;n++)(t[n]-i||s[n].endSide-s[e].endSide)<0&&(e=n,i=t[n]);return e}var su={Addition:0,Deletion:1,Substitution:2,Highlight:3,Comment:4},ru={0:["+","+"],1:["-","-"],2:["~","~"],3:["=","="],4:[">","<"]},ze={0:["{++","++}"],1:["{--","--}"],2:["{~~","~>","~~}"],3:["{==","==}"],4:["{>>","<<}"]};var ye=class{constructor(t,e,i,n,r){this.from=t;this.to=e;this.type=i;this.repr=n;this.text=r;zi(this,"num_ignore_chars",6)}copy(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}equals(t){return this.type===t.type&&this.text===t.text}num_ignored_chars(t,e){return t>=this.to||e<=this.from||this.encloses_range(t,e)?0:this.fully_in_range(t,e)?6:3}part_is_empty(t){return!1}empty(){return this.to-this.from===6}unwrap(){return this.text.slice(3,-3)}unwrap_bracket(t=!1){return t?this.text.slice(3):this.text.slice(0,-3)}unwrap_parts(){return[this.unwrap()]}unwrap_slice(t,e){return this.text.slice(Math.max(3,t),Math.min(this.text.length-3,e))}fully_in_range(t,e,i=!1){return i?t<=this.from+3&&this.to-3<=e:t<=this.from&&this.to<=e}partially_in_range(t,e){return!(t>this.to||e<this.from)}encloses(t,e=!1){return e?this.from<t&&this.to>t:this.from<=t&&this.to>=t}encloses_range(t,e,i=!1){return i?this.from<t&&this.to>e:this.from<=t&&this.to>=e}part_encloses_range(t,e,i){return this.encloses_range(t,e)}accept(){return this.text}reject(){return this.text}touches(t){return this.from===t||this.to===t}cursor_inside(t){return this.from+3<t&&this.to-3>t}cursor_outside(t,e){return e?t<=this.from:t>=this.to}range_infront(t,e){return this.to<t}range_behind(t,e){return e<this.from}cursor_infront(t,e,i=!1){return i?e?t<this.from+3:t>this.to-3:e?t<=this.from+3:t>=this.to-3}cursor_behind(t,e,i=!1){return i?e?t>this.from+3:t<this.to-3:e?t>=this.from+3:t<=this.to-3}cursor_move_outside(t,e){return e?(this.touches_right_bracket(t,!0,!1)&&(t=this.to-3),this.touches_left_bracket(t,!1,!0)&&(t=this.from)):(this.touches_left_bracket(t,!0,!1)&&(t=this.from+3),this.touches_right_bracket(t,!1,!0)&&(t=this.to)),t}cursor_move_inside(t,e){return e?this.touches_left_bracket(t,!0,!1)&&(t=this.from+3):this.touches_right_bracket(t,!0,!1)&&(t=this.to-3),t}touches_left_bracket(t,e=!1,i=!1){return t+(e?0:1)>=this.from&&t+(i?0:1)<=this.from+3}touches_separator(t,e=!1,i=!1){return!1}touches_right_bracket(t,e=!1,i=!1){return t-(i?0:1)>=this.to-3&&t-(e?0:1)<=this.to}touches_bracket(t,e,i=!1,n=!1){return e?this.touches_left_bracket(t,i,n):this.touches_right_bracket(t,i,n)}touches_brackets(t,e=!1,i=!1){return this.touches_left_bracket(t,e,i)||this.touches_right_bracket(t,e,i)}postprocess(t=!0,e=0,i="div",n=null,r){let o=r!=null?r:this.text;return!r&&t&&(this.to>=o.length&&!o.endsWith(ze[this.type].at(-1))?o=this.unwrap_bracket(!0):o=this.unwrap()),`<${i} class=\'criticmarkup-${this.repr.toLowerCase()}\'>${o}</${i}>`}apply_change(t){this.from=t.mapPos(this.from,1),this.to=t.mapPos(this.to,1)}apply_offset(t){this.from+=t,this.to+=t}get length(){return this.to-this.from-6}},en=class extends ye{constructor(t,e,i){super(t,e,0,"Addition",i)}accept(){return this.unwrap()}reject(){return""}postprocess(t=!0,e=0,i="div",n=null,r){let o=r!=null?r:this.text;return!r&&t&&(this.to>=o.length&&!o.endsWith(ze[this.type].at(-1))?o=this.unwrap_bracket(!0):o=this.unwrap()),e?e===1?o=`<${i} class=\'criticmarkup-preview\'>${o}</${i}>`:o=`<${i} class=\'criticmarkup-preview\'/>`:o=`<${i} class=\'criticmarkup-preview criticmarkup-addition\'>${o}</${i}>`,o}},nn=class extends ye{constructor(t,e,i){super(t,e,1,"Deletion",i)}accept(){return""}reject(){return this.unwrap()}postprocess(t=!0,e=0,i="div",n=null,r){let o=r!=null?r:this.text;return!r&&t&&(this.to>=o.length&&!o.endsWith(ze[this.type].at(-1))?o=this.unwrap_bracket(!0):o=this.unwrap()),e?e===1?o=`<${i} class=\'criticmarkup-preview\'/>`:o=`<${i} class=\'criticmarkup-preview\'>${o}</${i}>`:o=`<${i} class=\'criticmarkup-preview criticmarkup-deletion\'>${o}</${i}>`,o}},sn=class extends ye{constructor(e,i,n,r){super(e,n,2,"Substitution",r);this.middle=i;zi(this,"num_ignore_chars",8)}num_ignored_chars(e,i){return i<=this.from||e>=this.to?0:i<=this.from+3||e>=this.to-3?3:i<=this.middle+2||e>=this.middle?5:8}unwrap(){return this.text.slice(3,this.middle)+this.text.slice(this.middle+2,-3)}unwrap_parts(){return[this.text.slice(3,this.middle),this.text.slice(this.middle+2,-3)]}unwrap_parts_bracket(e,i=0){return e?[this.text.slice(3,this.middle),this.text.slice(this.middle+2)]:[this.text.slice(0,this.middle),this.text.slice(this.middle+2,-3)]}unwrap_slice(e,i){return e>=this.middle?this.text.slice(Math.max(this.middle+2,e),Math.min(this.to-3,i)):i<=this.middle?this.text.slice(Math.max(this.from+3,e),Math.min(this.middle,i)):this.text.slice(Math.max(this.from+3,e),this.middle)+this.text.slice(this.middle+2,Math.min(this.to-3,i))}accept(){return this.unwrap_parts()[1]}reject(){return this.unwrap_parts()[0]}touches_separator(e,i=!1,n=!1){return e+(i?0:1)>=this.middle&&e-(n?0:1)<=this.middle+2}cursor_move_outside(e,i){return i?(this.touches_right_bracket(e,!0,!1)&&(e=this.to-3),this.touches_separator(e,!0,!0)&&(e=this.middle),this.touches_left_bracket(e,!1,!0)&&(e=this.from)):(this.touches_left_bracket(e,!0,!1)&&(e=this.from+3),this.touches_separator(e,!0,!0)&&(e=this.middle+2),this.touches_right_bracket(e,!1,!0)&&(e=this.to)),e}part_encloses_range(e,i,n){return n?this.from<=e&&i<=this.middle+2:this.middle<=e&&i<=this.to}empty(){return this.from+3===this.middle&&this.middle+2===this.to-3}part_is_empty(e){return e?this.from+3===this.middle:this.middle+2===this.to-3}postprocess(e=!0,i=0,n="div",r=null,o){let l=o!=null?o:this.text,h=[l];return!o&&e&&(this.to>=l.length&&!l.endsWith(ze[2][2])?h=this.unwrap_parts_bracket(!0):this.from<=0&&!l.startsWith(ze[2][0])?h=this.unwrap_parts_bracket(!1):h=this.unwrap_parts()),h.length===1?i?i===1?l=r?"":`<${n} class=\'criticmarkup-preview\'>${h[0]}</${n}>`:l=r?`<${n} class=\'criticmarkup-preview\'>${h[0]}</${n}>`:"":l=`<${n} class=\'criticmarkup-preview criticmarkup-${r?"deletion":"addition"}\'>${h[0]}</${n}>`:i?i===1?l=`<${n} class=\'criticmarkup-preview\'>${h[1]}</${n}>`:l=`<${n} class=\'criticmarkup-preview\'>${h[0]}</${n}>`:(l="",h[0].length&&(l+=`<${n} class=\'criticmarkup-preview criticmarkup-deletion\'>${h[0]}</${n}>`),h[1].length&&(l+=`<${n} class=\'criticmarkup-preview criticmarkup-addition\'>${h[1]}</${n}>`)),l}apply_change(e){super.apply_change(e),this.to=e.mapPos(this.to,1)}apply_offset(e){super.apply_offset(e),this.middle+=e}get length(){return this.to-this.from-8}},rn=class extends ye{constructor(t,e,i){super(t,e,3,"Highlight",i)}},on=class extends ye{constructor(t,e,i){super(t,e,4,"Comment",i)}};function As(s,t,e,i,n){switch(e){case"Addition":return new en(s,t,i);case"Deletion":return new nn(s,t,i);case"Substitution":return new sn(s,n,t,i);case"Highlight":return new rn(s,t,i);case"Comment":return new on(s,t,i)}}var ln=class s{constructor(t){zi(this,"nodes");this.nodes=t}empty(){return this.nodes.length===0}get(t){return t<0?this.nodes[this.nodes.length+t]:this.nodes[t]}at_cursor(t,e=!1,i=!1){return i?this.nodes.slice().reverse().find(n=>n.encloses(t,e)):this.nodes.find(n=>n.encloses(t,e))}between_cursor(t,e,i,n=!1){let r=[];if(i){let o=this.nodes.reverse().slice().findIndex(l=>l.to<=t);for(let l=o;l>=0;l--){let h=this.nodes[l];if(n?h.to<e:h.to<=e)break;r.push(h)}}else{let o=this.nodes.findIndex(l=>l.from>=t);for(let l=o;l<this.nodes.length;l++){let h=this.nodes[l];if(n?h.from>e:h.from>=e)break;r.push(h)}}return r}range_contains_node(t,e){return this.nodes.some(i=>i.partially_in_range(t,e))}range_passes_node(t,e,i){return i?this.nodes.slice().reverse().find(n=>t>=n.to&&n.to>=e||t>n.from&&n.from>=e):this.nodes.find(n=>t<=n.from&&n.from<=e||t<n.to&&n.to<=e)}between_two_nodes(t){let e=this.at_cursor(t,!1,!0),i=this.at_cursor(t,!1,!1);return e&&i&&e.to===i.from}near_cursor(t,e){return e?this.nodes.slice().reverse().find(i=>i.to<=t):this.nodes.find(i=>t<=i.from)}directly_adjacent_to_cursor(t,e){return this.nodes.find(i=>e?i.to===t:i.from===t)}adjacent_to_cursor(t,e,i=!1,n=!1){let r=e?this.nodes.slice().reverse():this.nodes;return n?r.find(o=>e?(i?o.from:o.to)<t:t<(i?o.to:o.from)):r.find(o=>e?(i?o.from:o.to)<=t:t<=(i?o.to:o.from))}adjacent_to_node(t,e,i=!1){let n=this.nodes.findIndex(o=>o===t);if(n===-1)return null;let r=e?this.nodes[n-1]:this.nodes[n+1];if(!r)return null;if(i){if(e?r.to===t.from:t.to===r.from)return r}else return r;return null}nodes_in_range(t,e,i=!0){return i?this.nodes.filter(n=>n.partially_in_range(t,e)):this.nodes.filter(n=>n.fully_in_range(t,e))}filter_range(t,e,i=!0){return new s(this.nodes_in_range(t,e,i))}get_sibling(t,e){let i=this.nodes.indexOf(t);return e?this.nodes[i-1]:this.nodes[i+1]}num_ignored_chars_range(t,e,i=null){var o;if(i||(i=this.nodes_in_range(t,e,!0)),!i.length)return 0;let n,r;return i[0].encloses(t)&&(n=i.shift()),(o=i[i.length-1])!=null&&o.encloses(e)&&(r=i.pop()),{num_ignored_chars:i.reduce((l,h)=>l+h.num_ignore_chars,0),left_node:n,right_node:r}}unwrap_in_range(t,e=0,i=t.length,n=null){let r=t.toString(),o=r.slice(e,i),l,h;if(n||(n=this.nodes_in_range(e,i,!0)),n.length===0)return{output:o,from:e,to:i};let a="";e<n[0].from?a+=r.slice(e,n[0].from):l=n[0];let f=-1;for(let d of n)f!==-1&&(a+=r.slice(f,d.from)),a+=d.unwrap_slice(Math.max(0,e-d.from),i-d.from),f=d.to;i>=n.at(-1).to?a+=r.slice(n.at(-1).to,i):h=n.at(-1);let u=l?l.cursor_move_outside(e,!0):e,c=h?h.cursor_move_outside(i,!1):i;return(u!==e||e===(l==null?void 0:l.from))&&(l=void 0),(c!==i||i===(h==null?void 0:h.to))&&(h=void 0),{output:a,from:u,to:c,front_node:l,back_node:h}}applyChanges(t){let e=[];for(let i of this.nodes){let n=i.copy();n.apply_change(t),e.push(n)}return new s(e)}},au={0:"plus-circle",1:"minus-square",2:"replace",3:"highlighter",4:"message-square"},fu={0:en,1:nn,3:rn,2:sn,4:on};var na=0,ui=class{constructor(t,e){this.from=t,this.to=e}},R=class{constructor(t={}){this.id=na++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn\'t define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can\'t add per-node props to node types");return typeof t!="function"&&(t=st.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}};R.closedBy=new R({deserialize:s=>s.split(" ")});R.openedBy=new R({deserialize:s=>s.split(" ")});R.group=new R({deserialize:s=>s.split(" ")});R.contextHash=new R({perNode:!0});R.lookAhead=new R({perNode:!0});R.mounted=new R({perNode:!0});var sa=Object.create(null),st=class s{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):sa,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),n=new s(t.name||"",e,t.id,i);if(t.props){for(let r of t.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can\'t store a per-node prop on a node type");e[r[0].id]=r[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(R.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return i=>{for(let n=i.prop(R.group),r=-1;r<(n?n.length:0);r++){let o=e[r<0?i.name:n[r]];if(o)return o}}}};st.none=new st("",Object.create(null),0,8);var ci=class s{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let r of t){let o=r(i);o&&(n||(n=Object.assign({},i.props)),n[o[0].id]=o[1])}e.push(n?new st(i.name,n,i.id,i.flags):i)}return new s(e)}},hn=new WeakMap,Po=new WeakMap,j;(function(s){s[s.ExcludeBuffers=1]="ExcludeBuffers",s[s.IncludeAnonymous=2]="IncludeAnonymous",s[s.IgnoreMounts=4]="IgnoreMounts",s[s.IgnoreOverlays=8]="IgnoreOverlays"})(j||(j={}));var $=class s{constructor(t,e,i,n,r){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,l]of r)this.props[typeof o=="number"?o:o.id]=l}}toString(){let t=this.prop(R.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let n=i.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new Ve(this.topNode,t)}cursorAt(t,e=0,i=0){let n=hn.get(this)||this.topNode,r=new Ve(n);return r.moveTo(t,e),hn.set(this,r._tree),r}get topNode(){return new xe(this,0,0,null)}resolve(t,e=0){let i=_e(hn.get(this)||this.topNode,t,e,!1);return hn.set(this,i),i}resolveInner(t,e=0){let i=_e(Po.get(this)||this.topNode,t,e,!0);return Po.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:r=this.length}=t,o=t.mode||0,l=(o&j.IncludeAnonymous)>0;for(let h=this.cursor(o|j.IncludeAnonymous);;){let a=!1;if(h.from<=r&&h.to>=n&&(!l&&h.type.isAnonymous||e(h)!==!1)){if(h.firstChild())continue;a=!0}for(;a&&i&&(l||!h.type.isAnonymous)&&i(h),!h.nextSibling();){if(!h.parent())return;a=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:Ds(st.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,n)=>new s(this.type,e,i,n,this.propValues),t.makeTree||((e,i,n)=>new s(st.none,e,i,n)))}static build(t){return ra(t)}};$.empty=new $(st.none,[],[],0);var Os=class s{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new s(this.buffer,this.index)}},we=class s{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return st.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),t+=4,i==t)return r;let o=[];for(;t<i;)o.push(this.childString(t)),t=this.buffer[t+3];return r+"("+o.join(",")+")"}findChild(t,e,i,n,r){let{buffer:o}=this,l=-1;for(let h=t;h!=e&&!(Eo(r,n,o[h+1],o[h+2])&&(l=h,i>0));h=o[h+3]);return l}slice(t,e,i){let n=this.buffer,r=new Uint16Array(e-t),o=0;for(let l=t,h=0;l<e;){r[h++]=n[l++],r[h++]=n[l++]-i;let a=r[h++]=n[l++]-i;r[h++]=n[l++]-t,o=Math.max(o,a)}return new s(r,o,this.set)}};function Eo(s,t,e,i){switch(s){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function Io(s,t){let e=s.childBefore(t);for(;e;){let i=e.lastChild;if(!i||i.to!=e.to)break;i.type.isError&&i.from==i.to?(s=e,e=i.prevSibling):e=i}return s}function _e(s,t,e,i){for(var n;s.from==s.to||(e<1?s.from>=t:s.from>t)||(e>-1?s.to<=t:s.to<t);){let o=!i&&s instanceof xe&&s.index<0?null:s.parent;if(!o)return s;s=o}let r=i?0:j.IgnoreOverlays;if(i)for(let o=s,l=o.parent;l;o=l,l=o.parent)o instanceof xe&&o.index<0&&((n=l.enter(t,e,r))===null||n===void 0?void 0:n.from)!=o.from&&(s=l);for(;;){let o=s.enter(t,e,r);if(!o)return s;s=o}}var xe=class s{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,r=0){for(let o=this;;){for(let{children:l,positions:h}=o._tree,a=e>0?l.length:-1;t!=a;t+=e){let f=l[t],u=h[t]+o.from;if(Eo(n,i,u,u+f.length)){if(f instanceof we){if(r&j.ExcludeBuffers)continue;let c=f.findChild(0,f.buffer.length,e,i-u,n);if(c>-1)return new di(new Ms(o,f,t,u),null,c)}else if(r&j.IncludeAnonymous||!f.type.isAnonymous||Ps(f)){let c;if(!(r&j.IgnoreMounts)&&f.props&&(c=f.prop(R.mounted))&&!c.overlay)return new s(c.tree,u,t,o);let d=new s(f,u,t,o);return r&j.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(e<0?f.children.length-1:0,e,i,n)}}}if(r&j.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?t=o.index+e:t=e<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&j.IgnoreOverlays)&&(n=this._tree.prop(R.mounted))&&n.overlay){let r=t-this.from;for(let{from:o,to:l}of n.overlay)if((e>0?o<=r:o<r)&&(e<0?l>=r:l>r))return new s(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new Ve(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return _e(this,t,e,!1)}resolveInner(t,e=0){return _e(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Io(this,t)}getChild(t,e=null,i=null){let n=fn(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return fn(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return un(this,t)}};function fn(s,t,e,i){let n=s.cursor(),r=[];if(!n.firstChild())return r;if(e!=null){for(;!n.type.is(e);)if(!n.nextSibling())return r}for(;;){if(i!=null&&n.type.is(i))return r;if(n.type.is(t)&&r.push(n.node),!n.nextSibling())return i==null?r:[]}}function un(s,t,e=t.length-1){for(let i=s.parent;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}var Ms=class{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}},di=class s{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return r<0?null:new s(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&j.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new s(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new s(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new s(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new Ve(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,r=i.buffer[this.index+3];if(r>n){let o=i.buffer[this.index+1];t.push(i.slice(n,r,o)),e.push(0)}return new $(this.type,t,e,this.to-this.from)}resolve(t,e=0){return _e(this,t,e,!1)}resolveInner(t,e=0){return _e(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Io(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=fn(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return fn(this,t,e,i)}get node(){return this}matchContext(t){return un(this,t)}},Ve=class{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof xe)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return t?t instanceof xe?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&j.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&j.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&j.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(e.findChild(n,this.index,-1,0,4))}else{let n=e.buffer[this.index+3];if(n<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(n.buffer.buffer[r+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let r=e+t,o=t<0?-1:i._tree.children.length;r!=o;r+=t){let l=i._tree.children[r];if(this.mode&j.IncludeAnonymous||l instanceof we||!l.type.isAnonymous||Ps(l))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let o=t;o;o=o._parent)if(o.index==n){if(n==this.index)return o;e=o,i=r+1;break t}n=this.stack[--r]}for(let n=i;n<this.stack.length;n++)e=new di(this.buffer,e,this.stack[n]);return this.bufferNode=new di(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return un(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return un(this.node,t,n);let o=i[e.buffer[this.stack[r]]];if(!o.isAnonymous){if(t[n]&&t[n]!=o.name)return!1;n--}}return!0}};function Ps(s){return s.children.some(t=>t instanceof we||!t.type.isAnonymous||Ps(t))}function ra(s){var t;let{buffer:e,nodeSet:i,maxBufferLength:n=1024,reused:r=[],minRepeatType:o=i.types.length}=s,l=Array.isArray(e)?new Os(e,e.length):e,h=i.types,a=0,f=0;function u(w,S,y,A,I){let{id:O,start:v,end:P,size:N}=l,_=f;for(;N<0;)if(l.next(),N==-1){let tt=r[O];y.push(tt),A.push(v-w);return}else if(N==-3){a=O;return}else if(N==-4){f=O;return}else throw new RangeError(`Unrecognized record size: ${N}`);let dt=h[O],Z,J,ni=v-w;if(P-v<=n&&(J=m(l.pos-S,I))){let tt=new Uint16Array(J.size-J.skip),V=l.pos-J.size,Y=tt.length;for(;l.pos>V;)Y=g(J.start,tt,Y);Z=new we(tt,P-J.start,i),ni=J.start-w}else{let tt=l.pos-N;l.next();let V=[],Y=[],ot=O>=o?O:-1,pt=0,_t=P;for(;l.pos>tt;)ot>=0&&l.id==ot&&l.size>=0?(l.end<=_t-n&&(d(V,Y,v,pt,l.end,_t,ot,_),pt=V.length,_t=l.end),l.next()):u(v,tt,V,Y,ot);if(ot>=0&&pt>0&&pt<V.length&&d(V,Y,v,pt,v,_t,ot,_),V.reverse(),Y.reverse(),ot>-1&&pt>0){let si=c(dt);Z=Ds(dt,V,Y,0,V.length,0,P-v,si,si)}else Z=p(dt,V,Y,P-v,_-P)}y.push(Z),A.push(ni)}function c(w){return(S,y,A)=>{let I=0,O=S.length-1,v,P;if(O>=0&&(v=S[O])instanceof $){if(!O&&v.type==w&&v.length==A)return v;(P=v.prop(R.lookAhead))&&(I=y[O]+v.length+P)}return p(w,S,y,A,I)}}function d(w,S,y,A,I,O,v,P){let N=[],_=[];for(;w.length>A;)N.push(w.pop()),_.push(S.pop()+y-I);w.push(p(i.types[v],N,_,O-I,P-O)),S.push(I-y)}function p(w,S,y,A,I=0,O){if(a){let v=[R.contextHash,a];O=O?[v].concat(O):[v]}if(I>25){let v=[R.lookAhead,I];O=O?[v].concat(O):[v]}return new $(w,S,y,A,O)}function m(w,S){let y=l.fork(),A=0,I=0,O=0,v=y.end-n,P={size:0,start:0,skip:0};t:for(let N=y.pos-w;y.pos>N;){let _=y.size;if(y.id==S&&_>=0){P.size=A,P.start=I,P.skip=O,O+=4,A+=4,y.next();continue}let dt=y.pos-_;if(_<0||dt<N||y.start<v)break;let Z=y.id>=o?4:0,J=y.start;for(y.next();y.pos>dt;){if(y.size<0)if(y.size==-3)Z+=4;else break t;else y.id>=o&&(Z+=4);y.next()}I=J,A+=_,O+=Z}return(S<0||A==w)&&(P.size=A,P.start=I,P.skip=O),P.size>4?P:void 0}function g(w,S,y){let{id:A,start:I,end:O,size:v}=l;if(l.next(),v>=0&&A<o){let P=y;if(v>4){let N=l.pos-(v-4);for(;l.pos>N;)y=g(w,S,y)}S[--y]=P,S[--y]=O-w,S[--y]=I-w,S[--y]=A}else v==-3?a=A:v==-4&&(f=A);return y}let b=[],D=[];for(;l.pos>0;)u(s.start||0,s.bufferStart||0,b,D,-1);let M=(t=s.length)!==null&&t!==void 0?t:b.length?D[0]+b[0].length:0;return new $(h[s.topID],b.reverse(),D.reverse(),M)}var Do=new WeakMap;function an(s,t){if(!s.isAnonymous||t instanceof we||t.type!=s)return 1;let e=Do.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=s||!(i instanceof $)){e=1;break}e+=an(s,i)}Do.set(t,e)}return e}function Ds(s,t,e,i,n,r,o,l,h){let a=0;for(let p=i;p<n;p++)a+=an(s,t[p]);let f=Math.ceil(a*1.5/8),u=[],c=[];function d(p,m,g,b,D){for(let M=g;M<b;){let w=M,S=m[M],y=an(s,p[M]);for(M++;M<b;M++){let A=an(s,p[M]);if(y+A>=f)break;y+=A}if(M==w+1){if(y>f){let A=p[w];d(A.children,A.positions,0,A.children.length,m[w]+D);continue}u.push(p[w])}else{let A=m[M-1]+p[M-1].length-S;u.push(Ds(s,p,m,w,M,S,A,null,h))}c.push(S+D-r)}}return d(t,e,i,n,0),(l||h)(u,c,o)}var ke=class s{constructor(t,e,i,n,r=!1,o=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],i=!1){let n=[new s(0,t.length,t,0,!1,i)];for(let r of e)r.to>t.length&&n.push(r);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],r=1,o=t.length?t[0]:null;for(let l=0,h=0,a=0;;l++){let f=l<e.length?e[l]:null,u=f?f.fromA:1e9;if(u-h>=i)for(;o&&o.from<u;){let c=o;if(h>=c.from||u<=c.to||a){let d=Math.max(c.from,h)-a,p=Math.min(c.to,u)-a;c=d>=p?null:new s(d,p,c.tree,c.offset+a,l>0,!!f)}if(c&&n.push(c),o.to>u)break;o=r<t.length?t[r++]:null}if(!f)break;h=f.toA,a=f.toA-f.toB}return n}},We=class{startParse(t,e,i){return typeof t=="string"&&(t=new Ts(t)),i=i?i.length?i.map(n=>new ui(n.from,n.to)):[new ui(0,0)]:[new ui(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let r=n.advance();if(r)return r}}},Ts=class{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}};var du=new R({perNode:!0});var Is=class s{constructor(t,e,i,n,r,o,l,h,a,f=0,u){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=r,this.score=o,this.buffer=l,this.bufferBase=h,this.curContext=a,this.lookAhead=f,this.parent=u}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new s(t,[],e,i,i,0,[],0,n?new cn(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let i=t>>19,n=t&65535,{parser:r}=this.p,o=r.dynamicPrecedence(n);if(o&&(this.score+=o),i==0){this.pushState(r.getGoto(this.state,n,!0),this.reducePos),n<r.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,4,!0),this.reduceContext(n,this.reducePos);return}let l=this.stack.length-(i-1)*3-(t&262144?6:0),h=l?this.stack[l-2]:this.p.ranges[0].from,a=this.reducePos-h;a>=2e3&&!(!((e=this.p.parser.nodeSet.types[n])===null||e===void 0)&&e.isAnonymous)&&(h==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=a):this.p.lastBigReductionSize<a&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=h,this.p.lastBigReductionSize=a));let f=l?this.stack[l-1]:0,u=this.bufferBase+this.buffer.length-f;if(n<r.minRepeatTerm||t&131072){let c=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,h,c,u+4,!0)}if(t&262144)this.state=this.stack[l];else{let c=this.stack[l-3];this.state=r.getGoto(c,n,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(n,h)}storeNode(t,e,i,n=4,r=!1){if(t==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,l=this.buffer.length;if(l==0&&o.parent&&(l=o.bufferBase-o.parent.bufferBase,o=o.parent),l>0&&o.buffer[l-4]==0&&o.buffer[l-1]>-1){if(e==i)return;if(o.buffer[l-2]>=e){o.buffer[l-2]=i;return}}}if(!r||this.pos==i)this.buffer.push(t,e,i,n);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0)for(;o>0&&this.buffer[o-2]>i;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,n>4&&(n-=4);this.buffer[o]=t,this.buffer[o+1]=e,this.buffer[o+2]=i,this.buffer[o+3]=n}}shift(t,e,i){let n=this.pos;if(t&131072)this.pushState(t&65535,this.pos);else if(t&262144)this.pos=i,this.shiftContext(e,n),e<=this.p.parser.maxNode&&this.buffer.push(e,n,i,4);else{let r=t,{parser:o}=this.p;(i>this.pos||e<=o.maxNode)&&(this.pos=i,o.stateFlag(r,1)||(this.reducePos=i)),this.pushState(r,n),this.shiftContext(e,n),e<=o.maxNode&&this.buffer.push(e,n,i,4)}}apply(t,e,i){t&65536?this.reduce(t):this.shift(t,e,i)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new s(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new Rs(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(i==0)return!1;if(!(i&65536))return!0;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let n=[];for(let r=0,o;r<e.length;r+=2)(o=e[r+1])!=this.state&&this.p.parser.hasAction(o,t)&&n.push(e[r],o);if(this.stack.length<120)for(let r=0;n.length<8&&r<e.length;r+=2){let o=e[r+1];n.some((l,h)=>h&1&&l==o)||n.push(e[r],o)}e=n}let i=[];for(let n=0;n<e.length&&i.length<4;n+=2){let r=e[n+1];if(r==this.state)continue;let o=this.split();o.pushState(r,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(e[n],this.pos),o.score-=200,i.push(o)}return i}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if(!(e&65536))return!1;if(!t.validAction(this.state,e)){let i=e>>19,n=e&65535,r=this.stack.length-i*3;if(r<0||t.getGoto(this.stack[r],n,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;e=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],i=(n,r)=>{if(!e.includes(n))return e.push(n),t.allActions(n,o=>{if(!(o&393216))if(o&65536){let l=(o>>19)-r;if(l>1){let h=o&65535,a=this.stack.length-l*3;if(a>=0&&t.getGoto(this.stack[a],h,!1)>=0)return l<<19|65536|h}}else{let l=i(o,r+1);if(l!=null)return l}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:t}=this.p;return t.data[t.stateSlot(this.state,1)]==65535&&!t.stateSlot(this.state,4)}restart(){this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new cn(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}},cn=class{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}},Rs=class{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=t&65535,i=t>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}},Bs=class s{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,this.index==0&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new s(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;t!=null&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new s(this.stack,this.pos,this.index)}};function pi(s,t=Uint16Array){if(typeof s!="string")return s;let e=null;for(let i=0,n=0;i<s.length;){let r=0;for(;;){let o=s.charCodeAt(i++),l=!1;if(o==126){r=65535;break}o>=92&&o--,o>=34&&o--;let h=o-32;if(h>=46&&(h-=46,l=!0),r+=h,l)break;r*=46}e?e[n++]=r:e=new t(r)}return e}var $e=class{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}},Ro=new $e,Ns=class{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Ro,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,r=this.pos+t;for(;r<i.from;){if(!n)return null;let o=this.ranges[--n];r-=i.from-o.to,i=o}for(;e<0?r>i.to:r>=i.to;){if(n==this.ranges.length-1)return null;let o=this.ranges[++n];r+=o.from-i.to,i=o}return r}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e=this.chunkOff+t,i,n;if(e>=0&&e<this.chunk.length)i=this.pos+t,n=this.chunk.charCodeAt(e);else{let r=this.resolveOffset(t,1);if(r==null)return-1;if(i=r,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let o=this.rangeIndex,l=this.range;for(;l.to<=i;)l=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-i)),n=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),n}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=Ro,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}},ie=class{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:i}=e.p;Ho(this.data,t,e,this.id,i.data,i.tokenPrecTable)}};ie.prototype.contextual=ie.prototype.fallback=ie.prototype.extend=!1;var qt=class{constructor(t,e,i){this.precTable=e,this.elseToken=i,this.data=typeof t=="string"?pi(t):t}token(t,e){let i=t.pos,n=0;for(;;){let r=t.next<0,o=t.resolveOffset(1,1);if(Ho(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(this.elseToken==null)return;if(r||n++,o==null)break;t.reset(o,t.token)}n&&(t.reset(i,t.token),t.acceptToken(this.elseToken,n))}};qt.prototype.contextual=ie.prototype.fallback=ie.prototype.extend=!1;function Ho(s,t,e,i,n,r){let o=0,l=1<<i,{dialect:h}=e.p.parser;t:for(;l&s[o];){let a=s[o+1];for(let d=o+3;d<a;d+=2)if((s[d+1]&l)>0){let p=s[d];if(h.allows(p)&&(t.token.value==-1||t.token.value==p||la(p,t.token.value,n,r))){t.acceptToken(p);break}}let f=t.next,u=0,c=s[o+2];if(t.next<0&&c>u&&s[a+c*3-3]==65535&&s[a+c*3-3]==65535){o=s[a+c*3-1];continue t}for(;u<c;){let d=u+c>>1,p=a+d+(d<<1),m=s[p],g=s[p+1]||65536;if(f<m)c=d;else if(f>=g)u=d+1;else{o=s[p+2],t.advance();continue t}}break}}function Bo(s,t,e){for(let i=t,n;(n=s[i])!=65535;i++)if(n==e)return i-t;return-1}function la(s,t,e,i){let n=Bo(e,i,t);return n<0||Bo(e,i,s)<n}var bt=typeof process!="undefined"&&process.env&&/\\bparse\\b/.test(process.env.LOG),Es=null;function No(s,t,e){let i=s.cursor(j.IncludeAnonymous);for(i.moveTo(t);;)if(!(e<0?i.childBefore(t):i.childAfter(t)))for(;;){if((e<0?i.to<t:i.from>t)&&!i.type.isError)return e<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(s.length,Math.max(i.from+1,t+25));if(e<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return e<0?0:s.length}}var Ls=class{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?No(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?No(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=i.children[n],o=this.start[e]+i.positions[n];if(o>t)return this.nextStart=o,null;if(r instanceof $){if(o==t){if(o<this.safeFrom)return null;let l=o+r.length;if(l<=this.safeTo){let h=r.prop(R.lookAhead);if(!h||l+h<this.fragment.to)return r}}this.index[e]++,o+r.length>=Math.max(this.safeFrom,t)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[e]++,this.nextStart=o+r.length}}},Fs=class{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(i=>new $e)}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:r}=n,o=n.stateSlot(t.state,3),l=t.curContext?t.curContext.hash:0,h=0;for(let a=0;a<r.length;a++){if(!(1<<a&o))continue;let f=r[a],u=this.tokens[a];if(!(i&&!f.fallback)&&((f.contextual||u.start!=t.pos||u.mask!=o||u.context!=l)&&(this.updateCachedToken(u,f,t),u.mask=o,u.context=l),u.lookAhead>u.end+25&&(h=Math.max(u.lookAhead,h)),u.value!=0)){let c=e;if(u.extended>-1&&(e=this.addActions(t,u.extended,u.end,e)),e=this.addActions(t,u.value,u.end,e),!f.extend&&(i=u,e>c))break}}for(;this.actions.length>e;)this.actions.pop();return h&&t.setLookAhead(h),!i&&t.pos==this.stream.end&&(i=new $e,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new $e,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){let n=this.stream.clipPos(i.pos);if(e.token(this.stream.reset(n,t),i),t.value>-1){let{parser:r}=i.p;for(let o=0;o<r.specialized.length;o++)if(r.specialized[o]==t.value){let l=r.specializers[o](this.stream.read(t.start,t.end),i);if(l>=0&&i.p.parser.dialect.allows(l>>1)){l&1?t.extended=l>>1:t.value=l>>1;break}}}else t.value=0,t.end=this.stream.clipPos(n+1)}putAction(t,e,i,n){for(let r=0;r<n;r+=3)if(this.actions[r]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:r}=t,{parser:o}=t.p,{data:l}=o;for(let h=0;h<2;h++)for(let a=o.stateSlot(r,h?2:1);;a+=3){if(l[a]==65535)if(l[a+1]==1)a=$t(l,a+2);else{n==0&&l[a+1]==2&&(n=this.putAction($t(l,a+2),e,i,n));break}l[a]==e&&(n=this.putAction($t(l,a+1),e,i,n))}return n}},Hs=class{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new Ns(e,n),this.tokens=new Fs(t,this.stream),this.topTerm=t.top[1];let{from:r}=n[0];this.stacks=[Is.start(this,t.top[0],r)],this.fragments=i.length&&this.stream.end-r>t.bufferLength*4?new Ls(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t=this.stacks,e=this.minStackPos,i=this.stacks=[],n,r;if(this.bigReductionCount>300&&t.length==1){let[o]=t;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<t.length;o++){let l=t[o];for(;;){if(this.tokens.mainToken=null,l.pos>e)i.push(l);else{if(this.advanceStack(l,i,t))continue;{n||(n=[],r=[]),n.push(l);let h=this.tokens.getMainToken(l);r.push(h.value,h.end)}}break}}if(!i.length){let o=n&&ha(n);if(o)return bt&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw bt&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+e);this.recovering||(this.recovering=5)}if(this.recovering&&n){let o=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,r,i);if(o)return bt&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(i.length>o)for(i.sort((l,h)=>h.score-l.score);i.length>o;)i.pop();i.some(l=>l.reducePos>e)&&this.recovering--}else if(i.length>1){t:for(let o=0;o<i.length-1;o++){let l=i[o];for(let h=o+1;h<i.length;h++){let a=i[h];if(l.sameState(a)||l.buffer.length>500&&a.buffer.length>500)if((l.score-a.score||l.buffer.length-a.buffer.length)>0)i.splice(h--,1);else{i.splice(o--,1);continue t}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let o=1;o<i.length;o++)i[o].pos<this.minStackPos&&(this.minStackPos=i[o].pos);return null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can\'t move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:r}=this,o=bt?this.stackID(t)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let a=t.curContext&&t.curContext.tracker.strict,f=a?t.curContext.hash:0;for(let u=this.fragments.nodeAt(n);u;){let c=this.parser.nodeSet.types[u.type.id]==u.type?r.getGoto(t.state,u.type.id):-1;if(c>-1&&u.length&&(!a||(u.prop(R.contextHash)||0)==f))return t.useNode(u,c),bt&&console.log(o+this.stackID(t)+` (via reuse of ${r.getName(u.type.id)})`),!0;if(!(u instanceof $)||u.children.length==0||u.positions[0]>0)break;let d=u.children[0];if(d instanceof $&&u.positions[0]==0)u=d;else break}}let l=r.stateSlot(t.state,4);if(l>0)return t.reduce(l),bt&&console.log(o+this.stackID(t)+` (via always-reduce ${r.getName(l&65535)})`),!0;if(t.stack.length>=15e3)for(;t.stack.length>9e3&&t.forceReduce(););let h=this.tokens.getActions(t);for(let a=0;a<h.length;){let f=h[a++],u=h[a++],c=h[a++],d=a==h.length||!i,p=d?t:t.split();if(p.apply(f,u,c),bt&&console.log(o+this.stackID(p)+` (via ${f&65536?`reduce of ${r.getName(f&65535)}`:"shift"} for ${r.getName(u)} @ ${n}${p==t?"":", split"})`),d)return!0;p.pos>n?e.push(p):i.push(p)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return Lo(t,e),!0}}runRecovery(t,e,i){let n=null,r=!1;for(let o=0;o<t.length;o++){let l=t[o],h=e[o<<1],a=e[(o<<1)+1],f=bt?this.stackID(l)+" -> ":"";if(l.deadEnd&&(r||(r=!0,l.restart(),bt&&console.log(f+this.stackID(l)+" (restarted)"),this.advanceFully(l,i))))continue;let u=l.split(),c=f;for(let d=0;u.forceReduce()&&d<10&&(bt&&console.log(c+this.stackID(u)+" (via force-reduce)"),!this.advanceFully(u,i));d++)bt&&(c=this.stackID(u)+" -> ");for(let d of l.recoverByInsert(h))bt&&console.log(f+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,i);this.stream.end>l.pos?(a==l.pos&&(a++,h=0),l.recoverByDelete(h,a),bt&&console.log(f+this.stackID(l)+` (via recover-delete ${this.parser.getName(h)})`),Lo(l,i)):(!n||n.score<l.score)&&(n=l)}return n}stackToTree(t){return t.close(),$.build({buffer:Bs.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(Es||(Es=new WeakMap)).get(t);return e||Es.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}};function Lo(s,t){for(let e=0;e<t.length;e++){let i=t[e];if(i.pos==s.pos&&i.sameState(s)){t[e].score<s.score&&(t[e]=s);return}}t.push(s)}var zs=class{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||this.disabled[t]==0}};var dn=class s extends We{constructor(t){if(super(),this.wrappers=[],t.version!=14)throw new RangeError(`Parser version (${t.version}) doesn\'t match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let l=0;l<t.repeatNodeCount;l++)e.push("");let i=Object.keys(t.topRules).map(l=>t.topRules[l][1]),n=[];for(let l=0;l<e.length;l++)n.push([]);function r(l,h,a){n[l].push([h,h.deserialize(String(a))])}if(t.nodeProps)for(let l of t.nodeProps){let h=l[0];typeof h=="string"&&(h=R[h]);for(let a=1;a<l.length;){let f=l[a++];if(f>=0)r(f,h,l[a++]);else{let u=l[a+-f];for(let c=-f;c>0;c--)r(l[a++],h,u);a++}}}this.nodeSet=new ci(e.map((l,h)=>st.define({name:h>=this.minRepeatTerm?void 0:l,id:h,props:n[h],top:i.indexOf(h)>-1,error:h==0,skipped:t.skippedNodes&&t.skippedNodes.indexOf(h)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=1024;let o=pi(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let l=0;l<this.specializerSpecs.length;l++)this.specialized[l]=this.specializerSpecs[l].term;this.specializers=this.specializerSpecs.map(Fo),this.states=pi(t.states,Uint32Array),this.data=pi(t.stateData),this.goto=pi(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(l=>typeof l=="number"?new ie(o,l):l),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new Hs(this,t,e,i);for(let r of this.wrappers)n=r(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let r=n[e+1];;){let o=n[r++],l=o&1,h=n[r++];if(l&&i)return h;for(let a=r+(o>>1);r<a;r++)if(n[r]==t)return h;if(l)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let r=this.stateSlot(t,n?2:1),o;;r+=3){if((o=i[r])==65535)if(i[r+1]==1)o=i[r=$t(i,r+2)];else{if(i[r+1]==2)return $t(i,r+2);break}if(o==e||o==0)return $t(i,r+1)}return 0}stateSlot(t,e){return this.states[t*6+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,i=>i==e?!0:null)}allActions(t,e){let i=this.stateSlot(t,4),n=i?e(i):void 0;for(let r=this.stateSlot(t,1);n==null;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=$t(this.data,r+2);else break;n=e($t(this.data,r+1))}return n}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=$t(this.data,i+2);else break;if(!(this.data[i+2]&1)){let n=this.data[i+1];e.some((r,o)=>o&1&&r==n)||e.push(this.data[i],n)}}return e}configure(t){let e=Object.assign(Object.create(s.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(i=>{let n=t.tokenizers.find(r=>r.from==i);return n?n.to:i})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((i,n)=>{let r=t.specializers.find(l=>l.from==i.external);if(!r)return i;let o=Object.assign(Object.assign({},i),{external:r.to});return e.specializers[n]=Fo(o),o})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),t.strict!=null&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),t.bufferLength!=null&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return e==null?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map(()=>!1);if(t)for(let r of t.split(" ")){let o=e.indexOf(r);o>=0&&(i[o]=!0)}let n=null;for(let r=0;r<e.length;r++)if(!i[r])for(let o=this.dialects[e[r]],l;(l=this.data[o++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[l]=1;return new zs(t,i,n)}static deserialize(t){return new s(t)}};function $t(s,t){return s[t]|s[t+1]<<16}function ha(s){let t=null;for(let e of s){let i=e.p.stoppedAt;(e.pos==e.p.stream.end||i!=null&&e.pos>i)&&e.p.parser.stateFlag(e.state,2)&&(!t||t.score<e.score)&&(t=e)}return t}function Fo(s){if(s.external){let t=s.extend?1:0;return(e,i)=>s.external(e,i)<<1|t}return s.get}var B=class s{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),je.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let i=[];return this.decompose(t,e,i,0),je.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new Ce(this),r=new Ce(t);for(let o=e,l=e;;){if(n.next(o),r.next(o),o=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(l+=n.value.length,n.done||l>=i)return!0}}iter(t=1){return new Ce(this,t)}iterRange(t,e=this.length){return new yn(this,t,e)}iterLines(t,e){let i;if(t==null)i=this.iter();else{e==null&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new wn(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?s.empty:t.length<=32?new yt(t):je.from(yt.split(t,[]))}},yt=class s extends B{constructor(t,e=aa(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let r=0;;r++){let o=this.text[r],l=n+o.length;if((e?i:l)>=t)return new Vs(n,l,i,o);n=l+1,i++}}decompose(t,e,i,n){let r=t<=0&&e>=this.length?this:new s(zo(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(n&1){let o=i.pop(),l=mn(r.text,o.text.slice(),0,r.length);if(l.length<=32)i.push(new s(l,o.length+r.length));else{let h=l.length>>1;i.push(new s(l.slice(0,h)),new s(l.slice(h)))}}else i.push(r)}replace(t,e,i){if(!(i instanceof s))return super.replace(t,e,i);let n=mn(this.text,mn(i.text,zo(this.text,0,t)),e),r=this.length+i.length-(e-t);return n.length<=32?new s(n,r):je.from(s.split(n,[]),r)}sliceString(t,e=this.length,i=`\n`){let n="";for(let r=0,o=0;r<=e&&o<this.text.length;o++){let l=this.text[o],h=r+l.length;r>t&&o&&(n+=i),t<h&&e>r&&(n+=l.slice(Math.max(0,t-r),e-r)),r=h+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let r of t)i.push(r),n+=r.length+1,i.length==32&&(e.push(new s(i,n)),i=[],n=-1);return n>-1&&e.push(new s(i,n)),e}},je=class s extends B{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let i of t)this.lines+=i.lines}lineInner(t,e,i,n){for(let r=0;;r++){let o=this.children[r],l=n+o.length,h=i+o.lines-1;if((e?h:l)>=t)return o.lineInner(t,e,i,n);n=l+1,i=h+1}}decompose(t,e,i,n){for(let r=0,o=0;o<=e&&r<this.children.length;r++){let l=this.children[r],h=o+l.length;if(t<=h&&e>=o){let a=n&((o<=t?1:0)|(h>=e?2:0));o>=t&&h<=e&&!a?i.push(l):l.decompose(t-o,e-o,i,a)}o=h+1}}replace(t,e,i){if(i.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let o=this.children[n],l=r+o.length;if(t>=r&&e<=l){let h=o.replace(t-r,e-r,i),a=this.lines-o.lines+h.lines;if(h.lines<a>>5-1&&h.lines>a>>5+1){let f=this.children.slice();return f[n]=h,new s(f,this.length-(e-t)+i.length)}return super.replace(r,l,h)}r=l+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i=`\n`){let n="";for(let r=0,o=0;r<this.children.length&&o<=e;r++){let l=this.children[r],h=o+l.length;o>t&&r&&(n+=i),t<h&&e>o&&(n+=l.sliceString(t-o,e-o,i)),o=h+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof s))return 0;let i=0,[n,r,o,l]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==o||r==l)return i;let h=this.children[n],a=t.children[r];if(h!=a)return i+h.scanIdentical(a,e);i+=h.length+1}}static from(t,e=t.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let d of t)i+=d.lines;if(i<32){let d=[];for(let p of t)p.flatten(d);return new yt(d,e)}let n=Math.max(32,i>>5),r=n<<1,o=n>>1,l=[],h=0,a=-1,f=[];function u(d){let p;if(d.lines>r&&d instanceof s)for(let m of d.children)u(m);else d.lines>o&&(h>o||!h)?(c(),l.push(d)):d instanceof yt&&h&&(p=f[f.length-1])instanceof yt&&d.lines+p.lines<=32?(h+=d.lines,a+=d.length+1,f[f.length-1]=new yt(p.text.concat(d.text),p.length+1+d.length)):(h+d.lines>n&&c(),h+=d.lines,a+=d.length+1,f.push(d))}function c(){h!=0&&(l.push(f.length==1?f[0]:s.from(f,a)),a=-1,h=f.length=0)}for(let d of t)u(d);return c(),l.length==1?l[0]:new s(l,e)}};B.empty=new yt([""],0);function aa(s){let t=-1;for(let e of s)t+=e.length+1;return t}function mn(s,t,e=0,i=1e9){for(let n=0,r=0,o=!0;r<s.length&&n<=i;r++){let l=s[r],h=n+l.length;h>=e&&(h>i&&(l=l.slice(0,i-n)),n<e&&(l=l.slice(e-n)),o?(t[t.length-1]+=l,o=!1):t.push(l)),n=h+1}return t}function zo(s,t,e){return mn(s,[""],t,e)}var Ce=class{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof yt?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],r=this.offsets[i],o=r>>1,l=n instanceof yt?n.text.length:n.children.length;if(o==(e>0?l:0)){if(i==0)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(e>0?0:1)){if(this.offsets[i]+=e,t==0)return this.lineBreak=!0,this.value=`\n`,this;t--}else if(n instanceof yt){let h=n.text[o+(e<0?-1:0)];if(this.offsets[i]+=e,h.length>Math.max(0,t))return this.value=t==0?h:e>0?h.slice(t):h.slice(0,h.length-t),this;t-=h.length}else{let h=n.children[o+(e<0?-1:0)];t>h.length?(t-=h.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(h),this.offsets.push(e>0?1:(h instanceof yt?h.text.length:h.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}},yn=class{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new Ce(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}},wn=class{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol!="undefined"&&(B.prototype[Symbol.iterator]=function(){return this.iter()},Ce.prototype[Symbol.iterator]=yn.prototype[Symbol.iterator]=wn.prototype[Symbol.iterator]=function(){return this});var Vs=class{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}},Ke="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(s=>s?parseInt(s,36):1);for(let s=1;s<Ke.length;s++)Ke[s]+=Ke[s-1];function fa(s){for(let t=1;t<Ke.length;t+=2)if(Ke[t]>s)return Ke[t-1]<=s;return!1}function _o(s){return s>=127462&&s<=127487}var Vo=8205;function Et(s,t,e=!0,i=!0){return(e?Uo:ua)(s,t,i)}function Uo(s,t,e){if(t==s.length)return t;t&&Go(s.charCodeAt(t))&&Jo(s.charCodeAt(t-1))&&t--;let i=bn(s,t);for(t+=Ws(i);t<s.length;){let n=bn(s,t);if(i==Vo||n==Vo||e&&fa(n))t+=Ws(n),i=n;else if(_o(n)){let r=0,o=t-2;for(;o>=0&&_o(bn(s,o));)r++,o-=2;if(r%2==0)break;t+=2}else break}return t}function ua(s,t,e){for(;t>0;){let i=Uo(s,t-2,e);if(i<t)return i;t--}return 0}function Go(s){return s>=56320&&s<57344}function Jo(s){return s>=55296&&s<56320}function bn(s,t){let e=s.charCodeAt(t);if(!Jo(e)||t+1==s.length)return e;let i=s.charCodeAt(t+1);return Go(i)?(e-55296<<10)+(i-56320)+65536:e}function Ws(s){return s<65536?1:2}var $s=/\\r\\n?|\\n/,ft=function(s){return s[s.Simple=0]="Simple",s[s.TrackDel=1]="TrackDel",s[s.TrackBefore=2]="TrackBefore",s[s.TrackAfter=3]="TrackAfter",s}(ft||(ft={})),Ae=class s{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let r=this.sections[e++],o=this.sections[e++];o<0?(t(i,n,r),n+=r):n+=o,i+=r}}iterChangedRanges(t,e=!1){qs(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new s(t)}composeDesc(t){return this.empty?t:t.empty?this:Yo(this,t)}mapDesc(t,e=!1){return t.empty?this:js(this,t,e)}mapPos(t,e=-1,i=ft.Simple){let n=0,r=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],h=this.sections[o++],a=n+l;if(h<0){if(a>t)return r+(t-n);r+=l}else{if(i!=ft.Simple&&a>=t&&(i==ft.TrackDel&&n<t&&a>t||i==ft.TrackBefore&&n<t||i==ft.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!l)return t==n||e<0?r:r+h;r+=h}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let r=this.sections[i++],o=this.sections[i++],l=n+r;if(o>=0&&n<=e&&l>=t)return n<t&&l>e?"cover":!0;n=l}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new s(t)}static create(t){return new s(t)}},wt=class s extends Ae{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return qs(this,(e,i,n,r,o)=>t=t.replace(n,n+(i-e),o),!1),t}mapDesc(t,e=!1){return js(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,r=0;n<e.length;n+=2){let o=e[n],l=e[n+1];if(l>=0){e[n]=l,e[n+1]=o;let h=n>>1;for(;i.length<h;)i.push(B.empty);i.push(o?t.slice(r,r+o):B.empty)}r+=o}return new s(e,i)}compose(t){return this.empty?t:t.empty?this:Yo(this,t,!0)}map(t,e=!1){return t.empty?this:js(this,t,e,!0)}iterChanges(t,e=!1){qs(this,t,e)}get desc(){return Ae.create(this.sections)}filter(t){let e=[],i=[],n=[],r=new Oe(this);t:for(let o=0,l=0;;){let h=o==t.length?1e9:t[o++];for(;l<h||l==h&&r.len==0;){if(r.done)break t;let f=Math.min(r.len,h-l);rt(n,f,-1);let u=r.ins==-1?-1:r.off==0?r.ins:0;rt(e,f,u),u>0&&ne(i,e,r.text),r.forward(f),l+=f}let a=t[o++];for(;l<a;){if(r.done)break t;let f=Math.min(r.len,a-l);rt(e,f,-1),rt(n,f,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(f),l+=f}}return{changes:new s(e,i),filtered:Ae.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):n==0?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],r=[],o=0,l=null;function h(f=!1){if(!f&&!n.length)return;o<e&&rt(n,e-o,-1);let u=new s(n,r);l=l?l.compose(u.map(l)):u,n=[],r=[],o=0}function a(f){if(Array.isArray(f))for(let u of f)a(u);else if(f instanceof s){if(f.length!=e)throw new RangeError(`Mismatched change set length (got ${f.length}, expected ${e})`);h(),l=l?l.compose(f.map(l)):f}else{let{from:u,to:c=u,insert:d}=f;if(u>c||u<0||c>e)throw new RangeError(`Invalid change range ${u} to ${c} (in doc of length ${e})`);let p=d?typeof d=="string"?B.of(d.split(i||$s)):d:B.empty,m=p.length;if(u==c&&m==0)return;u<o&&h(),u>o&&rt(n,u-o,-1),rt(n,c-u,m),ne(r,n,p),o=c}}return a(t),h(!l),l}static empty(t){return new s(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let r=t[n];if(typeof r=="number")e.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)e.push(r[0],0);else{for(;i.length<n;)i.push(B.empty);i[n]=B.of(r.slice(1)),e.push(r[0],i[n].length)}}}return new s(e,i)}static createSet(t,e){return new s(t,e)}};function rt(s,t,e,i=!1){if(t==0&&e<=0)return;let n=s.length-2;n>=0&&e<=0&&e==s[n+1]?s[n]+=t:t==0&&s[n]==0?s[n+1]+=e:i?(s[n]+=t,s[n+1]+=e):s.push(t,e)}function ne(s,t,e){if(e.length==0)return;let i=t.length-2>>1;if(i<s.length)s[s.length-1]=s[s.length-1].append(e);else{for(;s.length<i;)s.push(B.empty);s.push(e)}}function qs(s,t,e){let i=s.inserted;for(let n=0,r=0,o=0;o<s.sections.length;){let l=s.sections[o++],h=s.sections[o++];if(h<0)n+=l,r+=l;else{let a=n,f=r,u=B.empty;for(;a+=l,f+=h,h&&i&&(u=u.append(i[o-2>>1])),!(e||o==s.sections.length||s.sections[o+1]<0);)l=s.sections[o++],h=s.sections[o++];t(n,a,r,f,u),n=a,r=f}}}function js(s,t,e,i=!1){let n=[],r=i?[]:null,o=new Oe(s),l=new Oe(t);for(let h=-1;;)if(o.ins==-1&&l.ins==-1){let a=Math.min(o.len,l.len);rt(n,a,-1),o.forward(a),l.forward(a)}else if(l.ins>=0&&(o.ins<0||h==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!e))){let a=l.len;for(rt(n,l.ins,-1);a;){let f=Math.min(o.len,a);o.ins>=0&&h<o.i&&o.len<=f&&(rt(n,0,o.ins),r&&ne(r,n,o.text),h=o.i),o.forward(f),a-=f}l.next()}else if(o.ins>=0){let a=0,f=o.len;for(;f;)if(l.ins==-1){let u=Math.min(f,l.len);a+=u,f-=u,l.forward(u)}else if(l.ins==0&&l.len<f)f-=l.len,l.next();else break;rt(n,a,h<o.i?o.ins:0),r&&h<o.i&&ne(r,n,o.text),h=o.i,o.forward(o.len-f)}else{if(o.done&&l.done)return r?wt.createSet(n,r):Ae.create(n);throw new Error("Mismatched change set lengths")}}function Yo(s,t,e=!1){let i=[],n=e?[]:null,r=new Oe(s),o=new Oe(t);for(let l=!1;;){if(r.done&&o.done)return n?wt.createSet(i,n):Ae.create(i);if(r.ins==0)rt(i,r.len,0,l),r.next();else if(o.len==0&&!o.done)rt(i,0,o.ins,l),n&&ne(n,i,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let h=Math.min(r.len2,o.len),a=i.length;if(r.ins==-1){let f=o.ins==-1?-1:o.off?0:o.ins;rt(i,h,f,l),n&&f&&ne(n,i,o.text)}else o.ins==-1?(rt(i,r.off?0:r.len,h,l),n&&ne(n,i,r.textBit(h))):(rt(i,r.off?0:r.len,o.off?0:o.ins,l),n&&!o.off&&ne(n,i,o.text));l=(r.ins>h||o.ins>=0&&o.len>h)&&(l||i.length>a),r.forward2(h),o.forward(h)}}}}var Oe=class{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?B.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?B.empty:e[i].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}},qe=class s{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let t=this.flags&3;return t==3?null:t}get goalColumn(){let t=this.flags>>5;return t==33554431?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new s(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return T.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return T.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return T.range(t.anchor,t.head)}static create(t,e,i){return new s(t,e,i)}},T=class s{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:s.create(this.ranges.map(i=>i.map(t,e)),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new s([this.main],0)}addRange(t,e=!0){return s.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,s.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new s(t.ranges.map(e=>qe.fromJSON(e)),t.main)}static single(t,e=t){return new s([s.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=i:r.from<i)return s.normalized(t.slice(),e);i=r.to}return new s(t,e)}static cursor(t,e=0,i,n){return qe.create(t,t,(e==0?0:e<0?4:8)|(i==null?3:Math.min(2,i))|(n!=null?n:33554431)<<5)}static range(t,e,i,n){let r=(i!=null?i:33554431)<<5|(n==null?3:Math.min(2,n));return e<t?qe.create(e,t,24|r):qe.create(t,e,(e>t?4:0)|r)}static normalized(t,e=0){let i=t[e];t.sort((n,r)=>n.from-r.from),e=t.indexOf(i);for(let n=1;n<t.length;n++){let r=t[n],o=t[n-1];if(r.empty?r.from<=o.to:r.from<o.to){let l=o.from,h=Math.max(r.to,o.to);n<=e&&e--,t.splice(--n,2,r.anchor>r.head?s.range(h,l):s.range(l,h))}}return new s(t,e)}};function Xo(s,t){for(let e of s.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}var tr=0,E=class s{constructor(t,e,i,n,r){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=tr++,this.default=t([]),this.extensions=typeof r=="function"?r(this):r}static define(t={}){return new s(t.combine||(e=>e),t.compareInput||((e,i)=>e===i),t.compare||(t.combine?(e,i)=>e===i:er),!!t.static,t.enables)}of(t){return new Ue([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can\'t compute a static facet");return new Ue(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can\'t compute a static facet");return new Ue(t,this,2,e)}from(t,e){return e||(e=i=>i),this.compute([t],i=>e(i.field(t)))}};function er(s,t){return s==t||s.length==t.length&&s.every((e,i)=>e===t[i])}var Ue=class{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=tr++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,r=this.id,o=t[r]>>1,l=this.type==2,h=!1,a=!1,f=[];for(let u of this.dependencies)u=="doc"?h=!0:u=="selection"?a=!0:((e=t[u.id])!==null&&e!==void 0?e:1)&1||f.push(t[u.id]);return{create(u){return u.values[o]=i(u),1},update(u,c){if(h&&c.docChanged||a&&(c.docChanged||c.selection)||Ks(u,f)){let d=i(u);if(l?!Wo(d,u.values[o],n):!n(d,u.values[o]))return u.values[o]=d,1}return 0},reconfigure:(u,c)=>{let d,p=c.config.address[r];if(p!=null){let m=Sn(c,p);if(this.dependencies.every(g=>g instanceof E?c.facet(g)===u.facet(g):g instanceof jt?c.field(g,!1)==u.field(g,!1):!0)||(l?Wo(d=i(u),m,n):n(d=i(u),m)))return u.values[o]=m,0}else d=i(u);return u.values[o]=d,1}}}};function Wo(s,t,e){if(s.length!=t.length)return!1;for(let i=0;i<s.length;i++)if(!e(s[i],t[i]))return!1;return!0}function Ks(s,t){let e=!1;for(let i of t)mi(s,i)&1&&(e=!0);return e}function ca(s,t,e){let i=e.map(h=>s[h.id]),n=e.map(h=>h.type),r=i.filter(h=>!(h&1)),o=s[t.id]>>1;function l(h){let a=[];for(let f=0;f<i.length;f++){let u=Sn(h,i[f]);if(n[f]==2)for(let c of u)a.push(c);else a.push(u)}return t.combine(a)}return{create(h){for(let a of i)mi(h,a);return h.values[o]=l(h),1},update(h,a){if(!Ks(h,r))return 0;let f=l(h);return t.compare(f,h.values[o])?0:(h.values[o]=f,1)},reconfigure(h,a){let f=Ks(h,i),u=a.config.facets[t.id],c=a.facet(t);if(u&&!f&&er(e,u))return h.values[o]=c,0;let d=l(h);return t.compare(d,c)?(h.values[o]=c,0):(h.values[o]=d,1)}}}var $o=E.define({static:!0}),jt=class s{constructor(t,e,i,n,r){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new s(tr++,t.create,t.update,t.compare||((i,n)=>i===n),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet($o).find(i=>i.field==this);return((e==null?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:i=>(i.values[e]=this.create(i),1),update:(i,n)=>{let r=i.values[e],o=this.updateF(r,n);return this.compareF(r,o)?0:(i.values[e]=o,1)},reconfigure:(i,n)=>n.config.address[this.id]!=null?(i.values[e]=n.field(this),0):(i.values[e]=this.create(i),1)}}init(t){return[this,$o.of({field:this,create:t})]}get extension(){return this}},ve={lowest:4,low:3,default:2,high:1,highest:0};function gi(s){return t=>new xn(t,s)}var ir={highest:gi(ve.highest),high:gi(ve.high),default:gi(ve.default),low:gi(ve.low),lowest:gi(ve.lowest)},xn=class{constructor(t,e){this.inner=t,this.prec=e}},kn=class s{of(t){return new bi(this,t)}reconfigure(t){return s.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}},bi=class{constructor(t,e){this.compartment=t,this.inner=e}},vn=class s{constructor(t,e,i,n,r,o){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],r=Object.create(null),o=new Map;for(let c of da(t,e,o))c instanceof jt?n.push(c):(r[c.facet.id]||(r[c.facet.id]=[])).push(c);let l=Object.create(null),h=[],a=[];for(let c of n)l[c.id]=a.length<<1,a.push(d=>c.slot(d));let f=i==null?void 0:i.config.facets;for(let c in r){let d=r[c],p=d[0].facet,m=f&&f[c]||[];if(d.every(g=>g.type==0))if(l[p.id]=h.length<<1|1,er(m,d))h.push(i.facet(p));else{let g=p.combine(d.map(b=>b.value));h.push(i&&p.compare(g,i.facet(p))?i.facet(p):g)}else{for(let g of d)g.type==0?(l[g.id]=h.length<<1|1,h.push(g.value)):(l[g.id]=a.length<<1,a.push(b=>g.dynamicSlot(b)));l[p.id]=a.length<<1,a.push(g=>ca(g,p,d))}}let u=a.map(c=>c(l));return new s(t,o,u,l,h,r)}};function da(s,t,e){let i=[[],[],[],[],[]],n=new Map;function r(o,l){let h=n.get(o);if(h!=null){if(h<=l)return;let a=i[h].indexOf(o);a>-1&&i[h].splice(a,1),o instanceof bi&&e.delete(o.compartment)}if(n.set(o,l),Array.isArray(o))for(let a of o)r(a,l);else if(o instanceof bi){if(e.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let a=t.get(o.compartment)||o.inner;e.set(o.compartment,a),r(a,l)}else if(o instanceof xn)r(o.inner,o.prec);else if(o instanceof jt)i[l].push(o),o.provides&&r(o.provides,l);else if(o instanceof Ue)i[l].push(o),o.facet.extensions&&r(o.facet.extensions,ve.default);else{let a=o.extension;if(!a)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(a,l)}}return r(s,ve.default),i.reduce((o,l)=>o.concat(l))}function mi(s,t){if(t&1)return 2;let e=t>>1,i=s.status[e];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;s.status[e]=4;let n=s.computeSlot(s,s.config.dynamicSlots[e]);return s.status[e]=2|n}function Sn(s,t){return t&1?s.config.staticValues[t>>1]:s.values[t>>1]}var Qo=E.define(),Zo=E.define({combine:s=>s.some(t=>t),static:!0}),tl=E.define({combine:s=>s.length?s[0]:void 0,static:!0}),el=E.define(),il=E.define(),nl=E.define(),sl=E.define({combine:s=>s.length?s[0]:!1}),Kt=class{constructor(t,e){this.type=t,this.value=e}static define(){return new Us}},Us=class{of(t){return new Kt(this,t)}},Gs=class{constructor(t){this.map=t}of(t){return new K(this,t)}},K=class s{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new s(this.type,e)}is(t){return this.type==t}static define(t={}){return new Gs(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let r=n.map(e);r&&i.push(r)}return i}};K.reconfigure=K.define();K.appendConfig=K.define();var ut=class s{constructor(t,e,i,n,r,o){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,i&&Xo(i,e.newLength),r.some(l=>l.type==s.time)||(this.annotations=r.concat(s.time.of(Date.now())))}static create(t,e,i,n,r,o){return new s(t,e,i,n,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(s.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}};ut.time=Kt.define();ut.userEvent=Kt.define();ut.addToHistory=Kt.define();ut.remote=Kt.define();function pa(s,t){let e=[];for(let i=0,n=0;;){let r,o;if(i<s.length&&(n==t.length||t[n]>=s[i]))r=s[i++],o=s[i++];else if(n<t.length)r=t[n++],o=t[n++];else return e;!e.length||e[e.length-1]<r?e.push(r,o):e[e.length-1]<o&&(e[e.length-1]=o)}}function rl(s,t,e){var i;let n,r,o;return e?(n=t.changes,r=wt.empty(t.changes.length),o=s.changes.compose(t.changes)):(n=t.changes.map(s.changes),r=s.changes.mapDesc(t.changes,!0),o=s.changes.compose(n)),{changes:o,selection:t.selection?t.selection.map(r):(i=s.selection)===null||i===void 0?void 0:i.map(n),effects:K.mapEffects(s.effects,n).concat(K.mapEffects(t.effects,r)),annotations:s.annotations.length?s.annotations.concat(t.annotations):t.annotations,scrollIntoView:s.scrollIntoView||t.scrollIntoView}}function Js(s,t,e){let i=t.selection,n=Ge(t.annotations);return t.userEvent&&(n=n.concat(ut.userEvent.of(t.userEvent))),{changes:t.changes instanceof wt?t.changes:wt.of(t.changes||[],e,s.facet(tl)),selection:i&&(i instanceof T?i:T.single(i.anchor,i.head)),effects:Ge(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function ol(s,t,e){let i=Js(s,t.length?t[0]:{},s.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let r=1;r<t.length;r++){t[r].filter===!1&&(e=!1);let o=!!t[r].sequential;i=rl(i,Js(s,t[r],o?i.changes.newLength:s.doc.length),o)}let n=ut.create(s,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return ma(e?ga(n):n)}function ga(s){let t=s.startState,e=!0;for(let n of t.facet(el)){let r=n(s);if(r===!1){e=!1;break}Array.isArray(r)&&(e=e===!0?r:pa(e,r))}if(e!==!0){let n,r;if(e===!1)r=s.changes.invertedDesc,n=wt.empty(t.doc.length);else{let o=s.changes.filter(e);n=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}s=ut.create(t,n,s.selection&&s.selection.map(r),K.mapEffects(s.effects,r),s.annotations,s.scrollIntoView)}let i=t.facet(il);for(let n=i.length-1;n>=0;n--){let r=i[n](s);r instanceof ut?s=r:Array.isArray(r)&&r.length==1&&r[0]instanceof ut?s=r[0]:s=ol(t,Ge(r),!1)}return s}function ma(s){let t=s.startState,e=t.facet(nl),i=s;for(let n=e.length-1;n>=0;n--){let r=e[n](s);r&&Object.keys(r).length&&(i=rl(i,Js(t,r,s.changes.newLength),!0))}return i==s?s:ut.create(t,s.changes,s.selection,i.effects,i.annotations,i.scrollIntoView)}var ba=[];function Ge(s){return s==null?ba:Array.isArray(s)?s:[s]}var Dt=function(s){return s[s.Word=0]="Word",s[s.Space=1]="Space",s[s.Other=2]="Other",s}(Dt||(Dt={})),ya=/[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/,Ys;try{Ys=new RegExp("[\\\\p{Alphabetic}\\\\p{Number}_]","u")}catch(s){}function wa(s){if(Ys)return Ys.test(s);for(let t=0;t<s.length;t++){let e=s[t];if(/\\w/.test(e)||e>"\\x80"&&(e.toUpperCase()!=e.toLowerCase()||ya.test(e)))return!0}return!1}function xa(s){return t=>{if(!/\\S/.test(t))return Dt.Space;if(wa(t))return Dt.Word;for(let e=0;e<s.length;e++)if(t.indexOf(s[e])>-1)return Dt.Word;return Dt.Other}}var q=class s{constructor(t,e,i,n,r,o){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)mi(this,l<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(i==null){if(e)throw new RangeError("Field is not present in this state");return}return mi(this,i),Sn(this,i)}update(...t){return ol(this,t,!0)}applyTransaction(t){let e=this.config,{base:i,compartments:n}=e;for(let o of t.effects)o.is(kn.reconfigure)?(e&&(n=new Map,e.compartments.forEach((l,h)=>n.set(h,l)),e=null),n.set(o.value.compartment,o.value.extension)):o.is(K.reconfigure)?(e=null,i=o.value):o.is(K.appendConfig)&&(e=null,i=Ge(i).concat(o.value));let r;e?r=t.startState.values.slice():(e=vn.resolve(i,n,this),r=new s(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(l,h)=>h.reconfigure(l,this),null).values),new s(e,t.newDoc,t.newSelection,r,(o,l)=>l.update(o,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:T.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),r=[i.range],o=Ge(i.effects);for(let l=1;l<e.ranges.length;l++){let h=t(e.ranges[l]),a=this.changes(h.changes),f=a.map(n);for(let c=0;c<l;c++)r[c]=r[c].map(f);let u=n.mapDesc(a,!0);r.push(h.range.map(u)),n=n.compose(f),o=K.mapEffects(o,f).concat(K.mapEffects(Ge(h.effects),u))}return{changes:n,selection:T.create(r,e.mainIndex),effects:o}}changes(t=[]){return t instanceof wt?t:wt.of(t,this.doc.length,this.facet(s.lineSeparator))}toText(t){return B.of(t.split(this.facet(s.lineSeparator)||$s))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(mi(this,e),Sn(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof jt&&this.config.address[n.id]!=null&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let r in i)if(Object.prototype.hasOwnProperty.call(t,r)){let o=i[r],l=t[r];n.push(o.init(h=>o.spec.fromJSON(l,h)))}}return s.create({doc:t.doc,selection:T.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=vn.resolve(t.extensions||[],new Map),i=t.doc instanceof B?t.doc:B.of((t.doc||"").split(e.staticFacet(s.lineSeparator)||$s)),n=t.selection?t.selection instanceof T?t.selection:T.single(t.selection.anchor,t.selection.head):T.single(0);return Xo(n,i.length),e.staticFacet(Zo)||(n=n.asSingle()),new s(e,i,n,e.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(s.tabSize)}get lineBreak(){return this.facet(s.lineSeparator)||`\n`}get readOnly(){return this.facet(sl)}phrase(t,...e){for(let i of this.facet(s.phrases))if(Object.prototype.hasOwnProperty.call(i,t)){t=i[t];break}return e.length&&(t=t.replace(/\\$(\\$|\\d*)/g,(i,n)=>{if(n=="$")return"$";let r=+(n||1);return!r||r>e.length?i:e[r-1]})),t}languageDataAt(t,e,i=-1){let n=[];for(let r of this.facet(Qo))for(let o of r(this,e,i))Object.prototype.hasOwnProperty.call(o,t)&&n.push(o[t]);return n}charCategorizer(t){return xa(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),o=t-i,l=t-i;for(;o>0;){let h=Et(e,o,!1);if(r(e.slice(h,o))!=Dt.Word)break;o=h}for(;l<n;){let h=Et(e,l);if(r(e.slice(l,h))!=Dt.Word)break;l=h}return o==l?null:T.range(o+i,l+i)}};q.allowMultipleSelections=Zo;q.tabSize=E.define({combine:s=>s.length?s[0]:4});q.lineSeparator=tl;q.readOnly=sl;q.phrases=E.define({compare(s,t){let e=Object.keys(s),i=Object.keys(t);return e.length==i.length&&e.every(n=>s[n]==t[n])}});q.languageData=Qo;q.changeFilter=el;q.transactionFilter=il;q.transactionExtender=nl;kn.reconfigure=K.define();var Ut=class{eq(t){return this==t}range(t,e=t){return yi.create(t,e,this)}};Ut.prototype.startSide=Ut.prototype.endSide=0;Ut.prototype.point=!1;Ut.prototype.mapMode=ft.TrackDel;var yi=class s{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new s(t,e,i)}};function Xs(s,t){return s.from-t.from||s.value.startSide-t.value.startSide}var Qs=class s{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let r=i?this.to:this.from;for(let o=n,l=r.length;;){if(o==l)return o;let h=o+l>>1,a=r[h]-t||(i?this.value[h].endSide:this.value[h].startSide)-e;if(h==o)return a>=0?o:l;a>=0?l=h:o=h+1}}between(t,e,i,n){for(let r=this.findIndex(e,-1e9,!0),o=this.findIndex(i,1e9,!1,r);r<o;r++)if(n(this.from[r]+t,this.to[r]+t,this.value[r])===!1)return!1}map(t,e){let i=[],n=[],r=[],o=-1,l=-1;for(let h=0;h<this.value.length;h++){let a=this.value[h],f=this.from[h]+t,u=this.to[h]+t,c,d;if(f==u){let p=e.mapPos(f,a.startSide,a.mapMode);if(p==null||(c=d=p,a.startSide!=a.endSide&&(d=e.mapPos(f,a.endSide),d<c)))continue}else if(c=e.mapPos(f,a.startSide),d=e.mapPos(u,a.endSide),c>d||c==d&&a.startSide>0&&a.endSide<=0)continue;(d-c||a.endSide-a.startSide)<0||(o<0&&(o=c),a.point&&(l=Math.max(l,d-c)),i.push(a),n.push(c-o),r.push(d-o))}return{mapped:i.length?new s(n,r,i,l):null,pos:o}}},Q=class s{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new s(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:r=this.length}=t,o=t.filter;if(e.length==0&&!o)return this;if(i&&(e=e.slice().sort(Xs)),this.isEmpty)return e.length?s.of(e):this;let l=new Cn(this,null,-1).goto(0),h=0,a=[],f=new Je;for(;l.value||h<e.length;)if(h<e.length&&(l.from-e[h].from||l.startSide-e[h].value.startSide)>=0){let u=e[h++];f.addInner(u.from,u.to,u.value)||a.push(u)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(h==e.length||this.chunkEnd(l.chunkIndex)<e[h].from)&&(!o||n>this.chunkEnd(l.chunkIndex)||r<this.chunkPos[l.chunkIndex])&&f.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||n>l.to||r<l.from||o(l.from,l.to,l.value))&&(f.addInner(l.from,l.to,l.value)||a.push(yi.create(l.from,l.to,l.value))),l.next());return f.finishInner(this.nextLayer.isEmpty&&!a.length?s.empty:this.nextLayer.update({add:a,filter:o,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],h=this.chunk[o],a=t.touchesRange(l,l+h.length);if(a===!1)n=Math.max(n,h.maxPoint),e.push(h),i.push(t.mapPos(l));else if(a===!0){let{mapped:f,pos:u}=h.map(l,t);f&&(n=Math.max(n,f.maxPoint),e.push(f),i.push(u))}}let r=this.nextLayer.map(t);return e.length==0?r:new s(i,e,r||s.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],o=this.chunk[n];if(e>=r&&t<=r+o.length&&o.between(r,t-r,e-r,i)===!1)return}this.nextLayer.between(t,e,i)}}iter(t=0){return wi.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return wi.from(t).goto(e)}static compare(t,e,i,n,r=-1){let o=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),l=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),h=qo(o,l,i),a=new Se(o,h,r),f=new Se(l,h,r);i.iterGaps((u,c,d)=>jo(a,u,f,c,d,n)),i.empty&&i.length==0&&jo(a,0,f,0,0,n)}static eq(t,e,i=0,n){n==null&&(n=1e9-1);let r=t.filter(f=>!f.isEmpty&&e.indexOf(f)<0),o=e.filter(f=>!f.isEmpty&&t.indexOf(f)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let l=qo(r,o),h=new Se(r,l,0).goto(i),a=new Se(o,l,0).goto(i);for(;;){if(h.to!=a.to||!Zs(h.active,a.active)||h.point&&(!a.point||!h.point.eq(a.point)))return!1;if(h.to>n)return!0;h.next(),a.next()}}static spans(t,e,i,n,r=-1){let o=new Se(t,null,r).goto(e),l=e,h=o.openStart;for(;;){let a=Math.min(o.to,i);if(o.point){let f=o.activeForPoint(o.to),u=o.pointFrom<e?f.length+1:Math.min(f.length,h);n.point(l,a,o.point,f,u,o.pointRank),h=Math.min(o.openEnd(a),f.length)}else a>l&&(n.span(l,a,o.active,h),h=o.openEnd(a));if(o.to>i)return h+(o.point&&o.to>i?1:0);l=o.to,o.next()}}static of(t,e=!1){let i=new Je;for(let n of t instanceof yi?[t]:e?ka(t):t)i.add(n.from,n.to,n.value);return i.finish()}};Q.empty=new Q([],[],null,-1);function ka(s){if(s.length>1)for(let t=s[0],e=1;e<s.length;e++){let i=s[e];if(Xs(t,i)>0)return s.slice().sort(Xs);t=i}return s}Q.empty.nextLayer=Q.empty;var Je=class s{finishChunk(t){this.chunks.push(new Qs(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new s)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(Q.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=Q.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}};function qo(s,t,e){let i=new Map;for(let r of s)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&i.set(r.chunk[o],r.chunkPos[o]);let n=new Set;for(let r of t)for(let o=0;o<r.chunk.length;o++){let l=i.get(r.chunk[o]);l!=null&&(e?e.mapPos(l):l)==r.chunkPos[o]&&!(e!=null&&e.touchesRange(l,l+r.chunk[o].length))&&n.add(r.chunk[o])}return n}var Cn=class{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<t||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}},wi=class s{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let r=0;r<t.length;r++)for(let o=t[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&n.push(new Cn(o,e,i,r));return n.length==1?n[0]:new s(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let i=this.heap.length>>1;i>=0;i--)_s(this.heap,i);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let i=this.heap.length>>1;i>=0;i--)_s(this.heap,i);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),_s(this.heap,0)}}};function _s(s,t){for(let e=s[t];;){let i=(t<<1)+1;if(i>=s.length)break;let n=s[i];if(i+1<s.length&&n.compare(s[i+1])>=0&&(n=s[i+1],i++),e.compare(n)<0)break;s[i]=e,s[t]=n,t=i}}var Se=class{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=wi.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){pn(this.active,t),pn(this.activeTo,t),pn(this.activeRank,t),this.minActive=Ko(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=r;)e++;gn(this.active,e,i),gn(this.activeTo,e,n),gn(this.activeRank,e,r),t&&gn(t,e,this.cursor.from),this.minActive=Ko(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&pn(i,n)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(i),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let n=i.length-1;n>=0&&i[n]<t;n--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}};function jo(s,t,e,i,n,r){s.goto(t),e.goto(i);let o=i+n,l=i,h=i-t;for(;;){let a=s.to+h-e.to||s.endSide-e.endSide,f=a<0?s.to+h:e.to,u=Math.min(f,o);if(s.point||e.point?s.point&&e.point&&(s.point==e.point||s.point.eq(e.point))&&Zs(s.activeForPoint(s.to),e.activeForPoint(e.to))||r.comparePoint(l,u,s.point,e.point):u>l&&!Zs(s.active,e.active)&&r.compareRange(l,u,s.active,e.active),f>o)break;l=f,a<=0&&s.next(),a>=0&&e.next()}}function Zs(s,t){if(s.length!=t.length)return!1;for(let e=0;e<s.length;e++)if(s[e]!=t[e]&&!s[e].eq(t[e]))return!1;return!0}function pn(s,t){for(let e=t,i=s.length-1;e<i;e++)s[e]=s[e+1];s.pop()}function gn(s,t,e){for(let i=s.length-1;i>=t;i--)s[i+1]=s[i];s[t]=e}function Ko(s,t){let e=-1,i=1e9;for(let n=0;n<t.length;n++)(t[n]-i||s[n].endSide-s[e].endSide)<0&&(e=n,i=t[n]);return e}function ll(s,t,e,i){for(let n=0,r=0;;){if(r>=t)return n;if(n==s.length)break;r+=s.charCodeAt(n)==9?e-r%e:1,n=Et(s,n)}return i===!0?-1:s.length}var nr="\\u037C",hl=typeof Symbol=="undefined"?"__"+nr:Symbol.for(nr),sr=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),al=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{},Ot=class{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(o){return/^@/.test(o)?[o]:o.split(/,\\s*/)}function r(o,l,h,a){let f=[],u=/^@(\\w+)\\b/.exec(o[0]),c=u&&u[1]=="keyframes";if(u&&l==null)return h.push(o[0]+";");for(let d in l){let p=l[d];if(/&/.test(d))r(d.split(/,\\s*/).map(m=>o.map(g=>m.replace(/&/,g))).reduce((m,g)=>m.concat(g)),p,h);else if(p&&typeof p=="object"){if(!u)throw new RangeError("The value of a property ("+d+") should be a primitive value.");r(n(d),p,f,c)}else p!=null&&f.push(d.replace(/_.*/,"").replace(/[A-Z]/g,m=>"-"+m.toLowerCase())+": "+p+";")}(f.length||c)&&h.push((i&&!u&&!a?o.map(i):o).join(", ")+" {"+f.join(" ")+"}")}for(let o in t)r(n(o),t[o],this.rules)}getRules(){return this.rules.join(`\n`)}static newName(){let t=al[hl]||1;return al[hl]=t+1,nr+t.toString(36)}static mount(t,e,i){let n=t[sr],r=i&&i.nonce;n?r&&n.setNonce(r):n=new rr(t,r),n.mount(Array.isArray(e)?e:[e])}},fl=new Map,rr=class{constructor(t,e){let i=t.ownerDocument||t,n=i.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let r=fl.get(i);if(r)return t.adoptedStyleSheets=[r.sheet,...t.adoptedStyleSheets],t[sr]=r;this.sheet=new n.CSSStyleSheet,t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets],fl.set(i,this)}else{this.styleTag=i.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);let r=t.head||t;r.insertBefore(this.styleTag,r.firstChild)}this.modules=[],t[sr]=this}mount(t){let e=this.sheet,i=0,n=0;for(let r=0;r<t.length;r++){let o=t[r],l=this.modules.indexOf(o);if(l<n&&l>-1&&(this.modules.splice(l,1),n--,l=-1),l==-1){if(this.modules.splice(n++,0,o),e)for(let h=0;h<o.rules.length;h++)e.insertRule(o.rules[h],i++)}else{for(;n<l;)i+=this.modules[n++].rules.length;i+=o.rules.length,n++}}if(!e){let r="";for(let o=0;o<this.modules.length;o++)r+=this.modules[o].getRules()+`\n`;this.styleTag.textContent=r}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}};var Me={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\\\",221:"]",222:"\'"},On={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:\'"\'},wu=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),xu=typeof navigator!="undefined"&&/MSIE \\d|Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent);for(U=0;U<10;U++)Me[48+U]=Me[96+U]=String(U);var U;for(U=1;U<=24;U++)Me[U+111]="F"+U;var U;for(U=65;U<=90;U++)Me[U]=String.fromCharCode(U+32),On[U]=String.fromCharCode(U);var U;for(An in Me)On.hasOwnProperty(An)||(On[An]=Me[An]);var An;function Ln(s){let t;return s.nodeType==11?t=s.getSelection?s:s.ownerDocument:t=s,t.getSelection()}function fr(s,t){return t?s==t||s.contains(t.nodeType!=1?t.parentNode:t):!1}function Ca(s){let t=s.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function Rn(s,t){if(!t.anchorNode)return!1;try{return fr(s,t.anchorNode)}catch(e){return!1}}function Oi(s){return s.nodeType==3?Te(s,0,s.nodeValue.length).getClientRects():s.nodeType==1?s.getClientRects():[]}function Fn(s,t,e,i){return e?ul(s,t,e,i,-1)||ul(s,t,e,i,1):!1}function Hn(s){for(var t=0;;t++)if(s=s.previousSibling,!s)return t}function ul(s,t,e,i,n){for(;;){if(s==e&&t==i)return!0;if(t==(n<0?0:re(s))){if(s.nodeName=="DIV")return!1;let r=s.parentNode;if(!r||r.nodeType!=1)return!1;t=Hn(s)+(n<0?0:1),s=r}else if(s.nodeType==1){if(s=s.childNodes[t+(n<0?-1:0)],s.nodeType==1&&s.contentEditable=="false")return!1;t=n<0?re(s):0}else return!1}}function re(s){return s.nodeType==3?s.nodeValue.length:s.childNodes.length}function zr(s,t){let e=t?s.left:s.right;return{left:e,right:e,top:s.top,bottom:s.bottom}}function Aa(s){return{left:0,right:s.innerWidth,top:0,bottom:s.innerHeight}}function Oa(s,t,e,i,n,r,o,l){let h=s.ownerDocument,a=h.defaultView||window;for(let f=s,u=!1;f&&!u;)if(f.nodeType==1){let c,d=f==h.body;if(d)c=Aa(a);else{if(/^(fixed|sticky)$/.test(getComputedStyle(f).position)&&(u=!0),f.scrollHeight<=f.clientHeight&&f.scrollWidth<=f.clientWidth){f=f.assignedSlot||f.parentNode;continue}let g=f.getBoundingClientRect();c={left:g.left,right:g.left+f.clientWidth,top:g.top,bottom:g.top+f.clientHeight}}let p=0,m=0;if(n=="nearest")t.top<c.top?(m=-(c.top-t.top+o),e>0&&t.bottom>c.bottom+m&&(m=t.bottom-c.bottom+m+o)):t.bottom>c.bottom&&(m=t.bottom-c.bottom+o,e<0&&t.top-m<c.top&&(m=-(c.top+m-t.top+o)));else{let g=t.bottom-t.top,b=c.bottom-c.top;m=(n=="center"&&g<=b?t.top+g/2-b/2:n=="start"||n=="center"&&e<0?t.top-o:t.bottom-b+o)-c.top}if(i=="nearest"?t.left<c.left?(p=-(c.left-t.left+r),e>0&&t.right>c.right+p&&(p=t.right-c.right+p+r)):t.right>c.right&&(p=t.right-c.right+r,e<0&&t.left<c.left+p&&(p=-(c.left+p-t.left+r))):p=(i=="center"?t.left+(t.right-t.left)/2-(c.right-c.left)/2:i=="start"==l?t.left-r:t.right-(c.right-c.left)+r)-c.left,p||m)if(d)a.scrollBy(p,m);else{let g=0,b=0;if(m){let D=f.scrollTop;f.scrollTop+=m,b=f.scrollTop-D}if(p){let D=f.scrollLeft;f.scrollLeft+=p,g=f.scrollLeft-D}t={left:t.left-g,top:t.top-b,right:t.right-g,bottom:t.bottom-b},g&&Math.abs(g-p)<1&&(i="nearest"),b&&Math.abs(b-m)<1&&(n="nearest")}if(d)break;f=f.assignedSlot||f.parentNode}else if(f.nodeType==11)f=f.host;else break}function Ma(s){let t=s.ownerDocument;for(let e=s.parentNode;e&&e!=t.body;)if(e.nodeType==1){if(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)return e;e=e.assignedSlot||e.parentNode}else if(e.nodeType==11)e=e.host;else break;return null}var ur=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?re(e):0),i,Math.min(t.focusOffset,i?re(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}},Ye=null;function Vl(s){if(s.setActive)return s.setActive();if(Ye)return s.focus(Ye);let t=[];for(let e=s;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(s.focus(Ye==null?{get preventScroll(){return Ye={preventScroll:!0},!0}}:void 0),!Ye){Ye=!1;for(let e=0;e<t.length;){let i=t[e++],n=t[e++],r=t[e++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=r&&(i.scrollLeft=r)}}}var cl;function Te(s,t,e=t){let i=cl||(cl=document.createRange());return i.setEnd(s,e),i.setStart(s,t),i}function Ze(s,t,e){let i={key:t,code:t,keyCode:e,which:e,cancelable:!0},n=new KeyboardEvent("keydown",i);n.synthetic=!0,s.dispatchEvent(n);let r=new KeyboardEvent("keyup",i);return r.synthetic=!0,s.dispatchEvent(r),n.defaultPrevented||r.defaultPrevented}function Ta(s){for(;s;){if(s&&(s.nodeType==9||s.nodeType==11&&s.host))return s;s=s.assignedSlot||s.parentNode}return null}function Wl(s){for(;s.attributes.length;)s.removeAttributeNode(s.attributes[0])}function Pa(s,t){let e=t.focusNode,i=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=i)return!1;for(i=Math.min(i,re(e));;)if(i){if(e.nodeType!=1)return!1;let n=e.childNodes[i-1];n.contentEditable=="false"?i--:(e=n,i=re(e))}else{if(e==s)return!0;i=Hn(e),e=e.parentNode}}function $l(s){return s.scrollTop>Math.max(1,s.scrollHeight-s.clientHeight-4)}var ct=class s{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new s(t.parentNode,Hn(t),e)}static after(t,e){return new s(t.parentNode,Hn(t)+1,e)}},_r=[],z=class s{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.flags&2){let i=this.dom,n=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=n?n.nextSibling:i.firstChild)){let l=s.get(r);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(t,e),o.flags&=-8}if(r=n?n.nextSibling:i.firstChild,e&&!e.written&&e.node==i&&r!=o.dom&&(e.written=!0),o.dom.parentNode==i)for(;r&&r!=o.dom;)r=dl(r);else i.insertBefore(o.dom,r);n=o.dom}for(r=n?n.nextSibling:i.firstChild,r&&e&&e.node==i&&(e.written=!0);r;)r=dl(r)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=re(t)==0?0:e==0?-1:1;for(;;){let r=t.parentNode;if(r==this.dom)break;n==0&&r.firstChild!=r.lastChild&&(t==r.firstChild?n=-1:n=1),t=r}n<0?i=t:i=t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!s.get(i);)i=i.nextSibling;if(!i)return this.length;for(let n=0,r=0;;n++){let o=this.children[n];if(o.dom==i)return r;r+=o.length+o.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,r=-1,o=-1,l=-1;for(let h=0,a=i,f=i;h<this.children.length;h++){let u=this.children[h],c=a+u.length;if(a<t&&c>e)return u.domBoundsAround(t,e,a);if(c>=t&&n==-1&&(n=h,r=a),a>e&&u.dom.parentNode==this.dom){o=h,l=f;break}f=c,a=c+u.breakAfter}return{from:r,to:l<0?i+this.length:l,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),e.flags&1)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=_r){this.markDirty();for(let n=t;n<e;n++){let r=this.children[n];r.parent==this&&r.destroy()}this.children.splice(t,e-t,...i);for(let n=0;n<i.length;n++)i[n].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new zn(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,r,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){this.parent=null}};z.prototype.breakAfter=0;function dl(s){let t=s.nextSibling;return s.parentNode.removeChild(s),t}var zn=class{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}};function ql(s,t,e,i,n,r,o,l,h){let{children:a}=s,f=a.length?a[t]:null,u=r.length?r[r.length-1]:null,c=u?u.breakAfter:o;if(!(t==i&&f&&!o&&!c&&r.length<2&&f.merge(e,n,r.length?u:null,e==0,l,h))){if(i<a.length){let d=a[i];d&&n<d.length?(t==i&&(d=d.split(n),n=0),!c&&u&&d.merge(0,n,u,!0,0,h)?r[r.length-1]=d:(n&&d.merge(0,n,null,!1,0,h),r.push(d))):d!=null&&d.breakAfter&&(u?u.breakAfter=1:o=1),i++}for(f&&(f.breakAfter=o,e>0&&(!o&&r.length&&f.merge(e,f.length,r[0],!1,l,0)?f.breakAfter=r.shift().breakAfter:(e<f.length||f.children.length&&f.children[f.children.length-1].length==0)&&f.merge(e,f.length,null,!1,l,0),t++));t<i&&r.length;)if(a[i-1].become(r[r.length-1]))i--,r.pop(),h=r.length?0:l;else if(a[t].become(r[0]))t++,r.shift(),l=r.length?0:h;else break;!r.length&&t&&i<a.length&&!a[t-1].breakAfter&&a[i].merge(0,0,a[t-1],!1,l,h)&&t--,(t<i||r.length)&&s.replaceChildren(t,i,r)}}function jl(s,t,e,i,n,r){let o=s.childCursor(),{i:l,off:h}=o.findPos(e,1),{i:a,off:f}=o.findPos(t,-1),u=t-e;for(let c of i)u+=c.length;s.length+=u,ql(s,a,f,l,h,i,0,n,r)}var Xe="\\uFFFF",_n=class{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(q.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Xe}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let r=this.text.length;this.readNode(n);let o=n.nextSibling;if(o==e)break;let l=z.get(n),h=z.get(o);(l&&h?l.breakAfter:(l?l.breakAfter:pl(n))||pl(o)&&(n.nodeName!="BR"||n.cmIgnore)&&this.text.length>r)&&this.lineBreak(),n=o}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\\r\\n?|\\n/g;;){let r=-1,o=1,l;if(this.lineSeparator?(r=e.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(l=n.exec(e))&&(r=l.index,o=l[0].length),this.append(e.slice(i,r<0?e.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let h of this.points)h.node==t&&h.pos>this.text.length&&(h.pos-=o-1);i=r+o}}readNode(t){if(t.cmIgnore)return;let e=z.get(t),i=e&&e.overrideDOMText;if(i!=null){this.findPointInside(t,i.length);for(let n=i.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(t.nodeType==3?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+Math.min(e,i.offset))}};function pl(s){return s.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\\d|SECTION|PRE)$/.test(s.nodeName)}var Vn=class{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}},kt=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},cr=typeof document!="undefined"?document:{documentElement:{style:{}}},dr=/Edge\\/(\\d+)/.exec(kt.userAgent),Kl=/MSIE \\d/.test(kt.userAgent),pr=/Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(kt.userAgent),Xn=!!(Kl||pr||dr),gl=!Xn&&/gecko\\/(\\d+)/i.test(kt.userAgent),or=!Xn&&/Chrome\\/(\\d+)/.exec(kt.userAgent),ml="webkitFontSmoothing"in cr.documentElement.style,Ul=!Xn&&/Apple Computer/.test(kt.vendor),bl=Ul&&(/Mobile\\/\\w+/.test(kt.userAgent)||kt.maxTouchPoints>2),C={mac:bl||/Mac/.test(kt.platform),windows:/Win/.test(kt.platform),linux:/Linux|X11/.test(kt.platform),ie:Xn,ie_version:Kl?cr.documentMode||6:pr?+pr[1]:dr?+dr[1]:0,gecko:gl,gecko_version:gl?+(/Firefox\\/(\\d+)/.exec(kt.userAgent)||[0,0])[1]:0,chrome:!!or,chrome_version:or?+or[1]:0,ios:bl,android:/Android\\b/.test(kt.userAgent),webkit:ml,safari:Ul,webkit_version:ml?+(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:cr.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"},Da=256,Jt=class s extends z{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,i){return this.flags&8||i&&(!(i instanceof s)||this.length-(e-t)+i.length>Da||i.flags&8)?!1:(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new s(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=this.flags&8,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new ct(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return Ea(this.dom,t,e)}},oe=class s extends z{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let n of e)n.setParent(this)}setAttrs(t){if(Wl(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,r,o){return i&&(!(i instanceof s&&i.mark.eq(this.mark))||t&&r<=0||e<this.length&&o<=0)?!1:(jl(this,t,e,i?i.children:[],r-1,o-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,r=0;for(let l of this.children){let h=i+l.length;h>t&&e.push(i<t?l.split(t-i):l),n<0&&i>=t&&(n=r),i=h,r++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new s(this.mark,e,o)}domAtPos(t){return Gl(this,t)}coordsAt(t,e){return Yl(this,t,e)}};function Ea(s,t,e){let i=s.nodeValue.length;t>i&&(t=i);let n=t,r=t,o=0;t==0&&e<0||t==i&&e>=0?C.chrome||C.gecko||(t?(n--,o=1):r<i&&(r++,o=-1)):e<0?n--:r<i&&r++;let l=Te(s,n,r).getClientRects();if(!l.length)return null;let h=l[(o?o<0:e>=0)?0:l.length-1];return C.safari&&!o&&h.width==0&&(h=Array.prototype.find.call(l,a=>a.width)||h),o?zr(h,o<0):h||null}var Wn=class s extends z{static create(t,e,i){return new s(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=s.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,i,n,r,o){return i&&(!(i instanceof s)||!this.widget.compare(i.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t instanceof s&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return B.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):B.empty}domAtPos(t){return(this.length?t==0:this.side>0)?ct.before(this.dom):ct.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),r=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let l=o?n.length-1:0;r=n[l],!(t>0?l==0:l==n.length-1||r.top<r.bottom);l+=o?-1:1);return zr(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},Mi=class s extends z{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof s&&t.side==this.side}split(){return new s(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?ct.before(this.dom):ct.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return B.empty}get isHidden(){return!0}};Jt.prototype.children=Wn.prototype.children=Mi.prototype.children=_r;function Gl(s,t){let e=s.dom,{children:i}=s,n=0;for(let r=0;n<i.length;n++){let o=i[n],l=r+o.length;if(!(l==r&&o.getSide()<=0)){if(t>r&&t<l&&o.dom.parentNode==e)return o.domAtPos(t-r);if(t<=r)break;r=l}}for(let r=n;r>0;r--){let o=i[r-1];if(o.dom.parentNode==e)return o.domAtPos(o.length)}for(let r=n;r<i.length;r++){let o=i[r];if(o.dom.parentNode==e)return o.domAtPos(0)}return new ct(e,0)}function Jl(s,t,e){let i,{children:n}=s;e>0&&t instanceof oe&&n.length&&(i=n[n.length-1])instanceof oe&&i.mark.eq(t.mark)?Jl(i,t.children[0],e-1):(n.push(t),t.setParent(s)),s.length+=t.length}function Yl(s,t,e){let i=null,n=-1,r=null,o=-1;function l(a,f){for(let u=0,c=0;u<a.children.length&&c<=f;u++){let d=a.children[u],p=c+d.length;p>=f&&(d.children.length?l(d,f-c):(!r||r.isHidden&&e>0)&&(p>f||c==p&&d.getSide()>0)?(r=d,o=f-c):(c<f||c==p&&d.getSide()<0&&!d.isHidden)&&(i=d,n=f-c)),c=p}}l(s,t);let h=(e<0?i:r)||i||r;return h?h.coordsAt(Math.max(0,h==i?n:o),e):Ia(s)}function Ia(s){let t=s.dom.lastChild;if(!t)return s.dom.getBoundingClientRect();let e=Oi(t);return e[e.length-1]||null}function gr(s,t){for(let e in s)e=="class"&&t.class?t.class+=" "+s.class:e=="style"&&t.style?t.style+=";"+s.style:t[e]=s[e];return t}var yl=Object.create(null);function Vr(s,t,e){if(s==t)return!0;s||(s=yl),t||(t=yl);let i=Object.keys(s),n=Object.keys(t);if(i.length-(e&&i.indexOf(e)>-1?1:0)!=n.length-(e&&n.indexOf(e)>-1?1:0))return!1;for(let r of i)if(r!=e&&(n.indexOf(r)==-1||s[r]!==t[r]))return!1;return!0}function mr(s,t,e){let i=!1;if(t)for(let n in t)e&&n in e||(i=!0,n=="style"?s.style.cssText="":s.removeAttribute(n));if(e)for(let n in e)t&&t[n]==e[n]||(i=!0,n=="style"?s.style.cssText=e[n]:s.setAttribute(n,e[n]));return i}function Ra(s){let t=Object.create(null);for(let e=0;e<s.attributes.length;e++){let i=s.attributes[e];t[i.name]=i.value}return t}var ti=class{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}destroy(t){}},et=function(s){return s[s.Text=0]="Text",s[s.WidgetBefore=1]="WidgetBefore",s[s.WidgetAfter=2]="WidgetAfter",s[s.WidgetRange=3]="WidgetRange",s}(et||(et={})),St=class extends Ut{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new Ti(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new le(t,e,e,i,t.widget||null,!1)}static replace(t){let e=!!t.block,i,n;if(t.isBlockGap)i=-5e8,n=4e8;else{let{start:r,end:o}=Xl(t,e);i=(r?e?-3e8:-1:5e8)-1,n=(o?e?2e8:1:-6e8)+1}return new le(t,i,n,e,t.widget||null,!0)}static line(t){return new Pi(t)}static set(t,e=!1){return Q.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}};St.none=Q.empty;var Ti=class s extends St{constructor(t){let{start:e,end:i}=Xl(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof s&&this.tagName==t.tagName&&(this.class||((e=this.attrs)===null||e===void 0?void 0:e.class))==(t.class||((i=t.attrs)===null||i===void 0?void 0:i.class))&&Vr(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}};Ti.prototype.point=!1;var Pi=class s extends St{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof s&&this.spec.class==t.spec.class&&Vr(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}};Pi.prototype.mapMode=ft.TrackBefore;Pi.prototype.point=!0;var le=class s extends St{constructor(t,e,i,n,r,o){super(e,i,r,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?ft.TrackBefore:ft.TrackAfter:ft.TrackDel}get type(){return this.startSide<this.endSide?et.WidgetRange:this.startSide<=0?et.WidgetBefore:et.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof s&&Ba(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}};le.prototype.point=!0;function Xl(s,t=!1){let{inclusiveStart:e,inclusiveEnd:i}=s;return e==null&&(e=s.inclusive),i==null&&(i=s.inclusive),{start:e!=null?e:t,end:i!=null?i:t}}function Ba(s,t){return s==t||!!(s&&t&&s.compare(t))}function br(s,t,e,i=0){let n=e.length-1;n>=0&&e[n]+i>=s?e[n]=Math.max(e[n],t):e.push(s,t)}var xt=class s extends z{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,r,o){if(i){if(!(i instanceof s))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),jl(this,t,e,i?i.children:[],r,o),!0}split(t){let e=new s;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let r=i;r<this.children.length;r++)e.append(this.children[r],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Vr(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Jl(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=gr(e,this.attrs||{})),i&&(this.attrs=gr({class:i},this.attrs||{}))}domAtPos(t){return Gl(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?this.flags&4&&(Wl(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(mr(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&z.get(n)instanceof oe;)n=n.lastChild;if(!n||!this.length||n.nodeName!="BR"&&((i=z.get(n))===null||i===void 0?void 0:i.isEditable)==!1&&(!C.ios||!this.children.some(r=>r instanceof Jt))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let i of this.children){if(!(i instanceof Jt)||/[^ -~]/.test(i.text))return null;let n=Oi(i.dom);if(n.length!=1)return null;t+=n[0].width,e=n[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let i=Yl(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:n}=this.parent.view.viewState,r=i.bottom-i.top;if(Math.abs(r-n.lineHeight)<2&&n.textHeight<r){let o=(r-n.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(t){return!1}get type(){return et.Text}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let r=t.children[i],o=n+r.length;if(o>=e){if(r instanceof s)return r;if(o>e)break}n=o+r.breakAfter}return null}},Di=class s extends z{constructor(t,e,i){super(),this.widget=t,this.length=e,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,r,o){return i&&(!(i instanceof s)||!this.widget.compare(i.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?ct.before(this.dom):ct.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new s(this.widget,e,this.type);return i.breakAfter=this.breakAfter,i}get children(){return _r}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):B.empty}domBoundsAround(){return null}become(t){return t instanceof s&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.type=t.type,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},Si=class s{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!t.breakAfter&&!(t instanceof Di&&t.type==et.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new xt),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Mn(new Mi(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:r,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=r,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(Mn(new Jt(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,r,o){if(this.disallowBlockEffectsFor[o]&&i instanceof le){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=e-t;if(i instanceof le)if(i.block){let{type:h}=i;h==et.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Di(i.widget||new $n("div"),l,h))}else{let h=Wn.create(i.widget||new $n("span"),l,l?0:i.startSide),a=this.atCursorPos&&!h.isEditable&&r<=n.length&&(t<e||i.startSide>0),f=!h.isEditable&&(t<e||r>n.length||i.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!a&&!h.isEditable&&(this.pendingBuffer=0),this.flushBuffer(n),a&&(u.append(Mn(new Mi(1),n),r),r=n.length+Math.max(0,r-n.length)),u.append(Mn(h,n),r),this.atCursorPos=f,this.pendingBuffer=f?t<e||r>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,i,n,r){let o=new s(t,e,i,r);return o.openEnd=Q.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}};function Mn(s,t){for(let e of t)s=new oe(e,[s],s.length);return s}var $n=class extends ti{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}},Ql=E.define(),Zl=E.define(),th=E.define(),eh=E.define(),yr=E.define(),ih=E.define(),nh=E.define(),sh=E.define({combine:s=>s.some(t=>t)}),Na=E.define({combine:s=>s.some(t=>t)}),qn=class s{constructor(t,e="nearest",i="nearest",n=5,r=5){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=r}map(t){return t.empty?this:new s(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}},wl=K.define({map:(s,t)=>s.map(t)});function Gt(s,t,e){let i=s.facet(eh);i.length?i[0](t):window.onerror?window.onerror(String(t),e,void 0,void 0,t):e?console.error(e+":",t):console.error(t)}var Qn=E.define({combine:s=>s.length?s[0]:!0}),La=0,xi=E.define(),Ei=class s{constructor(t,e,i,n){this.id=t,this.create=e,this.domEventHandlers=i,this.extension=n(this)}static define(t,e){let{eventHandlers:i,provide:n,decorations:r}=e||{};return new s(La++,t,i,o=>{let l=[xi.of(o)];return r&&l.push(Ii.of(h=>{let a=h.plugin(o);return a?r(a):St.none})),n&&l.push(n(o)),l})}static fromClass(t,e){return s.define(i=>new t(i),e)}},Ci=class{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(i){if(Gt(e.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(n){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Gt(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(i){Gt(t.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}},rh=E.define(),Wr=E.define(),Ii=E.define(),$r=E.define(),oh=E.define();function xl(s,t,e){let i=s.state.facet(oh);if(!i.length)return i;let n=i.map(o=>o instanceof Function?o(s):o),r=[];return Q.spans(n,t,e,{point(){},span(o,l,h,a){let f=r;for(let u=h.length-1;u>=0;u--,a--){let c=h[u].spec.bidiIsolate,d;if(c!=null)if(a>0&&f.length&&(d=f[f.length-1]).to==o&&d.direction==c)d.to=l,f=d.inner;else{let p={from:o,to:l,direction:c,inner:[]};f.push(p),f=p.inner}}}}),r}var lh=E.define();function hh(s){let t=0,e=0,i=0,n=0;for(let r of s.state.facet(lh)){let o=r(s);o&&(o.left!=null&&(t=Math.max(t,o.left)),o.right!=null&&(e=Math.max(e,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(n=Math.max(n,o.bottom)))}return{left:t,right:e,top:i,bottom:n}}var ki=E.define(),Nt=class s{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new s(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(e.length==0)return t;let i=[];for(let n=0,r=0,o=0,l=0;;n++){let h=n==t.length?null:t[n],a=o-l,f=h?h.fromB:1e9;for(;r<e.length&&e[r]<f;){let u=e[r],c=e[r+1],d=Math.max(l,u),p=Math.min(f,c);if(d<=p&&new s(d+a,p+a,d,p).addToSet(i),c>f)break;r+=2}if(!h)return i;new s(h.fromA,h.toA,h.fromB,h.toB).addToSet(i),o=h.toA,l=h.toB}}},jn=class s{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=wt.empty(this.startState.doc.length);for(let r of i)this.changes=this.changes.compose(r.changes);let n=[];this.changes.iterChangedRanges((r,o,l,h)=>n.push(new Nt(r,o,l,h))),this.changedRanges=n}static create(t,e,i){return new s(t,e,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}},ht=function(s){return s[s.LTR=0]="LTR",s[s.RTL=1]="RTL",s}(ht||(ht={})),Ri=ht.LTR,ah=ht.RTL;function fh(s){let t=[];for(let e=0;e<s.length;e++)t.push(1<<+s[e]);return t}var Fa=fh("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Ha=fh("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),wr=Object.create(null),It=[];for(let s of["()","[]","{}"]){let t=s.charCodeAt(0),e=s.charCodeAt(1);wr[t]=e,wr[e]=-t}function za(s){return s<=247?Fa[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?Ha[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8203?256:64336<=s&&s<=65023?4:s==8204?256:1}var _a=/[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac\\ufb50-\\ufdff]/,Bt=class{get dir(){return this.level%2?ah:Ri}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,i,n){let r=-1;for(let o=0;o<t.length;o++){let l=t[o];if(l.from<=e&&l.to>=e){if(l.level==i)return o;(r<0||(n!=0?n<0?l.from<e:l.to>e:t[r].level>l.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}};function uh(s,t){if(s.length!=t.length)return!1;for(let e=0;e<s.length;e++){let i=s[e],n=t[e];if(i.from!=n.from||i.to!=n.to||i.direction!=n.direction||!uh(i.inner,n.inner))return!1}return!0}var L=[];function Va(s,t,e,i,n){for(let r=0;r<=i.length;r++){let o=r?i[r-1].to:t,l=r<i.length?i[r].from:e,h=r?256:n;for(let a=o,f=h,u=h;a<l;a++){let c=za(s.charCodeAt(a));c==512?c=f:c==8&&u==4&&(c=16),L[a]=c==4?2:c,c&7&&(u=c),f=c}for(let a=o,f=h,u=h;a<l;a++){let c=L[a];if(c==128)a<l-1&&f==L[a+1]&&f&24?c=L[a]=f:L[a]=256;else if(c==64){let d=a+1;for(;d<l&&L[d]==64;)d++;let p=a&&f==8||d<e&&L[d]==8?u==1?1:8:256;for(let m=a;m<d;m++)L[m]=p;a=d-1}else c==8&&u==1&&(L[a]=1);f=c,c&7&&(u=c)}}}function Wa(s,t,e,i,n){let r=n==1?2:1;for(let o=0,l=0,h=0;o<=i.length;o++){let a=o?i[o-1].to:t,f=o<i.length?i[o].from:e;for(let u=a,c,d,p;u<f;u++)if(d=wr[c=s.charCodeAt(u)])if(d<0){for(let m=l-3;m>=0;m-=3)if(It[m+1]==-d){let g=It[m+2],b=g&2?n:g&4?g&1?r:n:0;b&&(L[u]=L[It[m]]=b),l=m;break}}else{if(It.length==189)break;It[l++]=u,It[l++]=c,It[l++]=h}else if((p=L[u])==2||p==1){let m=p==n;h=m?0:1;for(let g=l-3;g>=0;g-=3){let b=It[g+2];if(b&2)break;if(m)It[g+2]|=2;else{if(b&4)break;It[g+2]|=4}}}}}function $a(s,t,e,i){for(let n=0,r=i;n<=e.length;n++){let o=n?e[n-1].to:s,l=n<e.length?e[n].from:t;for(let h=o;h<l;){let a=L[h];if(a==256){let f=h+1;for(;;)if(f==l){if(n==e.length)break;f=e[n++].to,l=n<e.length?e[n].from:t}else if(L[f]==256)f++;else break;let u=r==1,c=(f<t?L[f]:i)==1,d=u==c?u?1:2:i;for(let p=f,m=n,g=m?e[m-1].to:s;p>h;)p==g&&(p=e[--m].from,g=m?e[m-1].to:s),L[--p]=d;h=f}else r=a,h++}}}function xr(s,t,e,i,n,r,o){let l=i%2?2:1;if(i%2==n%2)for(let h=t,a=0;h<e;){let f=!0,u=!1;if(a==r.length||h<r[a].from){let m=L[h];m!=l&&(f=!1,u=m==16)}let c=!f&&l==1?[]:null,d=f?i:i+1,p=h;t:for(;;)if(a<r.length&&p==r[a].from){if(u)break t;let m=r[a];if(!f)for(let g=m.to,b=a+1;;){if(g==e)break t;if(b<r.length&&r[b].from==g)g=r[b++].to;else{if(L[g]==l)break t;break}}if(a++,c)c.push(m);else{m.from>h&&o.push(new Bt(h,m.from,d));let g=m.direction==Ri!=!(d%2);kr(s,g?i+1:i,n,m.inner,m.from,m.to,o),h=m.to}p=m.to}else{if(p==e||(f?L[p]!=l:L[p]==l))break;p++}c?xr(s,h,p,i+1,n,c,o):h<p&&o.push(new Bt(h,p,d)),h=p}else for(let h=e,a=r.length;h>t;){let f=!0,u=!1;if(!a||h>r[a-1].to){let m=L[h-1];m!=l&&(f=!1,u=m==16)}let c=!f&&l==1?[]:null,d=f?i:i+1,p=h;t:for(;;)if(a&&p==r[a-1].to){if(u)break t;let m=r[--a];if(!f)for(let g=m.from,b=a;;){if(g==t)break t;if(b&&r[b-1].to==g)g=r[--b].from;else{if(L[g-1]==l)break t;break}}if(c)c.push(m);else{m.to<h&&o.push(new Bt(m.to,h,d));let g=m.direction==Ri!=!(d%2);kr(s,g?i+1:i,n,m.inner,m.from,m.to,o),h=m.from}p=m.from}else{if(p==t||(f?L[p-1]!=l:L[p-1]==l))break;p--}c?xr(s,p,h,i+1,n,c,o):p<h&&o.push(new Bt(p,h,d)),h=p}}function kr(s,t,e,i,n,r,o){let l=t%2?2:1;Va(s,n,r,i,l),Wa(s,n,r,i,l),$a(n,r,i,l),xr(s,n,r,t,e,i,o)}function qa(s,t,e){if(!s)return[new Bt(0,0,t==ah?1:0)];if(t==Ri&&!e.length&&!_a.test(s))return ch(s.length);if(e.length)for(;s.length>L.length;)L[L.length]=256;let i=[],n=t==Ri?0:1;return kr(s,n,n,e,0,s.length,i),i}function ch(s){return[new Bt(0,s,0)]}var dh="";function ja(s,t,e,i,n){var r;let o=i.head-s.from,l=-1;if(o==0){if(!n||!s.length)return null;t[0].level!=e&&(o=t[0].side(!1,e),l=0)}else if(o==s.length){if(n)return null;let c=t[t.length-1];c.level!=e&&(o=c.side(!0,e),l=t.length-1)}l<0&&(l=Bt.find(t,o,(r=i.bidiLevel)!==null&&r!==void 0?r:-1,i.assoc));let h=t[l];o==h.side(n,e)&&(h=t[l+=n?1:-1],o=h.side(!n,e));let a=n==(h.dir==e),f=Et(s.text,o,a);if(dh=s.text.slice(Math.min(o,f),Math.max(o,f)),f!=h.side(n,e))return T.cursor(f+s.from,a?-1:1,h.level);let u=l==(n?t.length-1:0)?null:t[l+(n?1:-1)];return!u&&h.level!=e?T.cursor(n?s.to:s.from,n?-1:1,e):u&&u.level<h.level?T.cursor(u.side(!n,e)+s.from,n?1:-1,u.level):T.cursor(f+s.from,n?-1:1,h.level)}var Kn=class extends z{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[],this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new xt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Nt(0,0,0,t.state.doc.length)],0,null)}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every(({fromA:l,toA:h})=>h<this.minWidthFrom||l>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let i=this.view.inputState.composing<0?null:Ua(this.view,t.changes);if(this.hasComposition){this.markedForComposition.clear();let{from:l,to:h}=this.hasComposition;e=new Nt(l,h,t.changes.mapPos(l,-1),t.changes.mapPos(h,1)).addToSet(e.slice())}this.hasComposition=i?{from:i.range.fromB,to:i.range.toB}:null,(C.ie||C.chrome)&&!i&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let n=this.decorations,r=this.updateDeco(),o=Ya(n,r,t.changes);return e=Nt.extendWithRanges(e,o),!(this.flags&7)&&e.length==0?!1:(this.updateInner(e,t.startState.doc.length,i),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=C.chrome||C.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||n.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Di&&o.widget instanceof Un&&r.push(o.dom);n.updateGaps(r)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,r=this.childCursor(e);for(let o=n.length-1;;o--){let l=o>=0?n[o]:null;if(!l)break;let{fromA:h,toA:a,fromB:f,toB:u}=l,c,d,p,m;if(i&&i.range.fromB<u&&i.range.toB>f){let w=Si.build(this.view.state.doc,f,i.range.fromB,this.decorations,this.dynamicDecorationMap),S=Si.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);d=w.breakAtStart,p=w.openStart,m=S.openEnd;let y=this.compositionView(i);S.breakAtStart?y.breakAfter=1:S.content.length&&y.merge(y.length,y.length,S.content[0],!1,S.openStart,0)&&(y.breakAfter=S.content[0].breakAfter,S.content.shift()),w.content.length&&y.merge(0,0,w.content[w.content.length-1],!0,0,w.openEnd)&&w.content.pop(),c=w.content.concat(y).concat(S.content)}else({content:c,breakAtStart:d,openStart:p,openEnd:m}=Si.build(this.view.state.doc,f,u,this.decorations,this.dynamicDecorationMap));let{i:g,off:b}=r.findPos(a,1),{i:D,off:M}=r.findPos(h,-1);ql(this,D,M,g,b,c,d,p,m)}i&&this.fixCompositionDOM(i)}compositionView(t){let e=new Jt(t.text.nodeValue);e.flags|=8;for(let{deco:n}of t.marks)e=new oe(n,[e],e.length);let i=new xt;return i.append(e,0),i}fixCompositionDOM(t){let e=(r,o)=>{o.flags|=8,this.markedForComposition.add(o);let l=z.get(r);l!=o&&(l&&(l.dom=null),o.setDOM(r))},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let r=t.marks.length-1;r>=-1;r--)i=n.childPos(i.off,1),n=n.children[i.i],e(r>=0?t.marks[r].node:t.text,n)}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,r=!n&&Rn(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||r))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,h=this.domAtPos(l.anchor),a=l.empty?h:this.domAtPos(l.head);if(C.gecko&&l.empty&&!this.hasComposition&&Ka(h)){let u=document.createTextNode("");this.view.observer.ignore(()=>h.node.insertBefore(u,h.node.childNodes[h.offset]||null)),h=a=new ct(u,0),o=!0}let f=this.view.observer.selectionRange;(o||!f.focusNode||!Fn(h.node,h.offset,f.anchorNode,f.anchorOffset)||!Fn(a.node,a.offset,f.focusNode,f.focusOffset))&&(this.view.observer.ignore(()=>{C.android&&C.chrome&&this.dom.contains(f.focusNode)&&Xa(f.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=Ln(this.view.root);if(u)if(l.empty){if(C.gecko){let c=Ga(h.node,h.offset);if(c&&c!=3){let d=gh(h.node,h.offset,c==1?1:-1);d&&(h=new ct(d,c==1?0:d.nodeValue.length))}}u.collapse(h.node,h.offset),l.bidiLevel!=null&&f.caretBidiLevel!=null&&(f.caretBidiLevel=l.bidiLevel)}else if(u.extend){u.collapse(h.node,h.offset);try{u.extend(a.node,a.offset)}catch(c){}}else{let c=document.createRange();l.anchor>l.head&&([h,a]=[a,h]),c.setEnd(a.node,a.offset),c.setStart(h.node,h.offset),u.removeAllRanges(),u.addRange(c)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(h,a)),this.impreciseAnchor=h.precise?null:new ct(f.anchorNode,f.anchorOffset),this.impreciseHead=a.precise?null:new ct(f.focusNode,f.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=Ln(t.root),{anchorNode:n,anchorOffset:r}=t.observer.selectionRange;if(!i||!e.empty||!e.assoc||!i.modify)return;let o=xt.find(this,e.head);if(!o)return;let l=o.posAtStart;if(e.head==l||e.head==l+o.length)return;let h=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!h||!a||h.bottom>a.top)return;let f=this.domAtPos(e.head+e.assoc);i.collapse(f.node,f.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let u=t.observer.selectionRange;t.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=e.from&&i.collapse(n,r)}nearest(t){for(let e=t;e;){let i=z.get(e);if(i&&i.rootView==this)return i;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let n=this.children[e];if(i<n.length||n instanceof xt)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){for(let i=this.length,n=this.children.length-1;;n--){let r=this.children[n],o=i-r.breakAfter-r.length;if(t>o||t==o&&r.type!=et.WidgetBefore&&r.type!=et.WidgetAfter&&(!n||e==2||this.children[n-1].breakAfter||this.children[n-1].type==et.WidgetBefore&&e>-2))return r.coordsAt(t-o,e);i=o}}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof xt))return null;for(;n.children.length;){let{i:l,off:h}=n.childPos(i,1);for(;;l++){if(l==n.children.length)return null;if((n=n.children[l]).length)break}i=h}if(!(n instanceof Jt))return null;let r=Et(n.text,i);if(r==i)return null;let o=Te(n.dom,i,r).getClientRects();return!o.length||o[0].top>=o[0].bottom?null:o[0]}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,h=this.view.textDirection==ht.LTR;for(let a=0,f=0;f<this.children.length;f++){let u=this.children[f],c=a+u.length;if(c>n)break;if(a>=i){let d=u.dom.getBoundingClientRect();if(e.push(d.height),o){let p=u.dom.lastChild,m=p?Oi(p):[];if(m.length){let g=m[m.length-1],b=h?g.right-d.left:d.right-g.left;b>l&&(l=b,this.minWidth=r,this.minWidthFrom=a,this.minWidthTo=c)}}}a=c+u.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?ht.RTL:ht.LTR}measureTextSize(){for(let r of this.children)if(r instanceof xt){let o=r.measureTextSize();if(o)return o}let t=document.createElement("div"),e,i,n;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let r=Oi(t.firstChild)[0];e=t.getBoundingClientRect().height,i=r?r.width/27:7,n=r?r.height:e,t.remove()}),{lineHeight:e,charWidth:i,textHeight:n}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new zn(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let r=n==e.viewports.length?null:e.viewports[n],o=r?r.from-1:this.length;if(o>i){let l=e.lineBlockAt(o).bottom-e.lineBlockAt(i).top;t.push(St.replace({widget:new Un(l),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!r)break;i=r.to+1}return St.set(t)}updateDeco(){let t=this.view.state.facet(Ii).map((e,i)=>(this.dynamicDecorationMap[i]=typeof e=="function")?e(this.view):e);for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let{range:e}=t,i=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),n;if(!i)return;!e.empty&&(n=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let r=hh(this.view),o={left:i.left-r.left,top:i.top-r.top,right:i.right+r.right,bottom:i.bottom+r.bottom};Oa(this.view.scrollDOM,o,e.head<e.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==ht.LTR)}};function Ka(s){return s.node.nodeType==1&&s.node.firstChild&&(s.offset==0||s.node.childNodes[s.offset-1].contentEditable=="false")&&(s.offset==s.node.childNodes.length||s.node.childNodes[s.offset].contentEditable=="false")}var Un=class extends ti{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}};function ph(s,t){let e=s.observer.selectionRange,i=e.focusNode&&gh(e.focusNode,e.focusOffset,0);if(!i)return null;let n=z.get(i),r,o;if(n instanceof Jt)r=n.posAtStart,o=r+n.length;else{let l=Math.max(0,i.nodeValue.length-t);t:for(let h=0,a=i;;){for(let u=a.previousSibling,c;u;u=u.previousSibling){if(c=z.get(u)){o=c.posAtEnd+h,r=Math.max(0,o-l);break t}let d=new _n([],s.state);if(d.readNode(u),d.text.indexOf(Xe)>-1)return null;h+=d.text.length}if(a=a.parentNode,!a)return null;let f=z.get(a);if(f){r=f.posAtStart+h,o=r+l;break}}}return{from:r,to:o,node:i}}function Ua(s,t){let e=ph(s,t.newLength-t.length);if(!e)return null;let{from:i,to:n,node:r}=e,o=t.mapPos(i,-1),l=t.mapPos(n,1),h=r.nodeValue;if(/[\\n\\r]/.test(h))return null;if(l-o!=h.length){let c=t.mapPos(i,1),d=t.mapPos(n,-1);if(d-c==h.length)o=c,l=d;else if(s.state.doc.sliceString(l-h.length,l)==h)o=l-h.length;else if(s.state.doc.sliceString(o,o+h.length)==h)l=o+h.length;else return null}let{main:a}=s.state.selection;if(s.state.doc.sliceString(o,l)!=h||o>a.head||l<a.head)return null;let f=[],u=new Nt(i,n,o,l);for(let c=r.parentNode;;c=c.parentNode){let d=z.get(c);if(d instanceof oe)f.push({node:c,deco:d.mark});else{if(d instanceof xt||c.nodeName=="DIV"&&c.parentNode==s.contentDOM)return{range:u,text:r,marks:f,line:c};if(c!=s.contentDOM)f.push({node:c,deco:new Ti({inclusive:!0,attributes:Ra(c),tagName:c.tagName.toLowerCase()})});else return null}}}function gh(s,t,e){if(e<=0)for(let i=s,n=t;;){if(i.nodeType==3)return i;if(i.nodeType==1&&n>0)i=i.childNodes[n-1],n=re(i);else break}if(e>=0)for(let i=s,n=t;;){if(i.nodeType==3)return i;if(i.nodeType==1&&n<i.childNodes.length&&e>=0)i=i.childNodes[n],n=0;else break}return null}function Ga(s,t){return s.nodeType!=1?0:(t&&s.childNodes[t-1].contentEditable=="false"?1:0)|(t<s.childNodes.length&&s.childNodes[t].contentEditable=="false"?2:0)}var Ja=class{constructor(){this.changes=[]}compareRange(t,e){br(t,e,this.changes)}comparePoint(t,e){br(t,e,this.changes)}};function Ya(s,t,e){let i=new Ja;return Q.compare(s,t,e,i),i.changes}function Xa(s,t){for(let e=s;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function Qa(s,t,e=1){let i=s.charCategorizer(t),n=s.doc.lineAt(t),r=t-n.from;if(n.length==0)return T.cursor(t);r==0?e=1:r==n.length&&(e=-1);let o=r,l=r;e<0?o=Et(n.text,r,!1):l=Et(n.text,r);let h=i(n.text.slice(o,l));for(;o>0;){let a=Et(n.text,o,!1);if(i(n.text.slice(a,o))!=h)break;o=a}for(;l<n.length;){let a=Et(n.text,l);if(i(n.text.slice(l,a))!=h)break;l=a}return T.range(o+n.from,l+n.from)}function Za(s,t){return t.left>s?t.left-s:Math.max(0,s-t.right)}function tf(s,t){return t.top>s?t.top-s:Math.max(0,s-t.bottom)}function lr(s,t){return s.top<t.bottom-1&&s.bottom>t.top+1}function kl(s,t){return t<s.top?{top:t,left:s.left,right:s.right,bottom:s.bottom}:s}function vl(s,t){return t>s.bottom?{top:s.top,left:s.left,right:s.right,bottom:t}:s}function vr(s,t,e){let i,n,r,o,l=!1,h,a,f,u;for(let p=s.firstChild;p;p=p.nextSibling){let m=Oi(p);for(let g=0;g<m.length;g++){let b=m[g];n&&lr(n,b)&&(b=kl(vl(b,n.bottom),n.top));let D=Za(t,b),M=tf(e,b);if(D==0&&M==0)return p.nodeType==3?Sl(p,t,e):vr(p,t,e);if(!i||o>M||o==M&&r>D){i=p,n=b,r=D,o=M;let w=M?e<b.top?-1:1:D?t<b.left?-1:1:0;l=!w||(w>0?g<m.length-1:g>0)}D==0?e>b.bottom&&(!f||f.bottom<b.bottom)?(h=p,f=b):e<b.top&&(!u||u.top>b.top)&&(a=p,u=b):f&&lr(f,b)?f=vl(f,b.bottom):u&&lr(u,b)&&(u=kl(u,b.top))}}if(f&&f.bottom>=e?(i=h,n=f):u&&u.top<=e&&(i=a,n=u),!i)return{node:s,offset:0};let c=Math.max(n.left,Math.min(n.right,t));if(i.nodeType==3)return Sl(i,c,e);if(l&&i.contentEditable!="false")return vr(i,c,e);let d=Array.prototype.indexOf.call(s.childNodes,i)+(t>=(n.left+n.right)/2?1:0);return{node:s,offset:d}}function Sl(s,t,e){let i=s.nodeValue.length,n=-1,r=1e9,o=0;for(let l=0;l<i;l++){let h=Te(s,l,l+1).getClientRects();for(let a=0;a<h.length;a++){let f=h[a];if(f.top==f.bottom)continue;o||(o=t-f.left);let u=(f.top>e?f.top-e:e-f.bottom)-1;if(f.left-1<=t&&f.right+1>=t&&u<r){let c=t>=(f.left+f.right)/2,d=c;if((C.chrome||C.gecko)&&Te(s,l).getBoundingClientRect().left==f.right&&(d=!c),u<=0)return{node:s,offset:l+(d?1:0)};n=l+(d?1:0),r=u}}}return{node:s,offset:n>-1?n:o>0?s.nodeValue.length:0}}function mh(s,t,e,i=-1){var n,r;let o=s.contentDOM.getBoundingClientRect(),l=o.top+s.viewState.paddingTop,h,{docHeight:a}=s.viewState,{x:f,y:u}=t,c=u-l;if(c<0)return 0;if(c>a)return s.state.doc.length;for(let w=s.viewState.heightOracle.textHeight/2,S=!1;h=s.elementAtHeight(c),h.type!=et.Text;)for(;c=i>0?h.bottom+w:h.top-w,!(c>=0&&c<=a);){if(S)return e?null:0;S=!0,i=-i}u=l+c;let d=h.from;if(d<s.viewport.from)return s.viewport.from==0?0:e?null:Cl(s,o,h,f,u);if(d>s.viewport.to)return s.viewport.to==s.state.doc.length?s.state.doc.length:e?null:Cl(s,o,h,f,u);let p=s.dom.ownerDocument,m=s.root.elementFromPoint?s.root:p,g=m.elementFromPoint(f,u);g&&!s.contentDOM.contains(g)&&(g=null),g||(f=Math.max(o.left+1,Math.min(o.right-1,f)),g=m.elementFromPoint(f,u),g&&!s.contentDOM.contains(g)&&(g=null));let b,D=-1;if(g&&((n=s.docView.nearest(g))===null||n===void 0?void 0:n.isEditable)!=!1){if(p.caretPositionFromPoint){let w=p.caretPositionFromPoint(f,u);w&&({offsetNode:b,offset:D}=w)}else if(p.caretRangeFromPoint){let w=p.caretRangeFromPoint(f,u);w&&({startContainer:b,startOffset:D}=w,(!s.contentDOM.contains(b)||C.safari&&ef(b,D,f)||C.chrome&&nf(b,D,f))&&(b=void 0))}}if(!b||!s.docView.dom.contains(b)){let w=xt.find(s.docView,d);if(!w)return c>h.top+h.height/2?h.to:h.from;({node:b,offset:D}=vr(w.dom,f,u))}let M=s.docView.nearest(b);if(!M)return null;if(M.isWidget&&((r=M.dom)===null||r===void 0?void 0:r.nodeType)==1){let w=M.dom.getBoundingClientRect();return t.y<w.top||t.y<=w.bottom&&t.x<=(w.left+w.right)/2?M.posAtStart:M.posAtEnd}else return M.localPosFromDOM(b,D)+M.posAtStart}function Cl(s,t,e,i,n){let r=Math.round((i-t.left)*s.defaultCharacterWidth);if(s.lineWrapping&&e.height>s.defaultLineHeight*1.5){let l=s.viewState.heightOracle.textHeight,h=Math.floor((n-e.top-(s.defaultLineHeight-l)*.5)/l);r+=h*s.viewState.heightOracle.lineLength}let o=s.state.sliceDoc(e.from,e.to);return e.from+ll(o,r,s.state.tabSize)}function ef(s,t,e){let i;if(s.nodeType!=3||t!=(i=s.nodeValue.length))return!1;for(let n=s.nextSibling;n;n=n.nextSibling)if(n.nodeType!=1||n.nodeName!="BR")return!1;return Te(s,i-1,i).getBoundingClientRect().left>e}function nf(s,t,e){if(t!=0)return!1;for(let n=s;;){let r=n.parentNode;if(!r||r.nodeType!=1||r.firstChild!=n)return!1;if(r.classList.contains("cm-line"))break;n=r}let i=s.nodeType==1?s.getBoundingClientRect():Te(s,0,Math.max(s.nodeValue.length,1)).getBoundingClientRect();return e-i.left>5}function sf(s,t){let e=s.lineBlockAt(t);if(Array.isArray(e.type)){for(let i of e.type)if(i.to>t||i.to==t&&(i.to==e.to||i.type==et.Text))return i}return e}function rf(s,t,e,i){let n=sf(s,t.head),r=!i||n.type!=et.Text||!(s.lineWrapping||n.widgetLineBreaks)?null:s.coordsAtPos(t.assoc<0&&t.head>n.from?t.head-1:t.head);if(r){let o=s.dom.getBoundingClientRect(),l=s.textDirectionAt(n.from),h=s.posAtCoords({x:e==(l==ht.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(h!=null)return T.cursor(h,e?-1:1)}return T.cursor(e?n.to:n.from,e?-1:1)}function Al(s,t,e,i){let n=s.state.doc.lineAt(t.head),r=s.bidiSpans(n),o=s.textDirectionAt(n.from);for(let l=t,h=null;;){let a=ja(n,r,o,l,e),f=dh;if(!a){if(n.number==(e?s.state.doc.lines:1))return l;f=`\n`,n=s.state.doc.line(n.number+(e?1:-1)),r=s.bidiSpans(n),a=T.cursor(e?n.from:n.to)}if(h){if(!h(f))return l}else{if(!i)return a;h=i(f)}l=a}}function of(s,t,e){let i=s.state.charCategorizer(t),n=i(e);return r=>{let o=i(r);return n==Dt.Space&&(n=o),n==o}}function lf(s,t,e,i){let n=t.head,r=e?1:-1;if(n==(e?s.state.doc.length:0))return T.cursor(n,t.assoc);let o=t.goalColumn,l,h=s.contentDOM.getBoundingClientRect(),a=s.coordsAtPos(n),f=s.documentTop;if(a)o==null&&(o=a.left-h.left),l=r<0?a.top:a.bottom;else{let d=s.viewState.lineBlockAt(n);o==null&&(o=Math.min(h.right-h.left,s.defaultCharacterWidth*(n-d.from))),l=(r<0?d.top:d.bottom)+f}let u=h.left+o,c=i!=null?i:s.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=l+(c+d)*r,m=mh(s,{x:u,y:p},!1,r);if(p<h.top||p>h.bottom||(r<0?m<n:m>n))return T.cursor(m,t.assoc,void 0,o)}}function Bn(s,t,e){for(;;){let i=0;for(let n of s)n.between(t-1,t+1,(r,o,l)=>{if(t>r&&t<o){let h=i||e||(t-r<o-t?-1:1);t=h<0?r:o,i=h}});if(!i)return t}}function hr(s,t,e){let i=Bn(s.state.facet($r).map(n=>n(s)),e.from,t.head>e.from?-1:1);return i==e.from?e:T.cursor(i,i<e.from?1:-1)}var Sr=class{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let e=(i,n)=>{this.ignoreDuringComposition(n)||n.type=="keydown"&&this.keydown(t,n)||(this.mustFlushObserver(n)&&t.observer.forceFlush(),this.runCustomHandlers(n.type,t,n)?n.preventDefault():i(t,n))};for(let i in G){let n=G[i];t.contentDOM.addEventListener(i,r=>{Ol(t,r)&&e(n,r)},Ar[i]),this.registeredEvents.push(i)}t.scrollDOM.addEventListener("mousedown",i=>{if(i.target==t.scrollDOM&&i.clientY>t.contentDOM.getBoundingClientRect().bottom&&(e(G.mousedown,i),!i.defaultPrevented&&i.button==2)){let n=t.contentDOM.style.minHeight;t.contentDOM.style.minHeight="100%",setTimeout(()=>t.contentDOM.style.minHeight=n,200)}}),t.scrollDOM.addEventListener("drop",i=>{i.target==t.scrollDOM&&i.clientY>t.contentDOM.getBoundingClientRect().bottom&&e(G.drop,i)}),C.chrome&&C.chrome_version==102&&t.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=t.hasFocus,C.safari&&t.contentDOM.addEventListener("input",()=>null),C.gecko&&kf(t.contentDOM.ownerDocument)}ensureHandlers(t,e){var i;let n;this.customHandlers=[];for(let r of e)if(n=(i=r.update(t).spec)===null||i===void 0?void 0:i.domEventHandlers){this.customHandlers.push({plugin:r.value,handlers:n});for(let o in n)this.registeredEvents.indexOf(o)<0&&o!="scroll"&&(this.registeredEvents.push(o),t.contentDOM.addEventListener(o,l=>{Ol(t,l)&&this.runCustomHandlers(o,t,l)&&l.preventDefault()}))}}runCustomHandlers(t,e,i){for(let n of this.customHandlers){let r=n.handlers[t];if(r)try{if(r.call(n.plugin,i,e)||i.defaultPrevented)return!0}catch(o){Gt(e.state,o)}}return!1}runScrollHandlers(t,e){this.lastScrollTop=t.scrollDOM.scrollTop,this.lastScrollLeft=t.scrollDOM.scrollLeft;for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,e,t)}catch(r){Gt(t.state,r)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&af.indexOf(e.keyCode)<0&&(t.inputState.lastEscPress=0),C.android&&C.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return C.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((i=bh.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||hf.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=i||e,setTimeout(()=>this.flushIOSKey(t),250),!0):!1}flushIOSKey(t){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,Ze(t.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:C.safari&&!C.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}mustFlushObserver(t){return t.type=="keydown"&&t.keyCode!=229}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}},bh=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],hf="dthko",af=[16,17,18,20,91,92,224,225],Tn=6;function Pn(s){return Math.max(0,s)*.7+8}function ff(s,t){return Math.max(Math.abs(s.clientX-t.clientX),Math.abs(s.clientY-t.clientY))}var Cr=class{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParent=Ma(t.contentDOM),this.atoms=t.state.facet($r).map(o=>o(t));let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(q.allowMultipleSelections)&&uf(t,e),this.dragging=df(t,e)&&kh(e)==1?null:!1}start(t){this.dragging===!1&&(t.preventDefault(),this.select(t))}move(t){var e;if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&ff(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let i=0,n=0,r=((e=this.scrollParent)===null||e===void 0?void 0:e.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},o=hh(this.view);t.clientX-o.left<=r.left+Tn?i=-Pn(r.left-t.clientX):t.clientX+o.right>=r.right-Tn&&(i=Pn(t.clientX-r.right)),t.clientY-o.top<=r.top+Tn?n=-Pn(r.top-t.clientY):t.clientY+o.bottom>=r.bottom-Tn&&(n=Pn(t.clientY-r.bottom)),this.setScrollSpeed(i,n)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],r=null;if(n.empty){let o=Bn(this.atoms,n.from,0);o!=n.from&&(r=T.cursor(o,-1))}else{let o=Bn(this.atoms,n.from,-1),l=Bn(this.atoms,n.to,1);(o!=n.from||l!=n.to)&&(r=T.range(n.from==n.anchor?o:l,n.from==n.head?o:l))}r&&(e||(e=t.ranges.slice()),e[i]=r)}return e?T.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!i.eq(e.state.selection)||i.main.assoc!=e.state.selection.main.assoc&&this.dragging===!1)&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}};function uf(s,t){let e=s.state.facet(Ql);return e.length?e[0](t):C.mac?t.metaKey:t.ctrlKey}function cf(s,t){let e=s.state.facet(Zl);return e.length?e[0](t):C.mac?!t.altKey:!t.ctrlKey}function df(s,t){let{main:e}=s.state.selection;if(e.empty)return!1;let i=Ln(s.root);if(!i||i.rangeCount==0)return!0;let n=i.getRangeAt(0).getClientRects();for(let r=0;r<n.length;r++){let o=n[r];if(o.left<=t.clientX&&o.right>=t.clientX&&o.top<=t.clientY&&o.bottom>=t.clientY)return!0}return!1}function Ol(s,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,i;e!=s.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(i=z.get(e))&&i.ignoreEvent(t))return!1;return!0}var G=Object.create(null),Ar=Object.create(null),yh=C.ie&&C.ie_version<15||C.ios&&C.webkit_version<604;function pf(s){let t=s.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{s.focus(),e.remove(),wh(s,e.value)},50)}function wh(s,t){let{state:e}=s,i,n=1,r=e.toText(t),o=r.lines==e.selection.ranges.length;if(Or!=null&&e.selection.ranges.every(h=>h.empty)&&Or==r.toString()){let h=-1;i=e.changeByRange(a=>{let f=e.doc.lineAt(a.from);if(f.from==h)return{range:a};h=f.from;let u=e.toText((o?r.line(n++).text:t)+e.lineBreak);return{changes:{from:f.from,insert:u},range:T.cursor(a.from+u.length)}})}else o?i=e.changeByRange(h=>{let a=r.line(n++);return{changes:{from:h.from,to:h.to,insert:a.text},range:T.cursor(h.from+a.length)}}):i=e.replaceSelection(r);s.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}G.keydown=(s,t)=>{s.inputState.setSelectionOrigin("select"),t.keyCode==27&&(s.inputState.lastEscPress=Date.now())};G.touchstart=(s,t)=>{s.inputState.lastTouchTime=Date.now(),s.inputState.setSelectionOrigin("select.pointer")};G.touchmove=s=>{s.inputState.setSelectionOrigin("select.pointer")};Ar.touchstart=Ar.touchmove={passive:!0};G.mousedown=(s,t)=>{if(s.observer.flush(),s.inputState.lastTouchTime>Date.now()-2e3)return;let e=null;for(let i of s.state.facet(th))if(e=i(s,t),e)break;if(!e&&t.button==0&&(e=bf(s,t)),e){let i=!s.hasFocus;s.inputState.startMouseSelection(new Cr(s,t,e,i)),i&&s.observer.ignore(()=>Vl(s.contentDOM)),s.inputState.mouseSelection&&s.inputState.mouseSelection.start(t)}};function Ml(s,t,e,i){if(i==1)return T.cursor(t,e);if(i==2)return Qa(s.state,t,e);{let n=xt.find(s.docView,t),r=s.state.doc.lineAt(n?n.posAtEnd:t),o=n?n.posAtStart:r.from,l=n?n.posAtEnd:r.to;return l<s.state.doc.length&&l==r.to&&l++,T.range(o,l)}}var xh=(s,t)=>s>=t.top&&s<=t.bottom,Tl=(s,t,e)=>xh(t,e)&&s>=e.left&&s<=e.right;function gf(s,t,e,i){let n=xt.find(s.docView,t);if(!n)return 1;let r=t-n.posAtStart;if(r==0)return 1;if(r==n.length)return-1;let o=n.coordsAt(r,-1);if(o&&Tl(e,i,o))return-1;let l=n.coordsAt(r,1);return l&&Tl(e,i,l)?1:o&&xh(i,o)?-1:1}function Pl(s,t){let e=s.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:gf(s,e,t.clientX,t.clientY)}}var mf=C.ie&&C.ie_version<=11,Dl=null,El=0,Il=0;function kh(s){if(!mf)return s.detail;let t=Dl,e=Il;return Dl=s,Il=Date.now(),El=!t||e>Date.now()-400&&Math.abs(t.clientX-s.clientX)<2&&Math.abs(t.clientY-s.clientY)<2?(El+1)%3:1}function bf(s,t){let e=Pl(s,t),i=kh(t),n=s.state.selection;return{update(r){r.docChanged&&(e.pos=r.changes.mapPos(e.pos),n=n.map(r.changes))},get(r,o,l){let h=Pl(s,r),a,f=Ml(s,h.pos,h.bias,i);if(e.pos!=h.pos&&!o){let u=Ml(s,e.pos,e.bias,i),c=Math.min(u.from,f.from),d=Math.max(u.to,f.to);f=c<f.from?T.range(c,d):T.range(d,c)}return o?n.replaceRange(n.main.extend(f.from,f.to)):l&&i==1&&n.ranges.length>1&&(a=yf(n,h.pos))?a:l?n.addRange(f):T.create([f])}}}function yf(s,t){for(let e=0;e<s.ranges.length;e++){let{from:i,to:n}=s.ranges[e];if(i<=t&&n>=t)return T.create(s.ranges.slice(0,e).concat(s.ranges.slice(e+1)),s.mainIndex==e?0:s.mainIndex-(s.mainIndex>e?1:0))}return null}G.dragstart=(s,t)=>{let{selection:{main:e}}=s.state,{mouseSelection:i}=s.inputState;i&&(i.dragging=e),t.dataTransfer&&(t.dataTransfer.setData("Text",s.state.sliceDoc(e.from,e.to)),t.dataTransfer.effectAllowed="copyMove")};function Rl(s,t,e,i){if(!e)return;let n=s.posAtCoords({x:t.clientX,y:t.clientY},!1);t.preventDefault();let{mouseSelection:r}=s.inputState,o=i&&r&&r.dragging&&cf(s,t)?{from:r.dragging.from,to:r.dragging.to}:null,l={from:n,insert:e},h=s.state.changes(o?[o,l]:l);s.focus(),s.dispatch({changes:h,selection:{anchor:h.mapPos(n,-1),head:h.mapPos(n,1)},userEvent:o?"move.drop":"input.drop"})}G.drop=(s,t)=>{if(!t.dataTransfer)return;if(s.state.readOnly)return t.preventDefault();let e=t.dataTransfer.files;if(e&&e.length){t.preventDefault();let i=Array(e.length),n=0,r=()=>{++n==e.length&&Rl(s,t,i.filter(o=>o!=null).join(s.state.lineBreak),!1)};for(let o=0;o<e.length;o++){let l=new FileReader;l.onerror=r,l.onload=()=>{/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(l.result)||(i[o]=l.result),r()},l.readAsText(e[o])}}else Rl(s,t,t.dataTransfer.getData("Text"),!0)};G.paste=(s,t)=>{if(s.state.readOnly)return t.preventDefault();s.observer.flush();let e=yh?null:t.clipboardData;e?(wh(s,e.getData("text/plain")||e.getData("text/uri-text")),t.preventDefault()):pf(s)};function wf(s,t){let e=s.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout(()=>{i.remove(),s.focus()},50)}function xf(s){let t=[],e=[],i=!1;for(let n of s.selection.ranges)n.empty||(t.push(s.sliceDoc(n.from,n.to)),e.push(n));if(!t.length){let n=-1;for(let{from:r}of s.selection.ranges){let o=s.doc.lineAt(r);o.number>n&&(t.push(o.text),e.push({from:o.from,to:Math.min(s.doc.length,o.to+1)})),n=o.number}i=!0}return{text:t.join(s.lineBreak),ranges:e,linewise:i}}var Or=null;G.copy=G.cut=(s,t)=>{let{text:e,ranges:i,linewise:n}=xf(s.state);if(!e&&!n)return;Or=n?e:null;let r=yh?null:t.clipboardData;r?(t.preventDefault(),r.clearData(),r.setData("text/plain",e)):wf(s,e),t.type=="cut"&&!s.state.readOnly&&s.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})};var vh=Kt.define();function Sh(s,t){let e=[];for(let i of s.facet(nh)){let n=i(s,t);n&&e.push(n)}return e?s.update({effects:e,annotations:vh.of(!0)}):null}function Ch(s){setTimeout(()=>{let t=s.hasFocus;if(t!=s.inputState.notifiedFocused){let e=Sh(s.state,t);e?s.dispatch(e):s.update([])}},10)}G.focus=s=>{s.inputState.lastFocusTime=Date.now(),!s.scrollDOM.scrollTop&&(s.inputState.lastScrollTop||s.inputState.lastScrollLeft)&&(s.scrollDOM.scrollTop=s.inputState.lastScrollTop,s.scrollDOM.scrollLeft=s.inputState.lastScrollLeft),Ch(s)};G.blur=s=>{s.observer.clearSelectionRange(),Ch(s)};G.compositionstart=G.compositionupdate=s=>{s.inputState.compositionFirstChange==null&&(s.inputState.compositionFirstChange=!0),s.inputState.composing<0&&(s.inputState.composing=0)};G.compositionend=s=>{s.inputState.composing=-1,s.inputState.compositionEndedAt=Date.now(),s.inputState.compositionPendingKey=!0,s.inputState.compositionPendingChange=s.observer.pendingRecords().length>0,s.inputState.compositionFirstChange=null,C.chrome&&C.android?s.observer.flushSoon():s.inputState.compositionPendingChange?Promise.resolve().then(()=>s.observer.flush()):setTimeout(()=>{s.inputState.composing<0&&s.docView.hasComposition&&s.update([])},50)};G.contextmenu=s=>{s.inputState.lastContextMenu=Date.now()};G.beforeinput=(s,t)=>{var e;let i;if(C.chrome&&C.android&&(i=bh.find(n=>n.inputType==t.inputType))&&(s.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let n=((e=window.visualViewport)===null||e===void 0?void 0:e.height)||0;setTimeout(()=>{var r;(((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0)>n+10&&s.hasFocus&&(s.contentDOM.blur(),s.focus())},100)}};var Bl=new Set;function kf(s){Bl.has(s)||(Bl.add(s),s.addEventListener("copy",()=>{}),s.addEventListener("cut",()=>{}))}var Nl=["pre-wrap","normal","pre-line","break-spaces"],Mr=class{constructor(t){this.lineWrapping=t,this.doc=B.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Nl.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(n*10)]||(e=!0,this.heightSamples[Math.floor(n*10)]=!0)}return e}refresh(t,e,i,n,r,o){let l=Nl.indexOf(t)>-1,h=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=r,h){this.heightSamples={};for(let a=0;a<o.length;a++){let f=o[a];f<0?a++:this.heightSamples[Math.floor(f*10)]=!0}}return h}},Tr=class{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}},Rt=class s{constructor(t,e,i,n,r){this.from=t,this.length=e,this.top=i,this.height=n,this._content=r}get type(){return typeof this._content=="number"?et.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof le?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new s(this.from,this.length+t.length,this.top,this.height+t.height,e)}},H=function(s){return s[s.ByPos=0]="ByPos",s[s.ByHeight=1]="ByHeight",s[s.ByPosNoHeight=2]="ByPosNoHeight",s}(H||(H={})),Nn=.001,vt=class s{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>Nn&&(t.heightChanged=!0),this.height=e)}replace(t,e,i){return s.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let r=this,o=i.doc;for(let l=n.length-1;l>=0;l--){let{fromA:h,toA:a,fromB:f,toB:u}=n[l],c=r.lineAt(h,H.ByPosNoHeight,i.setDoc(e),0,0),d=c.to>=a?c:r.lineAt(a,H.ByPosNoHeight,i,0,0);for(u+=d.to-a,a=d.to;l>0&&c.from<=n[l-1].toA;)h=n[l-1].fromA,f=n[l-1].fromB,l--,h<c.from&&(c=r.lineAt(h,H.ByPosNoHeight,i,0,0));f+=c.from-h,h=c.from;let p=Dr.build(i.setDoc(o),t,f,u);r=r.replace(h,a,p)}return r.updateHeight(i,0)}static empty(){return new Mt(0,0)}static of(t){if(t.length==1)return t[0];let e=0,i=t.length,n=0,r=0;for(;;)if(e==i)if(n>r*2){let l=t[e-1];l.break?t.splice(--e,1,l.left,null,l.right):t.splice(--e,1,l.left,l.right),i+=1+l.break,n-=l.size}else if(r>n*2){let l=t[i];l.break?t.splice(i,1,l.left,null,l.right):t.splice(i,1,l.left,l.right),i+=2+l.break,r-=l.size}else break;else if(n<r){let l=t[e++];l&&(n+=l.size)}else{let l=t[--i];l&&(r+=l.size)}let o=0;return t[e-1]==null?(o=1,e--):t[e]==null&&(o=1,i++),new Pr(s.of(t.slice(0,e)),o,s.of(t.slice(i)))}};vt.prototype.size=1;var Gn=class extends vt{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new Rt(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,r){return this.blockAt(0,i,n,r)}forEachLine(t,e,i,n,r,o){t<=r+this.length&&e>=r&&o(this.blockAt(0,i,n,r))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(t,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},Mt=class s extends Gn{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new Rt(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return i.length==1&&(n instanceof s||n instanceof se&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof se?n=new s(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):vt.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(t,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},se=class s extends vt{constructor(t){super(t,0)}heightMetrics(t,e){let i=t.doc.lineAt(e).number,n=t.doc.lineAt(e+this.length).number,r=n-i+1,o,l=0;if(t.lineWrapping){let h=Math.min(this.height,t.lineHeight*r);o=h/r,this.length>r+1&&(l=(this.height-h)/(this.length-r-1))}else o=this.height/r;return{firstLine:i,lastLine:n,perLine:o,perChar:l}}blockAt(t,e,i,n){let{firstLine:r,lastLine:o,perLine:l,perChar:h}=this.heightMetrics(e,n);if(e.lineWrapping){let a=n+Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length),f=e.doc.lineAt(a),u=l+f.length*h,c=Math.max(i,t-u/2);return new Rt(f.from,f.length,c,u,0)}else{let a=Math.max(0,Math.min(o-r,Math.floor((t-i)/l))),{from:f,length:u}=e.doc.line(r+a);return new Rt(f,u,i+l*a,l,0)}}lineAt(t,e,i,n,r){if(e==H.ByHeight)return this.blockAt(t,i,n,r);if(e==H.ByPosNoHeight){let{from:d,to:p}=i.doc.lineAt(t);return new Rt(d,p-d,0,0,0)}let{firstLine:o,perLine:l,perChar:h}=this.heightMetrics(i,r),a=i.doc.lineAt(t),f=l+a.length*h,u=a.number-o,c=n+l*u+h*(a.from-r-u);return new Rt(a.from,a.length,Math.max(n,Math.min(c,n+this.height-f)),f,0)}forEachLine(t,e,i,n,r,o){t=Math.max(t,r),e=Math.min(e,r+this.length);let{firstLine:l,perLine:h,perChar:a}=this.heightMetrics(i,r);for(let f=t,u=n;f<=e;){let c=i.doc.lineAt(f);if(f==t){let p=c.number-l;u+=h*p+a*(t-r-p)}let d=h+a*c.length;o(new Rt(c.from,c.length,u,d,0)),u+=d,f=c.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let r=i[i.length-1];r instanceof s?i[i.length-1]=new s(r.length+n):i.push(null,new s(n-1))}if(t>0){let r=i[0];r instanceof s?i[0]=new s(t+r.length):i.unshift(new s(t-1),null)}return vt.of(i)}decomposeLeft(t,e){e.push(new s(t-1),null)}decomposeRight(t,e){e.push(null,new s(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let r=e+this.length;if(n&&n.from<=e+this.length&&n.more){let o=[],l=Math.max(e,n.from),h=-1;for(n.from>e&&o.push(new s(n.from-e-1).updateHeight(t,e));l<=r&&n.more;){let f=t.doc.lineAt(l).length;o.length&&o.push(null);let u=n.heights[n.index++];h==-1?h=u:Math.abs(u-h)>=Nn&&(h=-2);let c=new Mt(f,u);c.outdated=!1,o.push(c),l+=f+1}l<=r&&o.push(null,new s(r-l).updateHeight(t,l));let a=vt.of(o);return(h<0||Math.abs(a.height-this.height)>=Nn||Math.abs(h-this.heightMetrics(t,e).perLine)>=Nn)&&(t.heightChanged=!0),a}else(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}},Pr=class extends vt{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return this.flags&1}blockAt(t,e,i,n){let r=i+this.left.height;return t<r?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,r,n+this.left.length+this.break)}lineAt(t,e,i,n,r){let o=n+this.left.height,l=r+this.left.length+this.break,h=e==H.ByHeight?t<o:t<l,a=h?this.left.lineAt(t,e,i,n,r):this.right.lineAt(t,e,i,o,l);if(this.break||(h?a.to<l:a.from>l))return a;let f=e==H.ByPosNoHeight?H.ByPosNoHeight:H.ByPos;return h?a.join(this.right.lineAt(l,f,i,o,l)):this.left.lineAt(l,f,i,n,r).join(a)}forEachLine(t,e,i,n,r,o){let l=n+this.left.height,h=r+this.left.length+this.break;if(this.break)t<h&&this.left.forEachLine(t,e,i,n,r,o),e>=h&&this.right.forEachLine(t,e,i,l,h,o);else{let a=this.lineAt(h,H.ByPos,i,n,r);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,r,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,l,h,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let r=[];t>0&&this.decomposeLeft(t,r);let o=r.length;for(let l of i)r.push(l);if(t>0&&Ll(r,o-1),e<this.length){let l=r.length;this.decomposeRight(e,r),Ll(r,l)}return vt.of(r)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?vt.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:r,right:o}=this,l=e+r.length+this.break,h=null;return n&&n.from<=e+r.length&&n.more?h=r=r.updateHeight(t,e,i,n):r.updateHeight(t,e,i),n&&n.from<=l+o.length&&n.more?h=o=o.updateHeight(t,l,i,n):o.updateHeight(t,l,i),h?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}};function Ll(s,t){let e,i;s[t]==null&&(e=s[t-1])instanceof se&&(i=s[t+1])instanceof se&&s.splice(t-1,3,new se(e.length+1+i.length))}var vf=5,Dr=class s{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let i=Math.min(e,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof Mt?n.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Mt(i-this.pos,-1)),this.writtenTo=i,e>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,r=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new Gn(o,n,i)):(o||r||n>=vf)&&this.addLineDeco(n,r,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Mt(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new se(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Mt)return t;let e=new Mt(0,-1);return this.nodes.push(e),e}addBlock(t){var e;this.enterLine();let i=(e=t.deco)===null||e===void 0?void 0:e.type;i==et.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,i!=et.WidgetBefore&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof Mt)&&!this.isCovered?this.nodes.push(new Mt(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=t;for(let n of this.nodes)n instanceof Mt&&n.updateHeight(this.oracle,i),i+=n?n.length:1;return this.nodes}static build(t,e,i,n){let r=new s(i,t);return Q.spans(e,i,n,r,0),r.finish(i)}};function Sf(s,t,e){let i=new Er;return Q.compare(s,t,e,i,0),i.changes}var Er=class{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&br(t,e,this.changes,5)}};function Cf(s,t){let e=s.getBoundingClientRect(),i=s.ownerDocument,n=i.defaultView||window,r=Math.max(0,e.left),o=Math.min(n.innerWidth,e.right),l=Math.max(0,e.top),h=Math.min(n.innerHeight,e.bottom);for(let a=s.parentNode;a&&a!=i.body;)if(a.nodeType==1){let f=a,u=window.getComputedStyle(f);if((f.scrollHeight>f.clientHeight||f.scrollWidth>f.clientWidth)&&u.overflow!="visible"){let c=f.getBoundingClientRect();r=Math.max(r,c.left),o=Math.min(o,c.right),l=Math.max(l,c.top),h=a==s.parentNode?c.bottom:Math.min(h,c.bottom)}a=u.position=="absolute"||u.position=="fixed"?f.offsetParent:f.parentNode}else if(a.nodeType==11)a=a.host;else break;return{left:r-e.left,right:Math.max(r,o)-e.left,top:l-(e.top+t),bottom:Math.max(l,h)-(e.top+t)}}function Af(s,t){let e=s.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}var Ai=class{constructor(t,e,i){this.from=t,this.to=e,this.size=i}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],r=e[i];if(n.from!=r.from||n.to!=r.to||n.size!=r.size)return!1}return!0}draw(t){return St.replace({widget:new Ir(this.size,t)}).range(this.from,this.to)}},Ir=class extends ti{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}},Jn=class{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Fl,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ht.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(Wr).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Mr(e),this.stateDeco=t.facet(Ii).filter(i=>typeof i!="function"),this.heightMap=vt.empty().applyChanges(this.stateDeco,B.empty,this.heightOracle.setDoc(t.doc),[new Nt(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=St.set(this.lineGaps.map(i=>i.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some(({from:r,to:o})=>n>=r&&n<=o)){let{from:r,to:o}=this.lineBlockAt(n);t.push(new Qe(r,o))}}this.viewports=t.sort((i,n)=>i.from-n.from),this.scaler=this.heightMap.height<=7e6?Fl:new Rr(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(this.scaler.scale==1?t:vi(t,this.scaler))})}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Ii).filter(f=>typeof f!="function");let n=t.changedRanges,r=Nt.extendWithRanges(n,Sf(i,this.stateDeco,t?t.changes:wt.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=o&&(t.flags|=2),l?(this.scrollAnchorPos=t.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let h=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<h.from||e.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,e));let a=!t.changes.empty||t.flags&2||h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,this.updateForViewport(),a&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(Na)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?ht.RTL:ht.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),l=e.getBoundingClientRect(),h=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let a=0,f=0,u=parseInt(i.paddingTop)||0,c=parseInt(i.paddingBottom)||0;(this.paddingTop!=u||this.paddingBottom!=c)&&(this.paddingTop=u,this.paddingBottom=c,a|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(h=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=8),this.scrollTop!=t.scrollDOM.scrollTop&&(this.scrollAnchorHeight=-1,this.scrollTop=t.scrollDOM.scrollTop),this.scrolledToBottom=$l(t.scrollDOM);let d=(this.printing?Af:Cf)(e,this.paddingTop),p=d.top-this.pixelViewport.top,m=d.bottom-this.pixelViewport.bottom;this.pixelViewport=d;let g=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(g!=this.inView&&(this.inView=g,g&&(h=!0)),!this.inView&&!this.scrollTarget)return 0;let b=l.width;if((this.contentDOMWidth!=b||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=t.scrollDOM.clientHeight,a|=8),h){let M=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(M)&&(o=!0),o||n.lineWrapping&&Math.abs(b-this.contentDOMWidth)>n.charWidth){let{lineHeight:w,charWidth:S,textHeight:y}=t.docView.measureTextSize();o=w>0&&n.refresh(r,w,S,y,b/S,M),o&&(t.docView.minWidth=0,a|=8)}p>0&&m>0?f=Math.max(p,m):p<0&&m<0&&(f=Math.min(p,m)),n.heightChanged=!1;for(let w of this.viewports){let S=w.from==this.viewport.from?M:t.docView.measureVisibleLineHeights(w);this.heightMap=(o?vt.empty().applyChanges(this.stateDeco,B.empty,this.heightOracle,[new Nt(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new Tr(w.from,S))}n.heightChanged&&(a|=2)}let D=!this.viewportIsAppropriate(this.viewport,f)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return D&&(this.viewport=this.getViewport(f,this.scrollTarget)),this.updateForViewport(),(a&2||D)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,h=new Qe(n.lineAt(o-i*1e3,H.ByHeight,r,0,0).from,n.lineAt(l+(1-i)*1e3,H.ByHeight,r,0,0).to);if(e){let{head:a}=e.range;if(a<h.from||a>h.to){let f=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=n.lineAt(a,H.ByPos,r,0,0),c;e.y=="center"?c=(u.top+u.bottom)/2-f/2:e.y=="start"||e.y=="nearest"&&a<h.from?c=u.top:c=u.bottom-f,h=new Qe(n.lineAt(c-1e3/2,H.ByHeight,r,0,0).from,n.lineAt(c+f+1e3/2,H.ByHeight,r,0,0).to)}}return h}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new Qe(this.heightMap.lineAt(i,H.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,H.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,H.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(e,H.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(t==0||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||r>=l+Math.max(10,Math.min(i,250)))&&n>o-2*1e3&&r<l+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new Ai(e.mapPos(n.from),e.mapPos(n.to),n.size));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,r=n>>1,o=n<<1;if(this.defaultTextDirection!=ht.LTR&&!i)return[];let l=[],h=(a,f,u,c)=>{if(f-a<r)return;let d=this.state.selection.main,p=[d.from];d.empty||p.push(d.to);for(let g of p)if(g>a&&g<f){h(a,g-10,u,c),h(g+10,f,u,c);return}let m=Mf(t,g=>g.from>=u.from&&g.to<=u.to&&Math.abs(g.from-a)<r&&Math.abs(g.to-f)<r&&!p.some(b=>g.from<b&&g.to>b));if(!m){if(f<u.to&&e&&i&&e.visibleRanges.some(g=>g.from<=f&&g.to>=f)){let g=e.moveToLineBoundary(T.cursor(f),!1,!0).head;g>a&&(f=g)}m=new Ai(a,f,this.gapSize(u,a,f,c))}l.push(m)};for(let a of this.viewportLines){if(a.length<o)continue;let f=Of(a.from,a.to,this.stateDeco);if(f.total<o)continue;let u=this.scrollTarget?this.scrollTarget.range.head:null,c,d;if(i){let p=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,m,g;if(u!=null){let b=En(f,u),D=((this.visibleBottom-this.visibleTop)/2+p)/a.height;m=b-D,g=b+D}else m=(this.visibleTop-a.top-p)/a.height,g=(this.visibleBottom-a.top+p)/a.height;c=Dn(f,m),d=Dn(f,g)}else{let p=f.total*this.heightOracle.charWidth,m=n*this.heightOracle.charWidth,g,b;if(u!=null){let D=En(f,u),M=((this.pixelViewport.right-this.pixelViewport.left)/2+m)/p;g=D-M,b=D+M}else g=(this.pixelViewport.left-m)/p,b=(this.pixelViewport.right+m)/p;c=Dn(f,g),d=Dn(f,b)}c>a.from&&h(a.from,c,a,f),d<a.to&&h(d,a.to,a,f)}return l}gapSize(t,e,i,n){let r=En(n,i)-En(n,e);return this.heightOracle.lineWrapping?t.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(t){Ai.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=St.set(t.map(e=>e.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];Q.spans(t,this.viewport.from,this.viewport.to,{span(n,r){e.push({from:n,to:r})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some((n,r)=>n.from!=e[r].from||n.to!=e[r].to);return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||vi(this.heightMap.lineAt(t,H.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return vi(this.heightMap.lineAt(this.scaler.fromDOM(t),H.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return vi(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},Qe=class{constructor(t,e){this.from=t,this.to=e}};function Of(s,t,e){let i=[],n=s,r=0;return Q.spans(e,s,t,{span(){},point(o,l){o>n&&(i.push({from:n,to:o}),r+=o-n),n=l}},20),n<t&&(i.push({from:n,to:t}),r+=t-n),{total:r,ranges:i}}function Dn({total:s,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let i=Math.floor(s*e);for(let n=0;;n++){let{from:r,to:o}=t[n],l=o-r;if(i<=l)return r+i;i-=l}}function En(s,t){let e=0;for(let{from:i,to:n}of s.ranges){if(t<=n){e+=t-i;break}e+=n-i}return e/s.total}function Mf(s,t){for(let e of s)if(t(e))return e}var Fl={toDOM(s){return s},fromDOM(s){return s},scale:1},Rr=class{constructor(t,e,i){let n=0,r=0,o=0;this.viewports=i.map(({from:l,to:h})=>{let a=e.lineAt(l,H.ByPos,t,0,0).top,f=e.lineAt(h,H.ByPos,t,0,0).bottom;return n+=f-a,{from:l,to:h,top:a,bottom:f,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(e.height-n);for(let l of this.viewports)l.domTop=o+(l.top-r)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),r=l.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return n+(t-i)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);i=r.bottom,n=r.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return i+(t-n)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);i=r.bottom,n=r.domBottom}}};function vi(s,t){if(t.scale==1)return s;let e=t.toDOM(s.top),i=t.toDOM(s.bottom);return new Rt(s.from,s.length,e,i-e,Array.isArray(s._content)?s._content.map(n=>vi(n,t)):s._content)}var In=E.define({combine:s=>s.join(" ")}),Br=E.define({combine:s=>s.indexOf(!0)>-1}),Nr=Ot.newName(),Ah=Ot.newName(),Oh=Ot.newName(),Mh={"&light":"."+Ah,"&dark":"."+Oh};function Lr(s,t,e){return new Ot(t,{finish(i){return/&/.test(i)?i.replace(/&\\w*/,n=>{if(n=="&")return s;if(!e||!e[n])throw new RangeError(`Unsupported selector: ${n}`);return e[n]}):s+" "+i}})}var Tf=Lr("."+Nr,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Mh),Fr=class{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="";let{impreciseHead:r,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let l=r||o?[]:Ef(t),h=new _n(l,t.state);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=If(l,this.bounds.from)}else{let l=t.observer.selectionRange,h=r&&r.node==l.focusNode&&r.offset==l.focusOffset||!fr(t.contentDOM,l.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(l.focusNode,l.focusOffset),a=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!fr(t.contentDOM,l.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(l.anchorNode,l.anchorOffset);this.newSel=T.single(a,h)}}};function Th(s,t){let e,{newSel:i}=t,n=s.state.selection.main,r=s.inputState.lastKeyTime>Date.now()-100?s.inputState.lastKeyCode:-1;if(t.bounds){let{from:o,to:l}=t.bounds,h=n.from,a=null;(r===8||C.android&&t.text.length<l-o)&&(h=n.to,a="end");let f=Df(s.state.doc.sliceString(o,l,Xe),t.text,h-o,a);f&&(C.chrome&&r==13&&f.toB==f.from+2&&t.text.slice(f.from,f.toB)==Xe+Xe&&f.toB--,e={from:o+f.from,to:o+f.toA,insert:B.of(t.text.slice(f.from,f.toB).split(Xe))})}else i&&(!s.hasFocus&&s.state.facet(Qn)||i.main.eq(n))&&(i=null);if(!e&&!i)return!1;if(!e&&t.typeOver&&!n.empty&&i&&i.main.empty?e={from:n.from,to:n.to,insert:s.state.doc.slice(n.from,n.to)}:e&&e.from>=n.from&&e.to<=n.to&&(e.from!=n.from||e.to!=n.to)&&n.to-n.from-(e.to-e.from)<=4?e={from:n.from,to:n.to,insert:s.state.doc.slice(n.from,e.from).append(e.insert).append(s.state.doc.slice(e.to,n.to))}:(C.mac||C.android)&&e&&e.from==e.to&&e.from==n.head-1&&/^\\. ?$/.test(e.insert.toString())&&s.contentDOM.getAttribute("autocorrect")=="off"?(i&&e.insert.length==2&&(i=T.single(i.main.anchor-1,i.main.head-1)),e={from:n.from,to:n.to,insert:B.of([" "])}):C.chrome&&e&&e.from==e.to&&e.from==n.head&&e.insert.toString()==`\n `&&s.lineWrapping&&(i&&(i=T.single(i.main.anchor-1,i.main.head-1)),e={from:n.from,to:n.to,insert:B.of([" "])}),e){if(C.ios&&s.inputState.flushIOSKey(s)||C.android&&(e.from==n.from&&e.to==n.to&&e.insert.length==1&&e.insert.lines==2&&Ze(s.contentDOM,"Enter",13)||(e.from==n.from-1&&e.to==n.to&&e.insert.length==0||r==8&&e.insert.length<e.to-e.from&&e.to>n.head)&&Ze(s.contentDOM,"Backspace",8)||e.from==n.from&&e.to==n.to+1&&e.insert.length==0&&Ze(s.contentDOM,"Delete",46)))return!0;let o=e.insert.toString();s.inputState.composing>=0&&s.inputState.composing++;let l,h=()=>l||(l=Pf(s,e,i));return s.state.facet(ih).some(a=>a(s,e.from,e.to,o,h))||s.dispatch(h()),!0}else if(i&&!i.main.eq(n)){let o=!1,l="select";return s.inputState.lastSelectionTime>Date.now()-50&&(s.inputState.lastSelectionOrigin=="select"&&(o=!0),l=s.inputState.lastSelectionOrigin),s.dispatch({selection:i,scrollIntoView:o,userEvent:l}),!0}else return!1}function Pf(s,t,e){let i,n=s.state,r=n.selection.main;if(t.from>=r.from&&t.to<=r.to&&t.to-t.from>=(r.to-r.from)/3&&(!e||e.main.empty&&e.main.from==t.from+t.insert.length)&&s.inputState.composing<0){let l=r.from<t.from?n.sliceDoc(r.from,t.from):"",h=r.to>t.to?n.sliceDoc(t.to,r.to):"";i=n.replaceSelection(s.state.toText(l+t.insert.sliceString(0,void 0,s.state.lineBreak)+h))}else{let l=n.changes(t),h=e&&e.main.to<=l.newLength?e.main:void 0;if(n.selection.ranges.length>1&&s.inputState.composing>=0&&t.to<=r.to&&t.to>=r.to-10){let a=s.state.sliceDoc(t.from,t.to),f=ph(s,t.insert.length-(t.to-t.from))||s.state.doc.lineAt(r.head),u=r.to-t.to,c=r.to-r.from;i=n.changeByRange(d=>{if(d.from==r.from&&d.to==r.to)return{changes:l,range:h||d.map(l)};let p=d.to-u,m=p-a.length;if(d.to-d.from!=c||s.state.sliceDoc(m,p)!=a||f&&d.to>=f.from&&d.from<=f.to)return{range:d};let g=n.changes({from:m,to:p,insert:t.insert}),b=d.to-r.to;return{changes:g,range:h?T.range(Math.max(0,h.anchor+b),Math.max(0,h.head+b)):d.map(g)}})}else i={changes:l,selection:h&&n.selection.replaceRange(h)}}let o="input.type";return(s.composing||s.inputState.compositionPendingChange&&s.inputState.compositionEndedAt>Date.now()-50)&&(s.inputState.compositionPendingChange=!1,o+=".compose",s.inputState.compositionFirstChange&&(o+=".start",s.inputState.compositionFirstChange=!1)),n.update(i,{userEvent:o,scrollIntoView:!0})}function Df(s,t,e,i){let n=Math.min(s.length,t.length),r=0;for(;r<n&&s.charCodeAt(r)==t.charCodeAt(r);)r++;if(r==n&&s.length==t.length)return null;let o=s.length,l=t.length;for(;o>0&&l>0&&s.charCodeAt(o-1)==t.charCodeAt(l-1);)o--,l--;if(i=="end"){let h=Math.max(0,r-Math.min(o,l));e-=o+h-r}if(o<r&&s.length<t.length){let h=e<=r&&e>=o?r-e:0;r-=h,l=r+(l-o),o=r}else if(l<r){let h=e<=r&&e>=l?r-e:0;r-=h,o=r+(o-l),l=r}return{from:r,toA:o,toB:l}}function Ef(s){let t=[];if(s.root.activeElement!=s.contentDOM)return t;let{anchorNode:e,anchorOffset:i,focusNode:n,focusOffset:r}=s.observer.selectionRange;return e&&(t.push(new Vn(e,i)),(n!=e||r!=i)&&t.push(new Vn(n,r))),t}function If(s,t){if(s.length==0)return null;let e=s[0].pos,i=s.length==2?s[1].pos:e;return e>-1&&i>-1?T.single(e+t,i+t):null}var Rf={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ar=C.ie&&C.ie_version<=11,Hr=class{constructor(t){this.view=t,this.active=!1,this.selectionRange=new ur,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let i of e)this.queue.push(i);(C.ie&&C.ie_version<=11||C.ios&&t.composing)&&e.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),ar&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(t.contentDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runScrollHandlers(this.view,t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,i)=>e!=t[i]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Qn)?i.root.activeElement!=this.dom:!Rn(i.dom,n))return;let r=n.anchorNode&&i.docView.nearest(n.anchorNode);if(r&&r.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(C.ie&&C.ie_version<=11||C.android&&C.chrome)&&!i.state.selection.main.empty&&n.focusNode&&Fn(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=C.safari&&t.root.nodeType==11&&Ca(this.dom.ownerDocument)==this.dom&&Bf(this.view)||Ln(t.root);if(!e||this.selectionRange.eq(e))return!1;let i=Rn(this.dom,e);return i&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&Pa(this.dom,e)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(e),i&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(i.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=e)i.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Rf),ar&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),ar&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let n=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&Ze(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let r of t){let o=this.readMutation(r);o&&(o.typeOver&&(n=!0),e==-1?{from:e,to:i}=o:(e=Math.min(o.from,e),i=Math.max(o.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&Rn(this.dom,this.selectionRange);return t<0&&!n?null:(t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new Fr(this.view,t,e,i))}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return!1;let i=this.view.state,n=Th(this.view,e);return this.view.state==i&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.flags|=4),t.type=="childList"){let i=Hl(e,t.previousSibling||t.target.previousSibling,-1),n=Hl(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var t,e,i,n;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect(),(n=this.resizeContent)===null||n===void 0||n.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}};function Hl(s,t,e){for(;t;){let i=z.get(t);if(i&&i.parent==s)return i;let n=t.parentNode;t=n!=s.dom?n:e>0?t.nextSibling:t.previousSibling}return null}function Bf(s){let t=null;function e(h){h.preventDefault(),h.stopImmediatePropagation(),t=h.getTargetRanges()[0]}if(s.contentDOM.addEventListener("beforeinput",e,!0),s.dom.ownerDocument.execCommand("indent"),s.contentDOM.removeEventListener("beforeinput",e,!0),!t)return null;let i=t.startContainer,n=t.startOffset,r=t.endContainer,o=t.endOffset,l=s.docView.domAtPos(s.state.selection.main.anchor);return Fn(l.node,l.offset,r,o)&&([i,n,r,o]=[r,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:r,focusOffset:o}}var F=class s{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM);let{dispatch:e}=t;this.dispatchTransactions=t.dispatchTransactions||e&&(i=>i.forEach(n=>e(n,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=t.root||Ta(t.parent)||document,this.viewState=new Jn(t.state||q.create(t)),this.plugins=this.state.facet(xi).map(i=>new Ci(i));for(let i of this.plugins)i.update(this);this.observer=new Hr(this),this.inputState=new Sr(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new Kn(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}dispatch(...t){let e=t.length==1&&t[0]instanceof ut?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,i=!1,n,r=this.state;for(let c of t){if(c.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn\'t start from the previous state.");r=c.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,l=0,h=null;t.some(c=>c.annotation(vh))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,h=Sh(r,o),h||(l=1));let a=this.observer.delayedAndroidKey,f=null;if(a?(this.observer.clearDelayedAndroidKey(),f=this.observer.readChange(),(f&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(f=null)):this.observer.clear(),r.facet(q.phrases)!=this.state.facet(q.phrases))return this.setState(r);n=jn.create(this,r,t),n.flags|=l;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let c of t){if(u&&(u=u.map(c.changes)),c.scrollIntoView){let{main:d}=c.state.selection;u=new qn(d.empty?d:T.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of c.effects)d.is(wl)&&(u=d.value)}this.viewState.update(n,u),this.bidiCache=Yn.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),e=this.docView.update(n),this.state.facet(ki)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(c=>c.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(In)!=n.state.facet(In)&&(this.viewState.mustMeasureContent=!0),(e||i||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!n.empty)for(let c of this.state.facet(yr))c(n);(h||f)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),f&&!Th(this,f)&&a.force&&Ze(this.contentDOM,a.key,a.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Jn(t),this.plugins=t.facet(xi).map(i=>new Ci(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView=new Kn(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(xi),i=t.state.facet(xi);if(e!=i){let n=[];for(let r of i){let o=e.indexOf(r);if(o<0)n.push(new Ci(r));else{let l=this.plugins[o];l.mustUpdate=t,n.push(l)}}for(let r of this.plugins)r.mustUpdate!=t&&r.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let n of this.plugins)n.mustUpdate=t;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this)}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,{scrollTop:n}=i,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;n!=this.viewState.scrollTop&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if($l(i))r=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(n);r=d.from,o=d.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let a=[];h&4||([this.measureRequests,a]=[a,this.measureRequests]);let f=a.map(d=>{try{return d.read(this)}catch(p){return Gt(this.state,p),zl}}),u=jn.create(this,this.state,[]),c=!1;u.flags|=h,e?e.flags|=h:e=u,this.updateState=2,u.empty||(this.updatePlugins(u),this.inputState.update(u),this.updateAttrs(),c=this.docView.update(u));for(let d=0;d<a.length;d++)if(f[d]!=zl)try{let p=a[d];p.write&&p.write(f[d],this)}catch(p){Gt(this.state,p)}if(c&&this.docView.updateSelection(!0),!u.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null;continue}else{let p=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(p>1||p<-1){n=i.scrollTop=n+p,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let l of this.state.facet(yr))l(e)}get themeClasses(){return Nr+" "+(this.state.facet(Br)?Oh:Ah)+" "+this.state.facet(In)}updateAttrs(){let t=_l(this,rh,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Qn)?"true":"false",class:"cm-content",style:`${C.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),_l(this,Wr,e);let i=this.observer.ignore(()=>{let n=mr(this.contentDOM,this.contentAttrs,e),r=mr(this.dom,this.editorAttrs,t);return n||r});return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let n of i.effects)if(n.is(s.announce)){e&&(this.announceDOM.textContent=""),e=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(ki);let t=this.state.facet(s.cspNonce);Ot.mount(this.root,this.styleModules.concat(Tf).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn\'t allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(i=>i.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return hr(this,t,Al(this,t,e,i))}moveByGroup(t,e){return hr(this,t,Al(this,t,e,i=>of(this,t.head,i)))}moveToLineBoundary(t,e,i=!0){return rf(this,t,e,i)}moveVertically(t,e,i){return hr(this,t,lf(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),mh(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),r=this.bidiSpans(n),o=r[Bt.find(r,t-n.from,-1,e)];return zr(i,o.dir==ht.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(sh)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Nf)return ch(t.length);let e=this.textDirectionAt(t.from),i;for(let r of this.bidiCache)if(r.from==t.from&&r.dir==e&&(r.fresh||uh(r.isolates,i=xl(this,t.from,t.to))))return r.order;i||(i=xl(this,t.from,t.to));let n=qa(t.text,e,i);return this.bidiCache.push(new Yn(t.from,t.to,e,i,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||C.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Vl(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return wl.of(new qn(typeof t=="number"?T.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return Ei.define(()=>({}),{eventHandlers:t})}static theme(t,e){let i=Ot.newName(),n=[In.of(i),ki.of(Lr(`.${i}`,t))];return e&&e.dark&&n.push(Br.of(!0)),n}static baseTheme(t){return ir.lowest(ki.of(Lr("."+Nr,t,Mh)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&z.get(i)||z.get(t);return((e=n==null?void 0:n.rootView)===null||e===void 0?void 0:e.view)||null}};F.styleModule=ki;F.inputHandler=ih;F.focusChangeEffect=nh;F.perLineTextDirection=sh;F.exceptionSink=eh;F.updateListener=yr;F.editable=Qn;F.mouseSelectionStyle=th;F.dragMovesSelection=Zl;F.clickAddsSelectionRange=Ql;F.decorations=Ii;F.atomicRanges=$r;F.bidiIsolatedRanges=oh;F.scrollMargins=lh;F.darkTheme=Br;F.cspNonce=E.define({combine:s=>s.length?s[0]:""});F.contentAttributes=Wr;F.editorAttributes=rh;F.lineWrapping=F.contentAttributes.of({class:"cm-lineWrapping"});F.announce=K.define();var Nf=4096,zl={},Yn=class s{constructor(t,e,i,n,r,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=r,this.order=o}static update(t,e){if(e.empty&&!t.some(r=>r.fresh))return t;let i=[],n=t.length?t[t.length-1].dir:ht.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let o=t[r];o.dir==n&&!e.touchesRange(o.from,o.to)&&i.push(new s(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}};function _l(s,t,e){for(let i=s.state.facet(t),n=i.length-1;n>=0;n--){let r=i[n],o=typeof r=="function"?r(s):r;o&&gr(o,e)}return e}var Mu=C.mac?"mac":C.windows?"win":C.linux?"linux":"key";var Lf=!C.ios;var Ff={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Lf&&(Ff[".cm-line"].caretColor="transparent !important");var Tu=/x/.unicode!=null?"gu":"g";var Pu=F.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"\'\'",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}});var Yt=class extends Ut{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}};Yt.prototype.elementClass="";Yt.prototype.toDOM=void 0;Yt.prototype.mapMode=ft.TrackBefore;Yt.prototype.startSide=Yt.prototype.endSide=-1;Yt.prototype.point=!0;var Hf=0,zt=class s{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=Hf++}static define(t){if(t!=null&&t.base)throw new Error("Can not derive from a modified tag");let e=new s([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new is;return e=>e.modified.indexOf(t)>-1?e:is.get(e.base||e,e.modified.concat(t).sort((i,n)=>i.id-n.id))}},zf=0,is=class s{constructor(){this.instances=[],this.id=zf++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find(l=>l.base==t&&_f(e,l.modified));if(i)return i;let n=[],r=new zt(n,t,e);for(let l of e)l.instances.push(r);let o=Vf(e);for(let l of t.set)if(!l.modified.length)for(let h of o)n.push(s.get(l,h));return r}};function _f(s,t){return s.length==t.length&&s.every((e,i)=>e==t[i])}function Vf(s){let t=[[]];for(let e=0;e<s.length;e++)for(let i=0,n=t.length;i<n;i++)t.push(t[i].concat(s[e]));return t.sort((e,i)=>i.length-e.length)}function Eh(s){let t=Object.create(null);for(let e in s){let i=s[e];Array.isArray(i)||(i=[i]);for(let n of e.split(" "))if(n){let r=[],o=2,l=n;for(let u=0;;){if(l=="..."&&u>0&&u+3==n.length){o=1;break}let c=/^"(?:[^"\\\\]|\\\\.)*?"|[^\\/!]+/.exec(l);if(!c)throw new RangeError("Invalid path: "+n);if(r.push(c[0]=="*"?"":c[0][0]==\'"\'?JSON.parse(c[0]):c[0]),u+=c[0].length,u==n.length)break;let d=n[u++];if(u==n.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+n);l=n.slice(u)}let h=r.length-1,a=r[h];if(!a)throw new RangeError("Invalid path: "+n);let f=new Ni(i,o,h>0?r.slice(0,h):null);t[a]=f.sort(t[a])}}return Wf.add(t)}var Wf=new R,Ni=class{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}};Ni.empty=new Ni([],2,null);function Kr(s,t){let e=Object.create(null);for(let r of s)if(!Array.isArray(r.tag))e[r.tag.id]=r.class;else for(let o of r.tag)e[o.id]=r.class;let{scope:i,all:n=null}=t||{};return{style:r=>{let o=n;for(let l of r)for(let h of l.set){let a=e[h.id];if(a){o=o?o+" "+a:a;break}}return o},scope:i}}var x=zt.define,Zn=x(),he=x(),Ph=x(he),Dh=x(he),ae=x(),ts=x(ae),qr=x(ae),Ht=x(),Pe=x(Ht),Lt=x(),Ft=x(),jr=x(),Bi=x(jr),es=x(),k={comment:Zn,lineComment:x(Zn),blockComment:x(Zn),docComment:x(Zn),name:he,variableName:x(he),typeName:Ph,tagName:x(Ph),propertyName:Dh,attributeName:x(Dh),className:x(he),labelName:x(he),namespace:x(he),macroName:x(he),literal:ae,string:ts,docString:x(ts),character:x(ts),attributeValue:x(ts),number:qr,integer:x(qr),float:x(qr),bool:x(ae),regexp:x(ae),escape:x(ae),color:x(ae),url:x(ae),keyword:Lt,self:x(Lt),null:x(Lt),atom:x(Lt),unit:x(Lt),modifier:x(Lt),operatorKeyword:x(Lt),controlKeyword:x(Lt),definitionKeyword:x(Lt),moduleKeyword:x(Lt),operator:Ft,derefOperator:x(Ft),arithmeticOperator:x(Ft),logicOperator:x(Ft),bitwiseOperator:x(Ft),compareOperator:x(Ft),updateOperator:x(Ft),definitionOperator:x(Ft),typeOperator:x(Ft),controlOperator:x(Ft),punctuation:jr,separator:x(jr),bracket:Bi,angleBracket:x(Bi),squareBracket:x(Bi),paren:x(Bi),brace:x(Bi),content:Ht,heading:Pe,heading1:x(Pe),heading2:x(Pe),heading3:x(Pe),heading4:x(Pe),heading5:x(Pe),heading6:x(Pe),contentSeparator:x(Ht),list:x(Ht),quote:x(Ht),emphasis:x(Ht),strong:x(Ht),link:x(Ht),monospace:x(Ht),strikethrough:x(Ht),inserted:x(),deleted:x(),changed:x(),invalid:x(),meta:es,documentMeta:x(es),annotation:x(es),processingInstruction:x(es),definition:zt.defineModifier(),constant:zt.defineModifier(),function:zt.defineModifier(),standard:zt.defineModifier(),local:zt.defineModifier(),special:zt.defineModifier()},Iu=Kr([{tag:k.link,class:"tok-link"},{tag:k.heading,class:"tok-heading"},{tag:k.emphasis,class:"tok-emphasis"},{tag:k.strong,class:"tok-strong"},{tag:k.keyword,class:"tok-keyword"},{tag:k.atom,class:"tok-atom"},{tag:k.bool,class:"tok-bool"},{tag:k.url,class:"tok-url"},{tag:k.labelName,class:"tok-labelName"},{tag:k.inserted,class:"tok-inserted"},{tag:k.deleted,class:"tok-deleted"},{tag:k.literal,class:"tok-literal"},{tag:k.string,class:"tok-string"},{tag:k.number,class:"tok-number"},{tag:[k.regexp,k.escape,k.special(k.string)],class:"tok-string2"},{tag:k.variableName,class:"tok-variableName"},{tag:k.local(k.variableName),class:"tok-variableName tok-local"},{tag:k.definition(k.variableName),class:"tok-variableName tok-definition"},{tag:k.special(k.variableName),class:"tok-variableName2"},{tag:k.definition(k.propertyName),class:"tok-propertyName tok-definition"},{tag:k.typeName,class:"tok-typeName"},{tag:k.namespace,class:"tok-namespace"},{tag:k.className,class:"tok-className"},{tag:k.macroName,class:"tok-macroName"},{tag:k.propertyName,class:"tok-propertyName"},{tag:k.operator,class:"tok-operator"},{tag:k.comment,class:"tok-comment"},{tag:k.meta,class:"tok-meta"},{tag:k.invalid,class:"tok-invalid"},{tag:k.punctuation,class:"tok-punctuation"}]);var Ur,ei=new R;function $f(s){return E.define({combine:s?t=>t.concat(s):void 0})}var qf=new R,Ct=class{constructor(t,e,i=[],n=""){this.data=t,this.name=n,q.prototype.hasOwnProperty("tree")||Object.defineProperty(q.prototype,"tree",{get(){return Yr(this)}}),this.parser=e,this.extension=[ii.of(this),q.languageData.of((r,o,l)=>{let h=Ih(r,o,l),a=h.type.prop(ei);if(!a)return[];let f=r.facet(a),u=h.type.prop(qf);if(u){let c=h.resolve(o-h.from,l);for(let d of u)if(d.test(c,r)){let p=r.facet(d.facet);return d.type=="replace"?p:p.concat(f)}}return f})].concat(i)}isActiveAt(t,e,i=-1){return Ih(t,e,i).type.prop(ei)==this.data}findRegions(t){let e=t.facet(ii);if((e==null?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(r,o)=>{if(r.prop(ei)==this.data){i.push({from:o,to:o+r.length});return}let l=r.prop(R.mounted);if(l){if(l.tree.prop(ei)==this.data){if(l.overlay)for(let h of l.overlay)i.push({from:h.from+o,to:h.to+o});else i.push({from:o,to:o+r.length});return}else if(l.overlay){let h=i.length;if(n(l.tree,l.overlay[0].from+o),i.length>h)return}}for(let h=0;h<r.children.length;h++){let a=r.children[h];a instanceof $&&n(a,r.positions[h]+o)}};return n(Yr(t),0),i}get allowsNesting(){return!0}};Ct.setState=K.define();function Ih(s,t,e){let i=s.facet(ii),n=Yr(s).topNode;if(!i||i.allowsNesting)for(let r=n;r;r=r.enter(t,e,j.ExcludeBuffers))r.type.isTop&&(n=r);return n}var ns=class s extends Ct{constructor(t,e,i){super(t,e,[],i),this.parser=e}static define(t){let e=$f(t.languageData);return new s(e,t.parser.configure({props:[ei.add(i=>i.isTop?e:void 0)]}),t.name)}configure(t,e){return new s(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function Yr(s){let t=s.field(Ct.state,!1);return t?t.tree:$.empty}var Xr=class{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}},Li=null,Qr=class s{constructor(t,e,i=[],n,r,o,l,h){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=r,this.viewport=o,this.skipped=l,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new s(t,e,[],$.empty,0,i,[],null)}startParse(){return this.parser.startParse(new Xr(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=$.empty&&this.isDone(e!=null?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof t=="number"){let n=Date.now()+t;t=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(ke.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(e!=null?e:this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(ke.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=Li;Li=this;try{return t()}finally{Li=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=Rh(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:r,viewport:o,skipped:l}=this;if(this.takeTree(),!t.empty){let h=[];if(t.iterChangedRanges((a,f,u,c)=>h.push({fromA:a,toA:f,fromB:u,toB:c})),i=ke.applyChanges(i,h),n=$.empty,r=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){l=[];for(let a of this.skipped){let f=t.mapPos(a.from,1),u=t.mapPos(a.to,-1);f<u&&l.push({from:f,to:u})}}}return new s(this.parser,e,i,n,r,o,l,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:n,to:r}=this.skipped[i];n<t.to&&r>t.from&&(this.fragments=Rh(this.fragments,n,r),this.skipped.splice(i--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends We{createParse(e,i,n){let r=n[0].from,o=n[n.length-1].to;return{parsedPos:r,advance(){let h=Li;if(h){for(let a of n)h.tempSkipped.push(a);t&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,t]):t)}return this.parsedPos=o,new $(st.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return Li}};function Rh(s,t,e){return ke.applyChanges(s,[{fromA:t,toA:e,fromB:t,toB:e}])}var Fi=class s{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new s(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=Qr.create(t.facet(ii).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new s(i)}};Ct.state=jt.define({create:Fi.init,update(s,t){for(let e of t.effects)if(e.is(Ct.setState))return e.value;return t.startState.facet(ii)!=t.state.facet(ii)?Fi.init(t.state):s.apply(t)}});var Lh=s=>{let t=setTimeout(()=>s(),500);return()=>clearTimeout(t)};typeof requestIdleCallback!="undefined"&&(Lh=s=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(s,{timeout:500-100})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});var Gr=typeof navigator!="undefined"&&(!((Ur=navigator.scheduling)===null||Ur===void 0)&&Ur.isInputPending)?()=>navigator.scheduling.isInputPending():null,jf=Ei.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(Ct.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(Ct.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=Lh(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,r=i.field(Ct.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,t&&!Gr?Math.max(25,t.timeRemaining()-5):1e9),l=r.context.treeLen<n&&i.doc.length>n+1e3,h=r.context.work(()=>Gr&&Gr()||Date.now()>o,n+(l?0:1e5));this.chunkBudget-=Date.now()-e,(h||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Ct.setState.of(new Fi(r.context))})),this.chunkBudget>0&&!(h&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Gt(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),ii=E.define({combine(s){return s.length?s[0]:null},enables:s=>[Ct.state,jf,F.contentAttributes.compute([s],t=>{let e=t.facet(s);return e&&e.name?{"data-language":e.name}:{}})]});var Zr=class s{constructor(t,e){this.specs=t;let i;function n(l){let h=Ot.newName();return(i||(i=Object.create(null)))["."+h]=l,h}let r=typeof e.all=="string"?e.all:e.all?n(e.all):void 0,o=e.scope;this.scope=o instanceof Ct?l=>l.prop(ei)==o.data:o?l=>l==o:void 0,this.style=Kr(t.map(l=>({tag:l.tag,class:l.class||n(Object.assign({},l,{tag:null}))})),{all:r}).style,this.module=i?new Ot(i):null,this.themeType=e.themeType}static define(t,e){return new s(t,e||{})}};var Wu=Zr.define([{tag:k.meta,color:"#404740"},{tag:k.link,textDecoration:"underline"},{tag:k.heading,textDecoration:"underline",fontWeight:"bold"},{tag:k.emphasis,fontStyle:"italic"},{tag:k.strong,fontWeight:"bold"},{tag:k.strikethrough,textDecoration:"line-through"},{tag:k.keyword,color:"#708"},{tag:[k.atom,k.bool,k.url,k.contentSeparator,k.labelName],color:"#219"},{tag:[k.literal,k.inserted],color:"#164"},{tag:[k.string,k.deleted],color:"#a11"},{tag:[k.regexp,k.escape,k.special(k.string)],color:"#e40"},{tag:k.definition(k.variableName),color:"#00f"},{tag:k.local(k.variableName),color:"#30a"},{tag:[k.typeName,k.namespace],color:"#085"},{tag:k.className,color:"#167"},{tag:[k.special(k.variableName),k.macroName],color:"#256"},{tag:k.definition(k.propertyName),color:"#00c"},{tag:k.comment,color:"#940"},{tag:k.invalid,color:"#f00"}]);var Kf=Object.create(null),Bh=[st.none];var Nh=[],Uf=Object.create(null);for(let[s,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Uf[s]=Gf(Kf,t);function Jr(s,t){Nh.indexOf(s)>-1||(Nh.push(s),console.warn(t))}function Gf(s,t){let e=null;for(let r of t.split(".")){let o=s[r]||k[r];o?typeof o=="function"?e?e=o(e):Jr(r,`Modifier ${r} used at start of tag`):e?Jr(r,`Tag ${r} used as modifier`):e=o:Jr(r,`Unknown highlighting tag ${r}`)}if(!e)return 0;let i=t.replace(/ /g,"_"),n=st.define({id:Bh.length,name:i,props:[Eh({[i]:e})]});return Bh.push(n),n.id}var Jf=dn.deserialize({version:14,states:"$zQQOPOOOfOQO\'#C^OnOSO\'#C_OvOWO\'#C`O!OO`O\'#CbO!WOpO\'#CcOOOO\'#Cg\'#CgOOOO\'#Cd\'#CdQQOPOOOOOO,58x,58xO!`OQO,58xOOOO,58y,58yO!eOSO,58yO!jOWO,58zO!rOWO,58zOOOO,58|,58|O!wO`O,58|OOOO,58},58}O!|OpO,58}OOOO-E6b-E6bOOOO1G.d1G.dOOOO1G.e1G.eOOOO1G.f1G.fO#ROWO1G.fO#WOWO1G.fOOOO1G.h1G.hOOOO1G.i1G.iOOOO7+$Q7+$QO#`OWO7+$QOOOO<<Gl<<Gl",stateData:"#e~OYVO[PO_QObROeSOhTO~O]YO^XO~O`[OaZO~OT]Oc^O~Of`Og_O~OibOjaO~O^dO~OaeO~OcgOdfO~OThO~OgiO~OjjO~OdkO~OclOdkO~OdmO~O",goto:"k[PP]]]P]]aPPgTUOWQWORcWTVOW",nodeNames:"\\u26A0 CriticMarkup Addition Deletion Substitution MSub Comment Highlight",maxTerm:26,skippedNodes:[0],repeatNodeCount:1,tokenData:"\'o~R]XYzYZz]^zpqzqrzrszs#Oz#O#P!P#P#oz#o#p#s#p;\'Sz;\'S;=`\'i<%lOz~!POY~~!UXY~rsz!P!Qz#O#Pz#U#Vz#Y#Zz#b#cz#f#gz#h#iz#i#j!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![#Z!c!i#Z#T#Z#Z~#^R!Q![#g!c!i#g#T#Z#g~#jR!Q![z!c!iz#T#Zz~#xVY~vw$_{|%`}!O%k!^!_%v!_!`\'V!`!a\']#r#s\'c~$bP#Z#[$e~$hP#h#i$k~$nP!]!^$q~$tPvw$w~$zP#Z#[$}~%QP#h#i%T~%WP!]!^%Z~%`Oe~~%cP{|%f~%kO[~~%nP}!O%q~%vO_~~%yQ#W#X&P#a#b&h~&SP#X#Y&V~&YP#`#a&]~&`P!`!a&c~&hOb~~&kP#T#U&n~&qP#f#g&t~&wP#_#`&z~&}P!`!a\'Q~\'VOh~~\'YP!_!`\'Q~\'`P!`!a%Z~\'fP#r#s&c~\'lP;=`<%lz",tokenizers:[5,new qt("h~RP{|U~XP{|[~_P#q#rb~gO^~~",23,13),new qt("h~RP}!OU~XP}!O[~_P#q#rb~gOa~~",23,16),new qt("!x~RQ!^!_X#r#s!S~[P!P!Q_~bP#W#Xe~hP#X#Yk~nP#`#aq~tP!`!aw~zP#q#r}~!SOd~~!VRvw!`!`!a!r#r#sw~!cP#Z#[!f~!iP#h#i!l~!oP!]!^!r~!wOT~~",85,19),new qt("!g~RQvwX!^!_!`~[P#`#a_~bP#h#ie~hP!]!^k~nPvwq~tP#`#aw~zP#h#i}~!QP!]!^!T~!WP#q#r!Z~!`Og~~!cP!^!_!T~",68,22),new qt("!a~RQ!^!_X!_!`!Y~[P!P!Q_~bP#a#be~hP#T#Uk~nP#f#gq~tP#_#`w~zP!`!a}~!QP#q#r!T~!YOj~~!]P!_!`}~",62,25)],topRules:{CriticMarkup:[0,1]},tokenPrec:0}),Hi=ns.define({name:"criticmarkup",parser:Jf.configure({})});var Yf=te.define({create(s){let t=s.doc.toString(),e=Hi.parser.parse(t),i=Ie.addTree(e),n=ss(e,t);return{tree:e,nodes:n,fragments:i}},update(s,t){if(!t.docChanged)return s;let e=[];t.changes.iterChangedRanges((l,h,a,f)=>e.push({fromA:l,toA:h,fromB:a,toB:f}));let i=Ie.applyChanges(s.fragments,e),n=t.state.doc.toString(),r=Hi.parser.parse(n,i);i=Ie.addTree(r,i);let o=ss(r,n);return{tree:r,nodes:o,fragments:i}}});function ss(s,t,e,i){let n=[];return s.iterate({from:e,to:i,enter:r=>{var o,l,h;if(r.type.name==="\\u26A0")return!1;if(!(r.type.name==="CriticMarkup"||r.type.name==="MSub"))if(r.type.name==="Substitution"){if(((o=r.node.firstChild)==null?void 0:o.type.name)!=="MSub")return;n.push(As(r.from,r.to,r.type.name,t.slice(r.from,r.to),(l=r.node.firstChild)==null?void 0:l.from))}else n.push(As(r.from,r.to,r.type.name,t.slice(r.from,r.to),(h=r.node.firstChild)==null?void 0:h.from))}}),new ln(n)}function Fh(s,t,e){let i=Hi.parser.parse(s);return ss(i,s,t,e)}self.onmessage=async s=>{console.time("commentator: worker working");let t=s.data,e=async n=>Fh(n).nodes,i=await Promise.all(t.map(e));console.timeEnd("commentator: worker working"),self.postMessage(i)};\n')}(0,el.extendPrototype)(ii.default);(0,il.extendPrototype)(ii.default);var us=class extends ie.Events{_events=[];onunload(){}unload(){for(;this._events.length>0;)this._events.pop()()}register(t){this._events.push(t)}registerEvent(t){this.register(()=>t.e.offref(t))}},Ci=class extends us{constructor(e,i,r,s,o,u,l,a=2,h=f=>f){super();this.plugin=e;this.name=i;this.title=r;this.version=s;this.description=o;this.defaultValue=u;this.extractValue=l;this.workers=a;this.loadValue=h;let f=parseInt(this.plugin.app.loadLocalStorage(i+"-version"))||null;this.persist=ii.default.createInstance({name:this.name+`/${this.plugin.app.appId}`,driver:ii.default.INDEXEDDB,description:o,version:s}),this.plugin.app.workspace.onLayoutReady(async()=>{await this.persist.ready(async()=>{console.time("commentator: database load"),await this.loadDatabase(),console.timeEnd("commentator: database load"),this.trigger("database-update",this.allEntries());let d=f!==null&&f<s?"migrating":this.isEmpty()?"initializing":"syncing";this.testtime=Date.now(),console.time(`commentator: ${d} database`),f!==null&&f<s&&!this.isEmpty()?(await this.clearDatabase(),await this.rebuildDatabase(),this.trigger("database-migrate")):this.isEmpty()?(await this.rebuildDatabase(),this.trigger("database-create")):await this.syncDatabase(),console.timeEnd(`commentator: ${d} database`),this.registerEvent(this.plugin.app.vault.on("modify",async m=>{m instanceof ie.TFile&&this.storeKey(m.path,await this.extractValue(m),m.stat.mtime)})),this.registerEvent(this.plugin.app.vault.on("delete",async m=>{m instanceof ie.TFile&&this.deleteKey(m.path)})),this.registerEvent(this.plugin.app.vault.on("rename",async(m,v)=>{m instanceof ie.TFile&&this.renameKey(v,m.path,m.stat.mtime)})),this.registerEvent(this.plugin.app.vault.on("create",async m=>{m instanceof ie.TFile&&this.storeKey(m.path,this.defaultValue(),m.stat.mtime)}))})})}memory=new Map;persist;testtime=0;deleted_keys=new Set;databaseUpdate=(0,ie.debounce)(()=>{this.trigger("database-update",this.allEntries()),this.flushChanges()},100,!0);flushChanges=(0,ie.debounce)(async()=>{await this.persistMemory(),this.trigger("database-update",this.allEntries())},1e3,!0);on(e,i,r){return super.on(e,i,r)}async loadDatabase(){this.memory=new Map(Object.entries(await this.persist.getItems()).map(([e,i])=>(i.data=this.loadValue(i.data),[e,i])))}async regularParseFiles(e){for(let i=0;i<e.length;i++){let r=e[i],s=this.getItem(r.path);(s===null||s.mtime<r.stat.mtime)&&this.storeKey(r.path,await this.extractValue(r),r.stat.mtime,!0)}}async workerParseFiles(e){let i=await Promise.all(e.map(async s=>await this.plugin.app.vault.cachedRead(s))),r=Math.ceil(e.length/this.workers);for(let s=0;s<this.workers;s++){let o=new os(null,{name:this.title+" indexer "+(s+1)}),u=e.slice(s*r,(s+1)*r),l=i.slice(s*r,(s+1)*r);o.onmessage=a=>{for(let h=0;h<u.length;h++){let f=u[h],d=a.data[h];this.storeKey(f.path,d,f.stat.mtime,!0)}o.terminate(),console.log(`commentator: worker ${s+1} done (${Date.now()-this.testtime}ms)`)},o.postMessage(l)}this.plugin.app.saveLocalStorage(this.name+"-version",this.version.toString())}async syncDatabase(){let e=this.plugin.app.vault.getMarkdownFiles();this.allKeys().forEach(r=>{e.some(s=>s.path===r)||this.deleteKey(r)});let i=e.filter(r=>!this.memory.has(r.path)||this.memory.get(r.path).mtime<r.stat.mtime);i.length<=100?await this.regularParseFiles(i):await this.workerParseFiles(i),this.plugin.app.saveLocalStorage(this.name+"-version",this.version.toString())}async rebuildDatabase(){await this.workerParseFiles(this.plugin.app.vault.getMarkdownFiles()),this.plugin.app.saveLocalStorage(this.name+"-version",this.version.toString())}async persistMemory(){let e={};for(let[i,r]of this.memory.entries())r.dirty&&(e[i]={data:r.data,mtime:r.mtime},this.memory.set(i,{data:r.data,mtime:r.mtime,dirty:!1}));await this.persist.setItems(e),await Promise.all(Array.from(this.deleted_keys.values()).map(async i=>await this.persist.removeItem(i))),this.deleted_keys.clear()}storeKey(e,i,r,s=!0){this.memory.set(e,{data:i,mtime:r??Date.now(),dirty:s}),this.databaseUpdate()}deleteKey(e){if(this.getItem(e)==null)throw new Error("Key does not exist");this.memory.delete(e),this.deleted_keys.add(e),this.databaseUpdate()}renameKey(e,i,r){let s=this.getItem(e);if(s==null)throw new Error("Key does not exist");this.storeKey(i,s.data,r),this.deleteKey(e),this.databaseUpdate()}allKeys(){return Array.from(this.memory.keys())}getValue(e){return this.memory.get(e)?.data??null}allValues(){return Array.from(this.memory.values()).map(e=>e.data)}getItem(e){return this.memory.get(e)??null}allItems(){return Array.from(this.memory.values())}allEntries(){return Array.from(this.memory.entries())}async dropDatabase(){this.memory.clear(),await ii.default.dropInstance({name:this.name+`/${this.plugin.app.appId}`}),localStorage.removeItem(this.plugin.app.appId+"-"+this.name+"-version")}async clearDatabase(){this.memory.clear(),await this.persist.clear()}isEmpty(){return this.memory.size===0}};function Ih(n){let t=n.slice(),e=t[34].node.unwrap_parts();return t[36]=e,t}function Nh(n){let t,e,i,r,s,o,u,l,a,h,f,d,m,v,S;e=new yn({props:{value:n[4],type:"text",enterkeyhint:"search",placeholder:"Search...",spellcheck:!1,onChange:n[18]}});function N(g){n[20](g)}let M={onContextMenu:n[19],class:"clickable-icon nav-action-button",states:n[8]};n[0]!==void 0&&(M.value=n[0]),s=new ei({props:M}),Gt.push(()=>bn(s,"value",N)),l=new vn({props:{class:"clickable-icon nav-action-button",icon:"lasso",tooltip:"Select all markup",onClick:n[21]}});function B(g){n[23](g)}let R={onContextMenu:n[22],class:"clickable-icon nav-action-button",states:n[9]};n[1]!==void 0&&(R.value=n[1]),h=new ei({props:R}),Gt.push(()=>bn(h,"value",B));function A(g){n[25](g)}let O={onContextMenu:n[24],class:"clickable-icon nav-action-button",states:n[10]};return n[2]!==void 0&&(O.value=n[2]),m=new ei({props:O}),Gt.push(()=>bn(m,"value",A)),{c(){t=tt("div"),Tt(e.$$.fragment),i=wt(),r=tt("div"),Tt(s.$$.fragment),u=wt(),Tt(l.$$.fragment),a=wt(),Tt(h.$$.fragment),d=wt(),Tt(m.$$.fragment),G(t,"class","commentator-view-search search-input-container"),ee(r,"display","flex")},m(g,k){K(g,t,k),kt(e,t,null),K(g,i,k),K(g,r,k),kt(s,r,null),ct(r,u),kt(l,r,null),ct(r,a),kt(h,r,null),ct(r,d),kt(m,r,null),S=!0},p(g,k){let C={};k[0]&16&&(C.value=g[4]),k[0]&16&&(C.onChange=g[18]),e.$set(C);let T={};k[0]&1&&(T.onContextMenu=g[19]),!o&&k[0]&1&&(o=!0,T.value=g[0],pn(()=>o=!1)),s.$set(T);let _={};k[0]&224&&(_.onClick=g[21]),l.$set(_);let I={};k[0]&2&&(I.onContextMenu=g[22]),!f&&k[0]&2&&(f=!0,I.value=g[1],pn(()=>f=!1)),h.$set(I);let H={};k[0]&4&&(H.onContextMenu=g[24]),!v&&k[0]&4&&(v=!0,H.value=g[2],pn(()=>v=!1)),m.$set(H)},i(g){S||(j(e.$$.fragment,g),j(s.$$.fragment,g),j(l.$$.fragment,g),j(h.$$.fragment,g),j(m.$$.fragment,g),S=!0)},o(g){Y(e.$$.fragment,g),Y(s.$$.fragment,g),Y(l.$$.fragment,g),Y(h.$$.fragment,g),Y(m.$$.fragment,g),S=!1},d(g){g&&(W(t),W(i),W(r)),_t(e),_t(s),_t(l),_t(h),_t(m)}}}function Ph(n){let t,e;return t=new wn({props:{$$slots:{container:[Nh]},$$scope:{ctx:n}}}),{c(){Tt(t.$$.fragment)},m(i,r){kt(t,i,r),e=!0},p(i,r){let s={};r[0]&247|r[1]&64&&(s.$$scope={dirty:r,ctx:i}),t.$set(s)},i(i){e||(j(t.$$.fragment,i),e=!0)},o(i){Y(t.$$.fragment,i),e=!1},d(i){_t(t,i)}}}function Dh(n){let t,e,i,r;t=new Si({props:{plugin:n[3],text:n[36][0],source:n[34].path}});let s=n[34].node.type===2&&nl(n);return{c(){Tt(t.$$.fragment),e=wt(),s&&s.c(),i=_i()},m(o,u){kt(t,o,u),K(o,e,u),s&&s.m(o,u),K(o,i,u),r=!0},p(o,u){let l={};u[0]&8&&(l.plugin=o[3]),u[1]&8&&(l.text=o[36][0]),u[1]&8&&(l.source=o[34].path),t.$set(l),o[34].node.type===2?s?(s.p(o,u),u[1]&8&&j(s,1)):(s=nl(o),s.c(),j(s,1),s.m(i.parentNode,i)):s&&(Ht(),Y(s,1,1,()=>{s=null}),Vt())},i(o){r||(j(t.$$.fragment,o),j(s),r=!0)},o(o){Y(t.$$.fragment,o),Y(s),r=!1},d(o){o&&(W(e),W(i)),_t(t,o),s&&s.d(o)}}}function Rh(n){let t;return{c(){t=tt("span"),t.textContent="This node is empty",G(t,"class","criticmarkup-view-node-empty")},m(e,i){K(e,t,i)},p:lt,i:lt,o:lt,d(e){e&&W(t)}}}function nl(n){let t,e;return t=new Si({props:{plugin:n[3],text:n[36][1],source:n[34].path}}),{c(){Tt(t.$$.fragment)},m(i,r){kt(t,i,r),e=!0},p(i,r){let s={};r[0]&8&&(s.plugin=i[3]),r[1]&8&&(s.text=i[36][1]),r[1]&8&&(s.source=i[34].path),t.$set(s)},i(i){e||(j(t.$$.fragment,i),e=!0)},o(i){Y(t.$$.fragment,i),e=!1},d(i){_t(t,i)}}}function rl(n){let t,e,i,r,s,o=[Rh,Dh],u=[];function l(h,f){return f[1]&8&&(e=null),e==null&&(e=!!h[34].node.empty()),e?0:1}function a(h,f){return f===1?Ih(h):h}return i=l(n,[-1,-1]),r=u[i]=o[i](a(n,i)),{c(){t=tt("div"),r.c(),G(t,"class","criticmarkup-view-node-text")},m(h,f){K(h,t,f),u[i].m(t,null),s=!0},p(h,f){let d=i;i=l(h,f),i===d?u[i].p(a(h,i),f):(Ht(),Y(u[d],1,1,()=>{u[d]=null}),Vt(),r=u[i],r?r.p(a(h,i),f):(r=u[i]=o[i](a(h,i)),r.c()),j(r,1),r.m(t,null))},i(h){s||(j(r),s=!0)},o(h){Y(r),s=!1},d(h){h&&W(t),u[i].d()}}}function Bh(n){let t,e,i,r,s,o=n[34].path+"",u,l,a=n[34].node.text,h,f,d;i=new Kt({props:{size:24,icon:ar[n[34].node.type]}});let m=rl(n);function v(...M){return n[15](n[35],n[34],...M)}function S(...M){return n[16](n[35],...M)}function N(...M){return n[17](n[35],...M)}return{c(){t=tt("div"),e=tt("div"),Tt(i.$$.fragment),r=wt(),s=tt("span"),u=Bt(o),l=wt(),m.c(),G(s,"class","criticmarkup-view-node-title"),G(e,"class","criticmarkup-view-node-top"),G(t,"class","criticmarkup-view-node"),Lt(t,"criticmarkup-view-node-selected",n[6].some(N))},m(M,B){K(M,t,B),ct(t,e),kt(i,e,null),ct(e,r),ct(e,s),ct(s,u),ct(t,l),m.m(t,null),h=!0,f||(d=[mt(t,"click",v),mt(t,"contextmenu",S)],f=!0)},p(M,B){n=M;let R={};B[1]&8&&(R.icon=ar[n[34].node.type]),i.$set(R),(!h||B[1]&8)&&o!==(o=n[34].path+"")&&te(u,o),B[1]&8&&at(a,a=n[34].node.text)?(Ht(),Y(m,1,1,lt),Vt(),m=rl(n),m.c(),j(m,1),m.m(t,null)):m.p(n,B),(!h||B[0]&64|B[1]&16)&&Lt(t,"criticmarkup-view-node-selected",n[6].some(N))},i(M){h||(j(i.$$.fragment,M),j(m),h=!0)},o(M){Y(i.$$.fragment,M),Y(m),h=!1},d(M){M&&W(t),_t(i),m.d(M),f=!1,Nt(d)}}}function Lh(n){let t,e,i,r,s,o;return e=new xn({props:{items:n[5],$$slots:{default:[Bh,({item:u,index:l})=>({34:u,35:l}),({item:u,index:l})=>[0,(u?8:0)|(l?16:0)]]},$$scope:{ctx:n}}}),{c(){t=tt("div"),Tt(e.$$.fragment),G(t,"class","criticmarkup-view-container"),G(t,"tabindex","-1")},m(u,l){K(u,t,l),kt(e,t,null),r=!0,s||(o=[Cu(i=Sn.call(null,t,".menu")),mt(t,"click_outside",n[14]),mt(t,"keydown",n[13])],s=!0)},p(u,l){let a={};l[0]&32&&(a.items=u[5]),l[0]&200|l[1]&88&&(a.$$scope={dirty:l,ctx:u}),e.$set(a)},i(u){r||(j(e.$$.fragment,u),r=!0)},o(u){Y(e.$$.fragment,u),r=!1},d(u){u&&W(t),_t(e),s=!1,Nt(o)}}}function zh(n){let t,e;return t=new _n({props:{$$slots:{view:[Lh],header:[Ph]},$$scope:{ctx:n}}}),{c(){Tt(t.$$.fragment)},m(i,r){kt(t,i,r),e=!0},p(i,r){let s={};r[0]&255|r[1]&64&&(s.$$scope={dirty:r,ctx:i}),t.$set(s)},i(i){e||(j(t.$$.fragment,i),e=!0)},o(i){Y(t.$$.fragment,i),e=!1},d(i){_t(t,i)}}}function Fh(n,t,e){let{plugin:i}=t;var r;(function(P){P[P.ALL=0]="ALL",P[P.ADDITION=1]="ADDITION",P[P.DELETION=2]="DELETION",P[P.SUBSTITUTION=3]="SUBSTITUTION",P[P.HIGHLIGHT=4]="HIGHLIGHT",P[P.COMMENT=5]="COMMENT"})(r||(r={}));var s;(function(P){P[P.VAULT=0]="VAULT",P[P.FOLDER=1]="FOLDER",P[P.FILE=2]="FILE"})(s||(s={}));var o;(function(P){P[P.ALL=0]="ALL",P[P.CONTENT=1]="CONTENT",P[P.EMPTY=2]="EMPTY"})(o||(o={}));let{node_type_filter:u=r.ALL}=t,{location_filter:l=s.VAULT}=t,{content_filter:a=o.ALL}=t,h="",f=i.app.workspace.on("active-leaf-change",g),d=[],m=[],v=[],S=null,N=[{icon:"asterisk",tooltip:"All markup"},{icon:"plus-circle",tooltip:"Addition markup"},{icon:"minus-square",tooltip:"Deletion markup"},{icon:"replace",tooltip:"Substitution markup"},{icon:"highlighter",tooltip:"Highlight markup"},{icon:"message-square",tooltip:"Comment markup"}],M=[{icon:"vault",tooltip:"Entire vault"},{icon:"folder-closed",tooltip:"Current folder"},{icon:"file",tooltip:"Current file"}],B=[{icon:"maximize",tooltip:"All nodes"},{icon:"square",tooltip:"Only nodes with content"},{icon:"box-select",tooltip:"Only empty nodes"}],R=(0,Yt.debounce)(g,500),A=[];Be(()=>{i.database.on("database-update",O),O(i.database.allEntries())}),Wr(()=>{i.app.workspace.offref(f)});async function O(P){d=P,await g()}async function g(){if(!d)return;let P=d;if(l!==s.VAULT){let U=i.app.workspace.getActiveFile();U&&(l===s.FOLDER?P=d.filter(([X,et])=>X.startsWith(U.parent?.path??"")):l===s.FILE&&(P=d.filter(([X,et])=>X===U.path)))}e(5,m=P.flatMap(([U,X])=>X.data.map(et=>({path:U,node:et})))),u!==r.ALL&&e(5,m=m.filter(U=>U.node.type===u-1)),a!==o.ALL&&e(5,m=m.filter(U=>a===o.CONTENT!==U.node.empty())),h.length&&e(5,m=m.filter(U=>(0,Yt.prepareSimpleSearch)(h)(U.node.text)?.score))}async function k(P,U){U!=null&&!v.length&&(e(6,v=[U]),e(7,S=U));let et=v.map(At=>m[At]).reduce((At,{path:Jt,node:Qt})=>(At[Jt]||(At[Jt]=[]),At[Jt].push(Qt),At),{}),dt=P?to:eo,ne={};for(let[At,Jt]of Object.entries(et)){let Qt=i.app.vault.getAbstractFileByPath(At);Qt&&(ne[At]=await i.app.vault.cachedRead(Qt),await dt(Qt,Jt))}A.push({file_history:ne,selected_nodes:v}),e(6,v=[])}async function C(P){if(P.key==="z"&&P.ctrlKey&&!P.shiftKey&&!P.altKey&&!P.metaKey)if(A.length){let U=A.pop();e(6,v=U.selected_nodes);for(let[X,et]of Object.entries(U.file_history)){let dt=i.app.vault.getAbstractFileByPath(X);dt&&await i.app.vault.modify(dt,et)}}else new Yt.Notice("There is nothing to undo",4e3);else P.key==="a"&&P.ctrlKey&&!P.shiftKey&&!P.altKey&&!P.metaKey?(e(6,v=Array.from(m.keys())),e(7,S=0)):P.key==="Escape"&&(e(6,v=[]),e(7,S=null))}async function T(){e(6,v=[]),e(7,S=null)}let _=async(P,U,X)=>{if(X.shiftKey)if(S){let et=Math.min(S,P),dt=Math.max(S,P);e(6,v=Array.from({length:dt-et+1},(ne,At)=>At+et))}else e(6,v=[P]),e(7,S=P);else if(X.ctrlKey||X.metaKey){e(7,S=P);let et=v.length;e(6,v=v.filter(dt=>dt!==P)),v.length===et&&e(6,v=[...v,P])}else{e(6,v=[]);let et=i.app.workspace.getLeavesOfType("markdown");if(!et.length)return;let dt=et.reduce((Jt,Qt)=>Jt.activeTime>Qt.activeTime?Jt:Qt),ne=i.app.vault.getAbstractFileByPath(U.path);if(!ne)return;let At=dt.view;ne!==At.file&&await dt.openFile(ne),At.editor.setSelection(At.editor.offsetToPos(U.node.from),At.editor.offsetToPos(U.node.to))}},I=(P,U)=>{let X=new Yt.Menu;X.addItem(et=>{et.setTitle("Accept"+(v.length?" selected changes":" changes")),et.setIcon("check"),et.onClick(async()=>k(!0,P))}),X.addItem(et=>{et.setTitle("Reject"+(v.length?" selected changes":" changes")),et.setIcon("cross"),et.onClick(async()=>k(!1,P))}),X.showAtMouseEvent(U)},H=(P,U)=>U===P,V=P=>{e(4,h=P),R()},J=P=>{let U=new Yt.Menu;N.map((X,et)=>{U.addItem(dt=>{dt.setTitle(X.tooltip),dt.setIcon(X.icon),dt.onClick(()=>{e(0,u=et)})})}),U.showAtMouseEvent(P)};function it(P){u=P,e(0,u)}let Q=()=>{e(6,v=Array.from(m.keys())),e(7,S=0)},zt=P=>{let U=new Yt.Menu;M.map((X,et)=>{U.addItem(dt=>{dt.setTitle(X.tooltip),dt.setIcon(X.icon),dt.onClick(()=>{e(1,l=et)})})}),U.showAtMouseEvent(P)};function nt(P){l=P,e(1,l)}let rt=P=>{let U=new Yt.Menu;B.map((X,et)=>{U.addItem(dt=>{dt.setTitle(X.tooltip),dt.setIcon(X.icon),dt.onClick(()=>{e(2,a=et)})})}),U.showAtMouseEvent(P)};function gt(P){a=P,e(2,a)}return n.$$set=P=>{"plugin"in P&&e(3,i=P.plugin),"node_type_filter"in P&&e(0,u=P.node_type_filter),"location_filter"in P&&e(1,l=P.location_filter),"content_filter"in P&&e(2,a=P.content_filter)},n.$$.update=()=>{n.$$.dirty[0]&7&&(e(6,v=[]),e(7,S=null),g())},[u,l,a,i,h,m,v,S,N,M,B,R,k,C,T,_,I,H,V,J,it,Q,zt,nt,rt,gt]}var ls=class extends ot{constructor(t){super(),ft(this,t,Fh,zh,at,{plugin:3,node_type_filter:0,location_filter:1,content_filter:2},null,[-1,-1])}},sl=ls;var ni="criticmarkup-view",On=class extends ol.ItemView{constructor(e,i){super(e);this.plugin=i}view=null;async onOpen(){this.containerEl.empty(),this.containerEl.classList.add("criticmarkup-view")}async onClose(){this.view.$destroy(),this.containerEl.detach()}getViewType(){return ni}getDisplayText(){return"Vault suggestions and comments"}getIcon(){return"message-square"}getState(){let e=super.getState();return this.view&&(e.node_type_filter=this.view.$$.ctx[this.view.$$.props.node_type_filter],e.location_filter=this.view.$$.ctx[this.view.$$.props.location_filter],e.content_filter=this.view.$$.ctx[this.view.$$.props.content_filter]),e}async setState(e,i){this.view||(this.view=new sl({target:this.containerEl,props:{plugin:this.plugin}})),this.view.$set({node_type_filter:e.node_type_filter||0,location_filter:e.location_filter||0,content_filter:e.content_filter||0}),await super.setState(e,i)}};var St=require("obsidian"),En=class extends St.PluginSettingTab{plugin;constructor(t,e){super(t,e),this.plugin=e}display(){let{containerEl:t}=this;t.empty(),new St.Setting(t).setHeading().setName("Suggestion Mode Settings"),new St.Setting(t).setName("Enable Suggestion Mode").addToggle(e=>e.setValue(this.plugin.settings.suggest_mode).onChange(async i=>{this.plugin.settings.suggest_mode=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Editor suggestion mode button").setDesc("Add button to editor toolbar to toggle suggestion mode").addToggle(e=>e.setValue(this.plugin.settings.editor_suggest_button).onChange(async i=>{this.plugin.settings.editor_suggest_button=i,await this.plugin.saveSettings()})),new St.Setting(t).setHeading().setName("Editor Settings"),new St.Setting(t).setName("Editor gutter").setDesc("Show suggestion status in editor gutter").addToggle(e=>e.setValue(this.plugin.settings.editor_gutter).onChange(async i=>{this.plugin.settings.editor_gutter=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Automatic tag completion").setDesc("Automatically complete CriticMarkup tags").addToggle(e=>e.setValue(this.plugin.settings.tag_completion).onChange(async i=>{this.plugin.settings.tag_completion=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Automatic tag correction").setDesc("Automatically correct invalid CriticMarkup tags").addToggle(e=>e.setValue(this.plugin.settings.node_correcter).onChange(async i=>{this.plugin.settings.node_correcter=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Editor preview button").setDesc("Add suggestion preview button to editor toolbar").addToggle(e=>e.setValue(this.plugin.settings.editor_preview_button).onChange(async i=>{this.plugin.settings.editor_preview_button=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Remove syntax on copy").setDesc("CriticMarkup syntax will be removed when copying text to clipboard").addToggle(e=>e.setValue(this.plugin.settings.clipboard_remove_syntax).onChange(async i=>{this.plugin.settings.clipboard_remove_syntax=i,await this.plugin.saveSettings()})),new St.Setting(t).setHeading().setName("Rendering Settings"),new St.Setting(t).setName("Comment style").setDesc("How comments should be rendered").addDropdown(e=>e.addOption("inline","Inline").addOption("icon","Inline Icon").addOption("block","Block").setValue(this.plugin.settings.comment_style).onChange(async i=>{this.plugin.settings.comment_style=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Show style when editing").setDesc("Keep styling of CriticMarkup when editing the markup").addToggle(e=>e.setValue(this.plugin.settings.editor_styling).onChange(async i=>{this.plugin.settings.editor_styling=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Hide Gutter when empty").setDesc("Completely hide the gutter when there are no suggestions").addToggle(e=>e.setValue(this.plugin.settings.hide_empty_gutter).onChange(async i=>{this.plugin.settings.hide_empty_gutter=i,await this.plugin.saveSettings()})),new St.Setting(t).setHeading().setName("Advanced Settings"),new St.Setting(t).setName("Reading view renderer").setDesc("Toggle rendering of CriticMarkup tags in reading view mode").addToggle(e=>e.setValue(this.plugin.settings.post_processor).onChange(async i=>{this.plugin.settings.post_processor=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Live preview renderer").setDesc("Toggle rendering of CriticMarkup tags in live preview").addToggle(e=>e.setValue(this.plugin.settings.live_preview).onChange(async i=>{this.plugin.settings.live_preview=i,await this.plugin.saveSettings()})),new St.Setting(t).setName("Alternative cursor movement").setDesc("Toggle corrected cursor movement of cursor when CriticMarkup tags are present").addToggle(e=>e.setValue(this.plugin.settings.alternative_cursor_movement).onChange(async i=>{this.plugin.settings.alternative_cursor_movement=i,await this.plugin.saveSettings()}))}};var as={preview_mode:0,editor_preview_button:!0,editor_gutter:!0,editor_styling:!1,hide_empty_gutter:!1,comment_style:"block",tag_completion:!0,node_correcter:!0,clipboard_remove_syntax:!0,suggest_mode:!1,editor_suggest_button:!0,post_processor:!0,live_preview:!0,alternative_cursor_movement:!0},ul=new Set(["preview_mode","live_preview","alternative_live_preview","editor_gutter","hide_empty_gutter","comment_style","tag_completion","node_correcter","suggest_mode"]);var Mn=class extends Fe.Plugin{editorExtensions=[];settings=as;previous_settings={};changed_settings={};loadPreviewButtonsEvent;loadSuggestButtonsEvent;remove_monkeys=[];database=new Ci(this,"commentator/cache","Commentator cache",3,"Vault-wide cache for Commentator plugin",()=>[],async t=>di(await this.app.vault.cachedRead(t)).nodes,2,t=>t.map(e=>Object.assign(new ci[e.type],e)));postProcessor;loadEditorExtensions(){this.editorExtensions.length=0,this.editorExtensions.push(cu),this.editorExtensions.push(vt),(this.settings.comment_style==="icon"||this.settings.comment_style==="block")&&this.editorExtensions.push(ho(this.settings)),this.settings.comment_style==="block"&&this.editorExtensions.push(_r),this.settings.live_preview&&this.editorExtensions.push(co(this.settings)),this.settings.editor_gutter&&this.editorExtensions.push(vu(this)),this.settings.suggest_mode&&this.editorExtensions.push(fu(this.settings)),this.settings.tag_completion&&this.editorExtensions.push(pu),this.settings.node_correcter&&this.editorExtensions.push(mu),this.editorExtensions.push(ll.EditorView.domEventHandlers({copy:$s.bind(null,this.settings)}))}async updateEditorExtension(){Object.keys(this.changed_settings).some(t=>ul.has(t))&&(this.loadEditorExtensions(),this.app.workspace.updateOptions()),this.settings.post_processor&&Nr()}async onload(){this.registerView(ni,t=>new On(t,this)),this.settings=Object.assign({},this.settings,await this.loadData()),this.previous_settings=Object.assign({},this.settings),this.settings.editor_preview_button&&(xi(this),this.loadPreviewButtonsEvent=this.app.workspace.on("layout-change",()=>xi(this)),this.registerEvent(this.loadPreviewButtonsEvent)),this.settings.editor_suggest_button&&(wi(this),this.loadSuggestButtonsEvent=this.app.workspace.on("layout-change",()=>wi(this)),this.registerEvent(this.loadSuggestButtonsEvent)),this.addSettingTab(new En(this.app,this)),this.loadEditorExtensions(),this.registerEditorExtension(this.editorExtensions),this.settings.post_processor&&(this.postProcessor=this.registerMarkdownPostProcessor(async(t,e)=>Ir(t,e,this.settings),-99999),Nr()),this.registerEvent(io),pi.push({id:"commentator-suggest-mode",name:"Toggle suggestion mode",icon:"comment",editor_context:!0,regular_callback:async()=>{this.settings.suggest_mode=!this.settings.suggest_mode,await this.saveSettings()}}),pi.push({id:"commentator-toggle-vim",name:"(DEBUG) Toggle Vim mode",icon:"comment",regular_callback:async()=>{this.app.vault.setConfig("vimMode",!this.app.vault.getConfig("vimMode"))}}),pi.push({id:"commentator-view",name:"Open CriticMarkup view",icon:"comment",regular_callback:async()=>{await this.activateView()}});for(let t of pi)Fe.Platform.isMobile||t.editor_context?t.regular_callback?(t.editorCallback=t.regular_callback,delete t.regular_callback):(t.editorCheckCallback=t.check_callback,delete t.check_callback):t.regular_callback?(t.callback=t.regular_callback,delete t.regular_callback):(t.checkCallback=t.check_callback,delete t.check_callback),this.addCommand(t);this.remove_monkeys.push(ku(this.app.plugins,{uninstallPlugin:t=>async e=>{t&&await t.apply(this.app.plugins,[e]),e==="commentator"&&await this.database.dropDatabase()}}))}async onunload(){this.settings.editor_preview_button&&await Lr(),this.settings.editor_suggest_button&&await Fr(),Fe.MarkdownPreviewRenderer.unregisterPostProcessor(this.postProcessor);for(let t of this.remove_monkeys)t();this.database.unload()}async loadSettings(){this.settings=Object.assign({},as,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.changed_settings=Ws(this.settings,this.previous_settings),this.previous_settings=Object.assign({},this.settings),this.changed_settings.suggest_mode!==void 0&&await zr(this),this.changed_settings.editor_preview_button!==void 0&&(this.changed_settings.editor_preview_button?(xi(this),this.loadPreviewButtonsEvent=this.app.workspace.on("layout-change",()=>xi(this)),this.registerEvent(this.loadPreviewButtonsEvent)):(await Lr(),this.app.workspace.offref(this.loadPreviewButtonsEvent),this.settings.preview_mode=0)),this.changed_settings.editor_suggest_button!==void 0&&(this.changed_settings.editor_suggest_button?(wi(this),this.loadSuggestButtonsEvent=this.app.workspace.on("layout-change",()=>wi(this)),this.registerEvent(this.loadSuggestButtonsEvent)):(await Fr(),this.app.workspace.offref(this.loadSuggestButtonsEvent))),this.changed_settings.post_processor!==void 0&&(this.changed_settings.post_processor?this.postProcessor=this.registerMarkdownPostProcessor((t,e)=>Ir(t,e,this.settings),-99999):Fe.MarkdownPreviewRenderer.unregisterPostProcessor(this.postProcessor),_o()),await this.updateEditorExtension()}async activateView(){this.app.workspace.detachLeavesOfType(ni),await this.app.workspace.getRightLeaf(!1).setViewState({type:ni,active:!0}),this.app.workspace.revealLeaf(this.app.workspace.getLeavesOfType(ni)[0])}};
/*! Bundled license information:

localforage/dist/localforage.js:
  (*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  *)
*/
